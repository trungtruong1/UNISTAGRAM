{"ast":null,"code":"import React, { createContext, memo, useEffect, useLayoutEffect, useState, useCallback, useMemo, isValidElement, cloneElement, useContext, forwardRef, useRef, useImperativeHandle, Fragment as Fragment$1 } from 'react';\nimport { jsx, jsxs, Fragment } from 'react/jsx-runtime';\n/**\n * Create the React Context\n */\n\nconst DndContext = /*#__PURE__*/createContext({\n  dragDropManager: undefined\n});\n/**\n * Adapted from React: https://github.com/facebook/react/blob/master/packages/shared/formatProdErrorMessage.js\n *\n * Do not require this module directly! Use normal throw error calls. These messages will be replaced with error codes\n * during build.\n * @param {number} code\n */\n\nfunction formatProdErrorMessage(code) {\n  return \"Minified Redux error #\" + code + \"; visit https://redux.js.org/Errors?code=\" + code + \" for the full message or \" + 'use the non-minified dev environment for full errors. ';\n} // Inlined version of the `symbol-observable` polyfill\n\n\nvar $$observable = function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\n\n\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\n\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n} // Inlined / shortened version of `kindOf` from https://github.com/jonschlinkert/kind-of\n\n\nfunction miniKindOf(val) {\n  if (val === void 0) return 'undefined';\n  if (val === null) return 'null';\n  var type = typeof val;\n\n  switch (type) {\n    case 'boolean':\n    case 'string':\n    case 'number':\n    case 'symbol':\n    case 'function':\n      {\n        return type;\n      }\n  }\n\n  if (Array.isArray(val)) return 'array';\n  if (isDate(val)) return 'date';\n  if (isError(val)) return 'error';\n  var constructorName = ctorName(val);\n\n  switch (constructorName) {\n    case 'Symbol':\n    case 'Promise':\n    case 'WeakMap':\n    case 'WeakSet':\n    case 'Map':\n    case 'Set':\n      return constructorName;\n  } // other\n\n\n  return type.slice(8, -1).toLowerCase().replace(/\\s/g, '');\n}\n\nfunction ctorName(val) {\n  return typeof val.constructor === 'function' ? val.constructor.name : null;\n}\n\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === 'string' && val.constructor && typeof val.constructor.stackTraceLimit === 'number';\n}\n\nfunction isDate(val) {\n  if (val instanceof Date) return true;\n  return typeof val.toDateString === 'function' && typeof val.getDate === 'function' && typeof val.setDate === 'function';\n}\n\nfunction kindOf(val) {\n  var typeOfVal = typeof val;\n\n  if (process.env.NODE_ENV !== 'production') {\n    typeOfVal = miniKindOf(val);\n  }\n\n  return typeOfVal;\n}\n/**\n * @deprecated\n *\n * **We recommend using the `configureStore` method\n * of the `@reduxjs/toolkit` package**, which replaces `createStore`.\n *\n * Redux Toolkit is our recommended approach for writing Redux logic today,\n * including store setup, reducers, data fetching, and more.\n *\n * **For more details, please read this Redux docs page:**\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * `configureStore` from Redux Toolkit is an improved version of `createStore` that\n * simplifies setup and helps avoid common bugs.\n *\n * You should not be using the `redux` core package by itself today, except for learning purposes.\n * The `createStore` method from the core `redux` package will not be removed, but we encourage\n * all users to migrate to using Redux Toolkit for all Redux code.\n *\n * If you want to use `createStore` without this visual deprecation warning, use\n * the `legacy_createStore` import instead:\n *\n * `import { legacy_createStore as createStore} from 'redux'`\n *\n */\n\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : 'It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : \"Expected the enhancer to be a function. Instead, received: '\" + kindOf(enhancer) + \"'\");\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : \"Expected the root reducer to be a function. Instead, received: '\" + kindOf(reducer) + \"'\");\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : 'You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : \"Expected the listener to be a function. Instead, received: '\" + kindOf(listener) + \"'\");\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : 'You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : 'You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n      currentListeners = null;\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : \"Actions must be plain objects. Instead, the actual type was: '\" + kindOf(action) + \"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.\");\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : 'Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : \"Expected the nextReducer to be a function. Instead, received: '\" + kindOf(nextReducer));\n    }\n\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : \"Expected the observer to be an object. Instead, received: '\" + kindOf(observer) + \"'\");\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\n\n\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\n\n\nfunction invariant(condition, format) {\n  for (var _len = arguments.length, args = new Array(_len > 2 ? _len - 2 : 0), _key = 2; _key < _len; _key++) {\n    args[_key - 2] = arguments[_key];\n  }\n\n  if (isProduction()) {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    let error;\n\n    if (format === undefined) {\n      error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n    } else {\n      let argIndex = 0;\n      error = new Error(format.replace(/%s/g, function () {\n        return args[argIndex++];\n      }));\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1 // we don't care about invariant's own frame\n    ;\n    throw error;\n  }\n}\n\nfunction isProduction() {\n  return typeof process !== 'undefined' && process.env['NODE_ENV'] === 'production';\n} // cheap lodash replacements\n\n/**\n * drop-in replacement for _.get\n * @param obj\n * @param path\n * @param defaultValue\n */\n\n\nfunction get(obj, path, defaultValue) {\n  return path.split('.').reduce((a, c) => a && a[c] ? a[c] : defaultValue || null, obj);\n}\n/**\n * drop-in replacement for _.without\n */\n\n\nfunction without$1(items, item) {\n  return items.filter(i => i !== item);\n}\n/**\n * drop-in replacement for _.isString\n * @param input\n */\n\n\nfunction isObject(input) {\n  return typeof input === 'object';\n}\n/**\n * replacement for _.xor\n * @param itemsA\n * @param itemsB\n */\n\n\nfunction xor(itemsA, itemsB) {\n  const map = new Map();\n\n  const insertItem = item => {\n    map.set(item, map.has(item) ? map.get(item) + 1 : 1);\n  };\n\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  map.forEach((count, key) => {\n    if (count === 1) {\n      result.push(key);\n    }\n  });\n  return result;\n}\n/**\n * replacement for _.intersection\n * @param itemsA\n * @param itemsB\n */\n\n\nfunction intersection(itemsA, itemsB) {\n  return itemsA.filter(t => itemsB.indexOf(t) > -1);\n}\n\nconst INIT_COORDS = 'dnd-core/INIT_COORDS';\nconst BEGIN_DRAG = 'dnd-core/BEGIN_DRAG';\nconst PUBLISH_DRAG_SOURCE = 'dnd-core/PUBLISH_DRAG_SOURCE';\nconst HOVER = 'dnd-core/HOVER';\nconst DROP = 'dnd-core/DROP';\nconst END_DRAG = 'dnd-core/END_DRAG';\n\nfunction setClientOffset(clientOffset, sourceClientOffset) {\n  return {\n    type: INIT_COORDS,\n    payload: {\n      sourceClientOffset: sourceClientOffset || null,\n      clientOffset: clientOffset || null\n    }\n  };\n}\n\nconst ResetCoordinatesAction = {\n  type: INIT_COORDS,\n  payload: {\n    clientOffset: null,\n    sourceClientOffset: null\n  }\n};\n\nfunction createBeginDrag(manager) {\n  return function beginDrag() {\n    let sourceIds = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      publishSource: true\n    };\n    const {\n      publishSource = true,\n      clientOffset,\n      getSourceClientOffset\n    } = options;\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry(); // Initialize the coordinates using the client offset\n\n    manager.dispatch(setClientOffset(clientOffset));\n    verifyInvariants$1(sourceIds, monitor, registry); // Get the draggable source\n\n    const sourceId = getDraggableSource(sourceIds, monitor);\n\n    if (sourceId == null) {\n      manager.dispatch(ResetCoordinatesAction);\n      return;\n    } // Get the source client offset\n\n\n    let sourceClientOffset = null;\n\n    if (clientOffset) {\n      if (!getSourceClientOffset) {\n        throw new Error('getSourceClientOffset must be defined');\n      }\n\n      verifyGetSourceClientOffsetIsFunction(getSourceClientOffset);\n      sourceClientOffset = getSourceClientOffset(sourceId);\n    } // Initialize the full coordinates\n\n\n    manager.dispatch(setClientOffset(clientOffset, sourceClientOffset));\n    const source = registry.getSource(sourceId);\n    const item = source.beginDrag(monitor, sourceId); // If source.beginDrag returns null, this is an indicator to cancel the drag\n\n    if (item == null) {\n      return undefined;\n    }\n\n    verifyItemIsObject(item);\n    registry.pinSource(sourceId);\n    const itemType = registry.getSourceType(sourceId);\n    return {\n      type: BEGIN_DRAG,\n      payload: {\n        itemType,\n        item,\n        sourceId,\n        clientOffset: clientOffset || null,\n        sourceClientOffset: sourceClientOffset || null,\n        isSourcePublic: !!publishSource\n      }\n    };\n  };\n}\n\nfunction verifyInvariants$1(sourceIds, monitor, registry) {\n  invariant(!monitor.isDragging(), 'Cannot call beginDrag while dragging.');\n  sourceIds.forEach(function (sourceId) {\n    invariant(registry.getSource(sourceId), 'Expected sourceIds to be registered.');\n  });\n}\n\nfunction verifyGetSourceClientOffsetIsFunction(getSourceClientOffset) {\n  invariant(typeof getSourceClientOffset === 'function', 'When clientOffset is provided, getSourceClientOffset must be a function.');\n}\n\nfunction verifyItemIsObject(item) {\n  invariant(isObject(item), 'Item must be an object.');\n}\n\nfunction getDraggableSource(sourceIds, monitor) {\n  let sourceId = null;\n\n  for (let i = sourceIds.length - 1; i >= 0; i--) {\n    if (monitor.canDragSource(sourceIds[i])) {\n      sourceId = sourceIds[i];\n      break;\n    }\n  }\n\n  return sourceId;\n}\n\nfunction _defineProperty$4(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$4(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$4(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction createDrop(manager) {\n  return function drop() {\n    let options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyInvariants(monitor);\n    const targetIds = getDroppableTargets(monitor); // Multiple actions are dispatched here, which is why this doesn't return an action\n\n    targetIds.forEach((targetId, index) => {\n      const dropResult = determineDropResult(targetId, index, registry, monitor);\n      const action = {\n        type: DROP,\n        payload: {\n          dropResult: _objectSpread$4({}, options, dropResult)\n        }\n      };\n      manager.dispatch(action);\n    });\n  };\n}\n\nfunction verifyInvariants(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call drop while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call drop twice during one drag operation.');\n}\n\nfunction determineDropResult(targetId, index, registry, monitor) {\n  const target = registry.getTarget(targetId);\n  let dropResult = target ? target.drop(monitor, targetId) : undefined;\n  verifyDropResultType(dropResult);\n\n  if (typeof dropResult === 'undefined') {\n    dropResult = index === 0 ? {} : monitor.getDropResult();\n  }\n\n  return dropResult;\n}\n\nfunction verifyDropResultType(dropResult) {\n  invariant(typeof dropResult === 'undefined' || isObject(dropResult), 'Drop result must either be an object or undefined.');\n}\n\nfunction getDroppableTargets(monitor) {\n  const targetIds = monitor.getTargetIds().filter(monitor.canDropOnTarget, monitor);\n  targetIds.reverse();\n  return targetIds;\n}\n\nfunction createEndDrag(manager) {\n  return function endDrag() {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyIsDragging(monitor);\n    const sourceId = monitor.getSourceId();\n\n    if (sourceId != null) {\n      const source = registry.getSource(sourceId, true);\n      source.endDrag(monitor, sourceId);\n      registry.unpinSource();\n    }\n\n    return {\n      type: END_DRAG\n    };\n  };\n}\n\nfunction verifyIsDragging(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call endDrag while not dragging.');\n}\n\nfunction matchesType(targetType, draggedItemType) {\n  if (draggedItemType === null) {\n    return targetType === null;\n  }\n\n  return Array.isArray(targetType) ? targetType.some(t => t === draggedItemType) : targetType === draggedItemType;\n}\n\nfunction createHover(manager) {\n  return function hover(targetIdsArg) {\n    let {\n      clientOffset\n    } = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    verifyTargetIdsIsArray(targetIdsArg);\n    const targetIds = targetIdsArg.slice(0);\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    const draggedItemType = monitor.getItemType();\n    removeNonMatchingTargetIds(targetIds, registry, draggedItemType);\n    checkInvariants(targetIds, monitor, registry);\n    hoverAllTargets(targetIds, monitor, registry);\n    return {\n      type: HOVER,\n      payload: {\n        targetIds,\n        clientOffset: clientOffset || null\n      }\n    };\n  };\n}\n\nfunction verifyTargetIdsIsArray(targetIdsArg) {\n  invariant(Array.isArray(targetIdsArg), 'Expected targetIds to be an array.');\n}\n\nfunction checkInvariants(targetIds, monitor, registry) {\n  invariant(monitor.isDragging(), 'Cannot call hover while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call hover after drop.');\n\n  for (let i = 0; i < targetIds.length; i++) {\n    const targetId = targetIds[i];\n    invariant(targetIds.lastIndexOf(targetId) === i, 'Expected targetIds to be unique in the passed array.');\n    const target = registry.getTarget(targetId);\n    invariant(target, 'Expected targetIds to be registered.');\n  }\n}\n\nfunction removeNonMatchingTargetIds(targetIds, registry, draggedItemType) {\n  // Remove those targetIds that don't match the targetType.  This\n  // fixes shallow isOver which would only be non-shallow because of\n  // non-matching targets.\n  for (let i = targetIds.length - 1; i >= 0; i--) {\n    const targetId = targetIds[i];\n    const targetType = registry.getTargetType(targetId);\n\n    if (!matchesType(targetType, draggedItemType)) {\n      targetIds.splice(i, 1);\n    }\n  }\n}\n\nfunction hoverAllTargets(targetIds, monitor, registry) {\n  // Finally call hover on all matching targets.\n  targetIds.forEach(function (targetId) {\n    const target = registry.getTarget(targetId);\n    target.hover(monitor, targetId);\n  });\n}\n\nfunction createPublishDragSource(manager) {\n  return function publishDragSource() {\n    const monitor = manager.getMonitor();\n\n    if (monitor.isDragging()) {\n      return {\n        type: PUBLISH_DRAG_SOURCE\n      };\n    }\n\n    return;\n  };\n}\n\nfunction createDragDropActions(manager) {\n  return {\n    beginDrag: createBeginDrag(manager),\n    publishDragSource: createPublishDragSource(manager),\n    hover: createHover(manager),\n    drop: createDrop(manager),\n    endDrag: createEndDrag(manager)\n  };\n}\n\nclass DragDropManagerImpl {\n  receiveBackend(backend) {\n    this.backend = backend;\n  }\n\n  getMonitor() {\n    return this.monitor;\n  }\n\n  getBackend() {\n    return this.backend;\n  }\n\n  getRegistry() {\n    return this.monitor.registry;\n  }\n\n  getActions() {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    const manager = this;\n    const {\n      dispatch\n    } = this.store;\n\n    function bindActionCreator(actionCreator) {\n      return function () {\n        for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n          args[_key2] = arguments[_key2];\n        }\n\n        const action = actionCreator.apply(manager, args);\n\n        if (typeof action !== 'undefined') {\n          dispatch(action);\n        }\n      };\n    }\n\n    const actions = createDragDropActions(this);\n    return Object.keys(actions).reduce((boundActions, key) => {\n      const action = actions[key];\n      boundActions[key] = bindActionCreator(action);\n      return boundActions;\n    }, {});\n  }\n\n  dispatch(action) {\n    this.store.dispatch(action);\n  }\n\n  constructor(store, monitor) {\n    this.isSetUp = false;\n\n    this.handleRefCountChange = () => {\n      const shouldSetUp = this.store.getState().refCount > 0;\n\n      if (this.backend) {\n        if (shouldSetUp && !this.isSetUp) {\n          this.backend.setup();\n          this.isSetUp = true;\n        } else if (!shouldSetUp && this.isSetUp) {\n          this.backend.teardown();\n          this.isSetUp = false;\n        }\n      }\n    };\n\n    this.store = store;\n    this.monitor = monitor;\n    store.subscribe(this.handleRefCountChange);\n  }\n\n}\n/**\n * Coordinate addition\n * @param a The first coordinate\n * @param b The second coordinate\n */\n\n\nfunction add(a, b) {\n  return {\n    x: a.x + b.x,\n    y: a.y + b.y\n  };\n}\n/**\n * Coordinate subtraction\n * @param a The first coordinate\n * @param b The second coordinate\n */\n\n\nfunction subtract(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}\n/**\n * Returns the cartesian distance of the drag source component's position, based on its position\n * at the time when the current drag operation has started, and the movement difference.\n *\n * Returns null if no item is being dragged.\n *\n * @param state The offset state to compute from\n */\n\n\nfunction getSourceClientOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset,\n    initialSourceClientOffset\n  } = state;\n\n  if (!clientOffset || !initialClientOffset || !initialSourceClientOffset) {\n    return null;\n  }\n\n  return subtract(add(clientOffset, initialSourceClientOffset), initialClientOffset);\n}\n/**\n * Determines the x,y offset between the client offset and the initial client offset\n *\n * @param state The offset state to compute from\n */\n\n\nfunction getDifferenceFromInitialOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset\n  } = state;\n\n  if (!clientOffset || !initialClientOffset) {\n    return null;\n  }\n\n  return subtract(clientOffset, initialClientOffset);\n}\n\nconst NONE = [];\nconst ALL = [];\nNONE.__IS_NONE__ = true;\nALL.__IS_ALL__ = true;\n/**\n * Determines if the given handler IDs are dirty or not.\n *\n * @param dirtyIds The set of dirty handler ids\n * @param handlerIds The set of handler ids to check\n */\n\nfunction areDirty(dirtyIds, handlerIds) {\n  if (dirtyIds === NONE) {\n    return false;\n  }\n\n  if (dirtyIds === ALL || typeof handlerIds === 'undefined') {\n    return true;\n  }\n\n  const commonIds = intersection(handlerIds, dirtyIds);\n  return commonIds.length > 0;\n}\n\nclass DragDropMonitorImpl {\n  subscribeToStateChange(listener) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    const {\n      handlerIds\n    } = options;\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    invariant(typeof handlerIds === 'undefined' || Array.isArray(handlerIds), 'handlerIds, when specified, must be an array of strings.');\n    let prevStateId = this.store.getState().stateId;\n\n    const handleChange = () => {\n      const state = this.store.getState();\n      const currentStateId = state.stateId;\n\n      try {\n        const canSkipListener = currentStateId === prevStateId || currentStateId === prevStateId + 1 && !areDirty(state.dirtyHandlerIds, handlerIds);\n\n        if (!canSkipListener) {\n          listener();\n        }\n      } finally {\n        prevStateId = currentStateId;\n      }\n    };\n\n    return this.store.subscribe(handleChange);\n  }\n\n  subscribeToOffsetChange(listener) {\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    let previousState = this.store.getState().dragOffset;\n\n    const handleChange = () => {\n      const nextState = this.store.getState().dragOffset;\n\n      if (nextState === previousState) {\n        return;\n      }\n\n      previousState = nextState;\n      listener();\n    };\n\n    return this.store.subscribe(handleChange);\n  }\n\n  canDragSource(sourceId) {\n    if (!sourceId) {\n      return false;\n    }\n\n    const source = this.registry.getSource(sourceId);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n\n    if (this.isDragging()) {\n      return false;\n    }\n\n    return source.canDrag(this, sourceId);\n  }\n\n  canDropOnTarget(targetId) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n\n    const target = this.registry.getTarget(targetId);\n    invariant(target, `Expected to find a valid target. targetId=${targetId}`);\n\n    if (!this.isDragging() || this.didDrop()) {\n      return false;\n    }\n\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n    return matchesType(targetType, draggedItemType) && target.canDrop(this, targetId);\n  }\n\n  isDragging() {\n    return Boolean(this.getItemType());\n  }\n\n  isDraggingSource(sourceId) {\n    // undefined on initial render\n    if (!sourceId) {\n      return false;\n    }\n\n    const source = this.registry.getSource(sourceId, true);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n\n    if (!this.isDragging() || !this.isSourcePublic()) {\n      return false;\n    }\n\n    const sourceType = this.registry.getSourceType(sourceId);\n    const draggedItemType = this.getItemType();\n\n    if (sourceType !== draggedItemType) {\n      return false;\n    }\n\n    return source.isDragging(this, sourceId);\n  }\n\n  isOverTarget(targetId) {\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {\n      shallow: false\n    };\n\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n\n    const {\n      shallow\n    } = options;\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n\n    if (draggedItemType && !matchesType(targetType, draggedItemType)) {\n      return false;\n    }\n\n    const targetIds = this.getTargetIds();\n\n    if (!targetIds.length) {\n      return false;\n    }\n\n    const index = targetIds.indexOf(targetId);\n\n    if (shallow) {\n      return index === targetIds.length - 1;\n    } else {\n      return index > -1;\n    }\n  }\n\n  getItemType() {\n    return this.store.getState().dragOperation.itemType;\n  }\n\n  getItem() {\n    return this.store.getState().dragOperation.item;\n  }\n\n  getSourceId() {\n    return this.store.getState().dragOperation.sourceId;\n  }\n\n  getTargetIds() {\n    return this.store.getState().dragOperation.targetIds;\n  }\n\n  getDropResult() {\n    return this.store.getState().dragOperation.dropResult;\n  }\n\n  didDrop() {\n    return this.store.getState().dragOperation.didDrop;\n  }\n\n  isSourcePublic() {\n    return Boolean(this.store.getState().dragOperation.isSourcePublic);\n  }\n\n  getInitialClientOffset() {\n    return this.store.getState().dragOffset.initialClientOffset;\n  }\n\n  getInitialSourceClientOffset() {\n    return this.store.getState().dragOffset.initialSourceClientOffset;\n  }\n\n  getClientOffset() {\n    return this.store.getState().dragOffset.clientOffset;\n  }\n\n  getSourceClientOffset() {\n    return getSourceClientOffset(this.store.getState().dragOffset);\n  }\n\n  getDifferenceFromInitialOffset() {\n    return getDifferenceFromInitialOffset(this.store.getState().dragOffset);\n  }\n\n  constructor(store, registry) {\n    this.store = store;\n    this.registry = registry;\n  }\n\n} // Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\n\n\nconst scope = typeof global !== 'undefined' ? global : self;\nconst BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\n\nfunction makeRequestCallFromTimer(callback) {\n  return function requestCall() {\n    // We dispatch a timeout with a specified delay of 0 for engines that\n    // can reliably accommodate that request. This will usually be snapped\n    // to a 4 milisecond delay, but once we're flushing, there's no delay\n    // between events.\n    const timeoutHandle = setTimeout(handleTimer, 0); // However, since this timer gets frequently dropped in Firefox\n    // workers, we enlist an interval handle that will try to fire\n    // an event 20 times per second until it succeeds.\n\n    const intervalHandle = setInterval(handleTimer, 50);\n\n    function handleTimer() {\n      // Whichever timer succeeds will cancel both timers and\n      // execute the callback.\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      callback();\n    }\n  };\n} // To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\n\n\nfunction makeRequestCallFromMutationObserver(callback) {\n  let toggle = 1;\n  const observer = new BrowserMutationObserver(callback);\n  const node = document.createTextNode('');\n  observer.observe(node, {\n    characterData: true\n  });\n  return function requestCall() {\n    toggle = -toggle;\n    node.data = toggle;\n  };\n}\n\nconst makeRequestCall = typeof BrowserMutationObserver === 'function' ? // reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nmakeRequestCallFromMutationObserver : // task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\nmakeRequestCallFromTimer;\n/* eslint-disable no-restricted-globals, @typescript-eslint/ban-ts-comment, @typescript-eslint/no-unused-vars, @typescript-eslint/no-non-null-assertion */\n\nclass AsapQueue {\n  // Use the fastest means possible to execute a task in its own turn, with\n  // priority over other events including IO, animation, reflow, and redraw\n  // events in browsers.\n  //\n  // An exception thrown by a task will permanently interrupt the processing of\n  // subsequent tasks. The higher level `asap` function ensures that if an\n  // exception is thrown by a task, that the task queue will continue flushing as\n  // soon as possible, but if you use `rawAsap` directly, you are responsible to\n  // either ensure that no exceptions are thrown from your task, or to manually\n  // call `rawAsap.requestFlush` if an exception is thrown.\n  enqueueTask(task) {\n    const {\n      queue: q,\n      requestFlush\n    } = this;\n\n    if (!q.length) {\n      requestFlush();\n      this.flushing = true;\n    } // Equivalent to push, but avoids a function call.\n\n\n    q[q.length] = task;\n  }\n\n  constructor() {\n    this.queue = []; // We queue errors to ensure they are thrown in right order (FIFO).\n    // Array-as-queue is good enough here, since we are just dealing with exceptions.\n\n    this.pendingErrors = []; // Once a flush has been requested, no further calls to `requestFlush` are\n    // necessary until the next `flush` completes.\n    // @ts-ignore\n\n    this.flushing = false; // The position of the next task to execute in the task queue. This is\n    // preserved between calls to `flush` so that it can be resumed if\n    // a task throws an exception.\n\n    this.index = 0; // If a task schedules additional tasks recursively, the task queue can grow\n    // unbounded. To prevent memory exhaustion, the task queue will periodically\n    // truncate already-completed tasks.\n\n    this.capacity = 1024; // The flush function processes all tasks that have been scheduled with\n    // `rawAsap` unless and until one of those tasks throws an exception.\n    // If a task throws an exception, `flush` ensures that its state will remain\n    // consistent and will resume where it left off when called again.\n    // However, `flush` does not make any arrangements to be called again if an\n    // exception is thrown.\n\n    this.flush = () => {\n      const {\n        queue: q\n      } = this;\n\n      while (this.index < q.length) {\n        const currentIndex = this.index; // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n\n        this.index++;\n        q[currentIndex].call(); // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n\n        if (this.index > this.capacity) {\n          // Manually shift all values starting at the index back to the\n          // beginning of the queue.\n          for (let scan = 0, newLength = q.length - this.index; scan < newLength; scan++) {\n            q[scan] = q[scan + this.index];\n          }\n\n          q.length -= this.index;\n          this.index = 0;\n        }\n      }\n\n      q.length = 0;\n      this.index = 0;\n      this.flushing = false;\n    }; // In a web browser, exceptions are not fatal. However, to avoid\n    // slowing down the queue of pending tasks, we rethrow the error in a\n    // lower priority turn.\n\n\n    this.registerPendingError = err => {\n      this.pendingErrors.push(err);\n      this.requestErrorThrow();\n    }; // `requestFlush` requests that the high priority event queue be flushed as\n    // soon as possible.\n    // This is useful to prevent an error thrown in a task from stalling the event\n    // queue if the exception handled by Node.js’s\n    // `process.on(\"uncaughtException\")` or by a domain.\n    // `requestFlush` is implemented using a strategy based on data collected from\n    // every available SauceLabs Selenium web driver worker at time of writing.\n    // https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n\n    this.requestFlush = makeRequestCall(this.flush);\n    this.requestErrorThrow = makeRequestCallFromTimer(() => {\n      // Throw first error\n      if (this.pendingErrors.length) {\n        throw this.pendingErrors.shift();\n      }\n    });\n  }\n\n} // The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// // its existence.\n// rawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n// `call`, just like a function.\n\n\nclass RawTask {\n  call() {\n    try {\n      this.task && this.task();\n    } catch (error) {\n      this.onError(error);\n    } finally {\n      this.task = null;\n      this.release(this);\n    }\n  }\n\n  constructor(onError, release) {\n    this.onError = onError;\n    this.release = release;\n    this.task = null;\n  }\n\n}\n\nclass TaskFactory {\n  create(task) {\n    const tasks = this.freeTasks;\n    const t1 = tasks.length ? tasks.pop() : new RawTask(this.onError, t => tasks[tasks.length] = t);\n    t1.task = task;\n    return t1;\n  }\n\n  constructor(onError) {\n    this.onError = onError;\n    this.freeTasks = [];\n  }\n\n}\n\nconst asapQueue = new AsapQueue();\nconst taskFactory = new TaskFactory(asapQueue.registerPendingError);\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\n\nfunction asap(task) {\n  asapQueue.enqueueTask(taskFactory.create(task));\n}\n\nconst ADD_SOURCE = 'dnd-core/ADD_SOURCE';\nconst ADD_TARGET = 'dnd-core/ADD_TARGET';\nconst REMOVE_SOURCE = 'dnd-core/REMOVE_SOURCE';\nconst REMOVE_TARGET = 'dnd-core/REMOVE_TARGET';\n\nfunction addSource(sourceId) {\n  return {\n    type: ADD_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\n\nfunction addTarget(targetId) {\n  return {\n    type: ADD_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\n\nfunction removeSource(sourceId) {\n  return {\n    type: REMOVE_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\n\nfunction removeTarget(targetId) {\n  return {\n    type: REMOVE_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\n\nfunction validateSourceContract(source) {\n  invariant(typeof source.canDrag === 'function', 'Expected canDrag to be a function.');\n  invariant(typeof source.beginDrag === 'function', 'Expected beginDrag to be a function.');\n  invariant(typeof source.endDrag === 'function', 'Expected endDrag to be a function.');\n}\n\nfunction validateTargetContract(target) {\n  invariant(typeof target.canDrop === 'function', 'Expected canDrop to be a function.');\n  invariant(typeof target.hover === 'function', 'Expected hover to be a function.');\n  invariant(typeof target.drop === 'function', 'Expected beginDrag to be a function.');\n}\n\nfunction validateType(type, allowArray) {\n  if (allowArray && Array.isArray(type)) {\n    type.forEach(t => validateType(t, false));\n    return;\n  }\n\n  invariant(typeof type === 'string' || typeof type === 'symbol', allowArray ? 'Type can only be a string, a symbol, or an array of either.' : 'Type can only be a string or a symbol.');\n}\n\nvar HandlerRole;\n\n(function (HandlerRole) {\n  HandlerRole[\"SOURCE\"] = \"SOURCE\";\n  HandlerRole[\"TARGET\"] = \"TARGET\";\n})(HandlerRole || (HandlerRole = {}));\n\nlet nextUniqueId = 0;\n\nfunction getNextUniqueId() {\n  return nextUniqueId++;\n}\n\nfunction getNextHandlerId(role) {\n  const id = getNextUniqueId().toString();\n\n  switch (role) {\n    case HandlerRole.SOURCE:\n      return `S${id}`;\n\n    case HandlerRole.TARGET:\n      return `T${id}`;\n\n    default:\n      throw new Error(`Unknown Handler Role: ${role}`);\n  }\n}\n\nfunction parseRoleFromHandlerId(handlerId) {\n  switch (handlerId[0]) {\n    case 'S':\n      return HandlerRole.SOURCE;\n\n    case 'T':\n      return HandlerRole.TARGET;\n\n    default:\n      throw new Error(`Cannot parse handler ID: ${handlerId}`);\n  }\n}\n\nfunction mapContainsValue(map, searchValue) {\n  const entries = map.entries();\n  let isDone = false;\n\n  do {\n    const {\n      done,\n      value: [, value]\n    } = entries.next();\n\n    if (value === searchValue) {\n      return true;\n    }\n\n    isDone = !!done;\n  } while (!isDone);\n\n  return false;\n}\n\nclass HandlerRegistryImpl {\n  addSource(type, source) {\n    validateType(type);\n    validateSourceContract(source);\n    const sourceId = this.addHandler(HandlerRole.SOURCE, type, source);\n    this.store.dispatch(addSource(sourceId));\n    return sourceId;\n  }\n\n  addTarget(type, target) {\n    validateType(type, true);\n    validateTargetContract(target);\n    const targetId = this.addHandler(HandlerRole.TARGET, type, target);\n    this.store.dispatch(addTarget(targetId));\n    return targetId;\n  }\n\n  containsHandler(handler) {\n    return mapContainsValue(this.dragSources, handler) || mapContainsValue(this.dropTargets, handler);\n  }\n\n  getSource(sourceId) {\n    let includePinned = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    const isPinned = includePinned && sourceId === this.pinnedSourceId;\n    const source = isPinned ? this.pinnedSource : this.dragSources.get(sourceId);\n    return source;\n  }\n\n  getTarget(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.dropTargets.get(targetId);\n  }\n\n  getSourceType(sourceId) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    return this.types.get(sourceId);\n  }\n\n  getTargetType(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.types.get(targetId);\n  }\n\n  isSourceId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.SOURCE;\n  }\n\n  isTargetId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.TARGET;\n  }\n\n  removeSource(sourceId) {\n    invariant(this.getSource(sourceId), 'Expected an existing source.');\n    this.store.dispatch(removeSource(sourceId));\n    asap(() => {\n      this.dragSources.delete(sourceId);\n      this.types.delete(sourceId);\n    });\n  }\n\n  removeTarget(targetId) {\n    invariant(this.getTarget(targetId), 'Expected an existing target.');\n    this.store.dispatch(removeTarget(targetId));\n    this.dropTargets.delete(targetId);\n    this.types.delete(targetId);\n  }\n\n  pinSource(sourceId) {\n    const source = this.getSource(sourceId);\n    invariant(source, 'Expected an existing source.');\n    this.pinnedSourceId = sourceId;\n    this.pinnedSource = source;\n  }\n\n  unpinSource() {\n    invariant(this.pinnedSource, 'No source is pinned at the time.');\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n  }\n\n  addHandler(role, type, handler) {\n    const id = getNextHandlerId(role);\n    this.types.set(id, type);\n\n    if (role === HandlerRole.SOURCE) {\n      this.dragSources.set(id, handler);\n    } else if (role === HandlerRole.TARGET) {\n      this.dropTargets.set(id, handler);\n    }\n\n    return id;\n  }\n\n  constructor(store) {\n    this.types = new Map();\n    this.dragSources = new Map();\n    this.dropTargets = new Map();\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n    this.store = store;\n  }\n\n}\n\nconst strictEquality = (a, b) => a === b;\n/**\n * Determine if two cartesian coordinate offsets are equal\n * @param offsetA\n * @param offsetB\n */\n\n\nfunction areCoordsEqual(offsetA, offsetB) {\n  if (!offsetA && !offsetB) {\n    return true;\n  } else if (!offsetA || !offsetB) {\n    return false;\n  } else {\n    return offsetA.x === offsetB.x && offsetA.y === offsetB.y;\n  }\n}\n/**\n * Determines if two arrays of items are equal\n * @param a The first array of items\n * @param b The second array of items\n */\n\n\nfunction areArraysEqual(a, b) {\n  let isEqual = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : strictEquality;\n\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (let i = 0; i < a.length; ++i) {\n    if (!isEqual(a[i], b[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction reduce$5() {\n  let _state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : NONE;\n\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case HOVER:\n      break;\n\n    case ADD_SOURCE:\n    case ADD_TARGET:\n    case REMOVE_TARGET:\n    case REMOVE_SOURCE:\n      return NONE;\n\n    case BEGIN_DRAG:\n    case PUBLISH_DRAG_SOURCE:\n    case END_DRAG:\n    case DROP:\n    default:\n      return ALL;\n  }\n\n  const {\n    targetIds = [],\n    prevTargetIds = []\n  } = action.payload;\n  const result = xor(targetIds, prevTargetIds);\n  const didChange = result.length > 0 || !areArraysEqual(targetIds, prevTargetIds);\n\n  if (!didChange) {\n    return NONE;\n  } // Check the target ids at the innermost position. If they are valid, add them\n  // to the result\n\n\n  const prevInnermostTargetId = prevTargetIds[prevTargetIds.length - 1];\n  const innermostTargetId = targetIds[targetIds.length - 1];\n\n  if (prevInnermostTargetId !== innermostTargetId) {\n    if (prevInnermostTargetId) {\n      result.push(prevInnermostTargetId);\n    }\n\n    if (innermostTargetId) {\n      result.push(innermostTargetId);\n    }\n  }\n\n  return result;\n}\n\nfunction _defineProperty$3(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$3(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$3(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nconst initialState$1 = {\n  initialSourceClientOffset: null,\n  initialClientOffset: null,\n  clientOffset: null\n};\n\nfunction reduce$4() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState$1;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  const {\n    payload\n  } = action;\n\n  switch (action.type) {\n    case INIT_COORDS:\n    case BEGIN_DRAG:\n      return {\n        initialSourceClientOffset: payload.sourceClientOffset,\n        initialClientOffset: payload.clientOffset,\n        clientOffset: payload.clientOffset\n      };\n\n    case HOVER:\n      if (areCoordsEqual(state.clientOffset, payload.clientOffset)) {\n        return state;\n      }\n\n      return _objectSpread$3({}, state, {\n        clientOffset: payload.clientOffset\n      });\n\n    case END_DRAG:\n    case DROP:\n      return initialState$1;\n\n    default:\n      return state;\n  }\n}\n\nfunction _defineProperty$2(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$2(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nconst initialState = {\n  itemType: null,\n  item: null,\n  sourceId: null,\n  targetIds: [],\n  dropResult: null,\n  didDrop: false,\n  isSourcePublic: null\n};\n\nfunction reduce$3() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  const {\n    payload\n  } = action;\n\n  switch (action.type) {\n    case BEGIN_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: payload.itemType,\n        item: payload.item,\n        sourceId: payload.sourceId,\n        isSourcePublic: payload.isSourcePublic,\n        dropResult: null,\n        didDrop: false\n      });\n\n    case PUBLISH_DRAG_SOURCE:\n      return _objectSpread$2({}, state, {\n        isSourcePublic: true\n      });\n\n    case HOVER:\n      return _objectSpread$2({}, state, {\n        targetIds: payload.targetIds\n      });\n\n    case REMOVE_TARGET:\n      if (state.targetIds.indexOf(payload.targetId) === -1) {\n        return state;\n      }\n\n      return _objectSpread$2({}, state, {\n        targetIds: without$1(state.targetIds, payload.targetId)\n      });\n\n    case DROP:\n      return _objectSpread$2({}, state, {\n        dropResult: payload.dropResult,\n        didDrop: true,\n        targetIds: []\n      });\n\n    case END_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: null,\n        item: null,\n        sourceId: null,\n        dropResult: null,\n        didDrop: false,\n        isSourcePublic: null,\n        targetIds: []\n      });\n\n    default:\n      return state;\n  }\n}\n\nfunction reduce$2() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case ADD_SOURCE:\n    case ADD_TARGET:\n      return state + 1;\n\n    case REMOVE_SOURCE:\n    case REMOVE_TARGET:\n      return state - 1;\n\n    default:\n      return state;\n  }\n}\n\nfunction reduce$1() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n  return state + 1;\n}\n\nfunction _defineProperty$1(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$1(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nfunction reduce() {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n  return {\n    dirtyHandlerIds: reduce$5(state.dirtyHandlerIds, {\n      type: action.type,\n      payload: _objectSpread$1({}, action.payload, {\n        prevTargetIds: get(state, 'dragOperation.targetIds', [])\n      })\n    }),\n    dragOffset: reduce$4(state.dragOffset, action),\n    refCount: reduce$2(state.refCount, action),\n    dragOperation: reduce$3(state.dragOperation, action),\n    stateId: reduce$1(state.stateId)\n  };\n}\n\nfunction createDragDropManager(backendFactory) {\n  let globalContext = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : undefined;\n  let backendOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  let debugMode = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n  const store = makeStoreInstance(debugMode);\n  const monitor = new DragDropMonitorImpl(store, new HandlerRegistryImpl(store));\n  const manager = new DragDropManagerImpl(store, monitor);\n  const backend = backendFactory(manager, globalContext, backendOptions);\n  manager.receiveBackend(backend);\n  return manager;\n}\n\nfunction makeStoreInstance(debugMode) {\n  // TODO: if we ever make a react-native version of this,\n  // we'll need to consider how to pull off dev-tooling\n  const reduxDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__;\n  return createStore(reduce, debugMode && reduxDevTools && reduxDevTools({\n    name: 'dnd-core',\n    instanceId: 'dnd-core'\n  }));\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\n\nlet refCount = 0;\nconst INSTANCE_SYM = Symbol.for('__REACT_DND_CONTEXT_INSTANCE__');\nvar DndProvider = /*#__PURE__*/memo(function DndProvider(_param) {\n  var {\n    children\n  } = _param,\n      props = _objectWithoutProperties(_param, [\"children\"]);\n\n  const [manager, isGlobalInstance] = getDndContextValue(props) // memoized from props\n  ;\n  /**\n  * If the global context was used to store the DND context\n  * then where theres no more references to it we should\n  * clean it up to avoid memory leaks\n  */\n\n  useEffect(() => {\n    if (isGlobalInstance) {\n      const context = getGlobalContext();\n      ++refCount;\n      return () => {\n        if (--refCount === 0) {\n          context[INSTANCE_SYM] = null;\n        }\n      };\n    }\n\n    return;\n  }, []);\n  return /*#__PURE__*/jsx(DndContext.Provider, {\n    value: manager,\n    children: children\n  });\n});\n\nfunction getDndContextValue(props) {\n  if ('manager' in props) {\n    const manager = {\n      dragDropManager: props.manager\n    };\n    return [manager, false];\n  }\n\n  const manager = createSingletonDndContext(props.backend, props.context, props.options, props.debugMode);\n  const isGlobalInstance = !props.context;\n  return [manager, isGlobalInstance];\n}\n\nfunction createSingletonDndContext(backend) {\n  let context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getGlobalContext();\n  let options = arguments.length > 2 ? arguments[2] : undefined;\n  let debugMode = arguments.length > 3 ? arguments[3] : undefined;\n  const ctx = context;\n\n  if (!ctx[INSTANCE_SYM]) {\n    ctx[INSTANCE_SYM] = {\n      dragDropManager: createDragDropManager(backend, context, options, debugMode)\n    };\n  }\n\n  return ctx[INSTANCE_SYM];\n}\n\nfunction getGlobalContext() {\n  return typeof global !== 'undefined' ? global : window;\n}\n\nvar fastDeepEqual = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n    var length, i, keys;\n\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n\n      for (i = length; i-- !== 0;) if (!equal(a[i], b[i])) return false;\n\n      return true;\n    }\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;) if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  } // true if both NaN, false otherwise\n\n\n  return a !== a && b !== b;\n};\n\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n/**\n *\n * @param monitor The monitor to collect state from\n * @param collect The collecting function\n * @param onUpdate A method to invoke when updates occur\n */\n\nfunction useCollector(monitor, collect, onUpdate) {\n  const [collected, setCollected] = useState(() => collect(monitor));\n  const updateCollected = useCallback(() => {\n    const nextValue = collect(monitor); // This needs to be a deep-equality check because some monitor-collected values\n    // include XYCoord objects that may be equivalent, but do not have instance equality.\n\n    if (!fastDeepEqual(collected, nextValue)) {\n      setCollected(nextValue);\n\n      if (onUpdate) {\n        onUpdate();\n      }\n    }\n  }, [collected, monitor, onUpdate]); // update the collected properties after react renders.\n  // Note that the \"Dustbin Stress Test\" fails if this is not\n  // done when the component updates\n\n  useIsomorphicLayoutEffect(updateCollected);\n  return [collected, updateCollected];\n}\n\nfunction useMonitorOutput(monitor, collect, onCollect) {\n  const [collected, updateCollected] = useCollector(monitor, collect, onCollect);\n  useIsomorphicLayoutEffect(function subscribeToMonitorStateChange() {\n    const handlerId = monitor.getHandlerId();\n\n    if (handlerId == null) {\n      return;\n    }\n\n    return monitor.subscribeToStateChange(updateCollected, {\n      handlerIds: [handlerId]\n    });\n  }, [monitor, updateCollected]);\n  return collected;\n}\n\nfunction useCollectedProps(collector, monitor, connector) {\n  return useMonitorOutput(monitor, collector || (() => ({})), () => connector.reconnect());\n}\n\nfunction useOptionalFactory(arg, deps) {\n  const memoDeps = [...(deps || [])];\n\n  if (deps == null && typeof arg !== 'function') {\n    memoDeps.push(arg);\n  }\n\n  return useMemo(() => {\n    return typeof arg === 'function' ? arg() : arg;\n  }, memoDeps);\n}\n\nfunction useConnectDragSource(connector) {\n  return useMemo(() => connector.hooks.dragSource(), [connector]);\n}\n\nfunction useConnectDragPreview(connector) {\n  return useMemo(() => connector.hooks.dragPreview(), [connector]);\n}\n\nlet isCallingCanDrag = false;\nlet isCallingIsDragging = false;\n\nclass DragSourceMonitorImpl {\n  receiveHandlerId(sourceId) {\n    this.sourceId = sourceId;\n  }\n\n  getHandlerId() {\n    return this.sourceId;\n  }\n\n  canDrag() {\n    invariant(!isCallingCanDrag, 'You may not call monitor.canDrag() inside your canDrag() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n\n    try {\n      isCallingCanDrag = true;\n      return this.internalMonitor.canDragSource(this.sourceId);\n    } finally {\n      isCallingCanDrag = false;\n    }\n  }\n\n  isDragging() {\n    if (!this.sourceId) {\n      return false;\n    }\n\n    invariant(!isCallingIsDragging, 'You may not call monitor.isDragging() inside your isDragging() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n\n    try {\n      isCallingIsDragging = true;\n      return this.internalMonitor.isDraggingSource(this.sourceId);\n    } finally {\n      isCallingIsDragging = false;\n    }\n  }\n\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n\n  isDraggingSource(sourceId) {\n    return this.internalMonitor.isDraggingSource(sourceId);\n  }\n\n  isOverTarget(targetId, options) {\n    return this.internalMonitor.isOverTarget(targetId, options);\n  }\n\n  getTargetIds() {\n    return this.internalMonitor.getTargetIds();\n  }\n\n  isSourcePublic() {\n    return this.internalMonitor.isSourcePublic();\n  }\n\n  getSourceId() {\n    return this.internalMonitor.getSourceId();\n  }\n\n  subscribeToOffsetChange(listener) {\n    return this.internalMonitor.subscribeToOffsetChange(listener);\n  }\n\n  canDragSource(sourceId) {\n    return this.internalMonitor.canDragSource(sourceId);\n  }\n\n  canDropOnTarget(targetId) {\n    return this.internalMonitor.canDropOnTarget(targetId);\n  }\n\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n\n  constructor(manager) {\n    this.sourceId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n\n}\n\nlet isCallingCanDrop = false;\n\nclass DropTargetMonitorImpl {\n  receiveHandlerId(targetId) {\n    this.targetId = targetId;\n  }\n\n  getHandlerId() {\n    return this.targetId;\n  }\n\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n\n  canDrop() {\n    // Cut out early if the target id has not been set. This should prevent errors\n    // where the user has an older version of dnd-core like in\n    // https://github.com/react-dnd/react-dnd/issues/1310\n    if (!this.targetId) {\n      return false;\n    }\n\n    invariant(!isCallingCanDrop, 'You may not call monitor.canDrop() inside your canDrop() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor');\n\n    try {\n      isCallingCanDrop = true;\n      return this.internalMonitor.canDropOnTarget(this.targetId);\n    } finally {\n      isCallingCanDrop = false;\n    }\n  }\n\n  isOver(options) {\n    if (!this.targetId) {\n      return false;\n    }\n\n    return this.internalMonitor.isOverTarget(this.targetId, options);\n  }\n\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n\n  constructor(manager) {\n    this.targetId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n\n}\n\nfunction registerTarget(type, target, manager) {\n  const registry = manager.getRegistry();\n  const targetId = registry.addTarget(type, target);\n  return [targetId, () => registry.removeTarget(targetId)];\n}\n\nfunction registerSource(type, source, manager) {\n  const registry = manager.getRegistry();\n  const sourceId = registry.addSource(type, source);\n  return [sourceId, () => registry.removeSource(sourceId)];\n}\n\nfunction shallowEqual(objA, objB, compare, compareContext) {\n  let compareResult = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (compareResult !== void 0) {\n    return !!compareResult;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== 'object' || !objA || typeof objB !== 'object' || !objB) {\n    return false;\n  }\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  const bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB); // Test for A's keys different from B.\n\n  for (let idx = 0; idx < keysA.length; idx++) {\n    const key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    const valueA = objA[key];\n    const valueB = objB[key];\n    compareResult = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (compareResult === false || compareResult === void 0 && valueA !== valueB) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isRef(obj) {\n  return (// eslint-disable-next-line no-prototype-builtins\n    obj !== null && typeof obj === 'object' && Object.prototype.hasOwnProperty.call(obj, 'current')\n  );\n}\n\nfunction throwIfCompositeComponentElement(element) {\n  // Custom components can no longer be wrapped directly in React DnD 2.0\n  // so that we don't need to depend on findDOMNode() from react-dom.\n  if (typeof element.type === 'string') {\n    return;\n  }\n\n  const displayName = element.type.displayName || element.type.name || 'the component';\n  throw new Error('Only native element nodes can now be passed to React DnD connectors.' + `You can either wrap ${displayName} into a <div>, or turn it into a ` + 'drag source or a drop target itself.');\n}\n\nfunction wrapHookToRecognizeElement(hook) {\n  return function () {\n    let elementOrNode = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : null;\n    let options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n\n    // When passed a node, call the hook straight away.\n    if (! /*#__PURE__*/isValidElement(elementOrNode)) {\n      const node = elementOrNode;\n      hook(node, options); // return the node so it can be chained (e.g. when within callback refs\n      // <div ref={node => connectDragSource(connectDropTarget(node))}/>\n\n      return node;\n    } // If passed a ReactElement, clone it and attach this function as a ref.\n    // This helps us achieve a neat API where user doesn't even know that refs\n    // are being used under the hood.\n\n\n    const element = elementOrNode;\n    throwIfCompositeComponentElement(element); // When no options are passed, use the hook directly\n\n    const ref = options ? node => hook(node, options) : hook;\n    return cloneWithRef(element, ref);\n  };\n}\n\nfunction wrapConnectorHooks(hooks) {\n  const wrappedHooks = {};\n  Object.keys(hooks).forEach(key => {\n    const hook = hooks[key]; // ref objects should be passed straight through without wrapping\n\n    if (key.endsWith('Ref')) {\n      wrappedHooks[key] = hooks[key];\n    } else {\n      const wrappedHook = wrapHookToRecognizeElement(hook);\n\n      wrappedHooks[key] = () => wrappedHook;\n    }\n  });\n  return wrappedHooks;\n}\n\nfunction setRef(ref, node) {\n  if (typeof ref === 'function') {\n    ref(node);\n  } else {\n    ref.current = node;\n  }\n}\n\nfunction cloneWithRef(element, newRef) {\n  const previousRef = element.ref;\n  invariant(typeof previousRef !== 'string', 'Cannot connect React DnD to an element with an existing string ref. ' + 'Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. ' + 'Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs');\n\n  if (!previousRef) {\n    // When there is no ref on the element, use the new ref directly\n    return /*#__PURE__*/cloneElement(element, {\n      ref: newRef\n    });\n  } else {\n    return /*#__PURE__*/cloneElement(element, {\n      ref: node => {\n        setRef(previousRef, node);\n        setRef(newRef, node);\n      }\n    });\n  }\n}\n\nclass SourceConnector {\n  receiveHandlerId(newHandlerId) {\n    if (this.handlerId === newHandlerId) {\n      return;\n    }\n\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n\n  get connectTarget() {\n    return this.dragSource;\n  }\n\n  get dragSourceOptions() {\n    return this.dragSourceOptionsInternal;\n  }\n\n  set dragSourceOptions(options) {\n    this.dragSourceOptionsInternal = options;\n  }\n\n  get dragPreviewOptions() {\n    return this.dragPreviewOptionsInternal;\n  }\n\n  set dragPreviewOptions(options) {\n    this.dragPreviewOptionsInternal = options;\n  }\n\n  reconnect() {\n    const didChange = this.reconnectDragSource();\n    this.reconnectDragPreview(didChange);\n  }\n\n  reconnectDragSource() {\n    const dragSource = this.dragSource; // if nothing has changed then don't resubscribe\n\n    const didChange = this.didHandlerIdChange() || this.didConnectedDragSourceChange() || this.didDragSourceOptionsChange();\n\n    if (didChange) {\n      this.disconnectDragSource();\n    }\n\n    if (!this.handlerId) {\n      return didChange;\n    }\n\n    if (!dragSource) {\n      this.lastConnectedDragSource = dragSource;\n      return didChange;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragSource = dragSource;\n      this.lastConnectedDragSourceOptions = this.dragSourceOptions;\n      this.dragSourceUnsubscribe = this.backend.connectDragSource(this.handlerId, dragSource, this.dragSourceOptions);\n    }\n\n    return didChange;\n  }\n\n  reconnectDragPreview() {\n    let forceDidChange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n    const dragPreview = this.dragPreview; // if nothing has changed then don't resubscribe\n\n    const didChange = forceDidChange || this.didHandlerIdChange() || this.didConnectedDragPreviewChange() || this.didDragPreviewOptionsChange();\n\n    if (didChange) {\n      this.disconnectDragPreview();\n    }\n\n    if (!this.handlerId) {\n      return;\n    }\n\n    if (!dragPreview) {\n      this.lastConnectedDragPreview = dragPreview;\n      return;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragPreview = dragPreview;\n      this.lastConnectedDragPreviewOptions = this.dragPreviewOptions;\n      this.dragPreviewUnsubscribe = this.backend.connectDragPreview(this.handlerId, dragPreview, this.dragPreviewOptions);\n    }\n  }\n\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n\n  didConnectedDragSourceChange() {\n    return this.lastConnectedDragSource !== this.dragSource;\n  }\n\n  didConnectedDragPreviewChange() {\n    return this.lastConnectedDragPreview !== this.dragPreview;\n  }\n\n  didDragSourceOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragSourceOptions, this.dragSourceOptions);\n  }\n\n  didDragPreviewOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragPreviewOptions, this.dragPreviewOptions);\n  }\n\n  disconnectDragSource() {\n    if (this.dragSourceUnsubscribe) {\n      this.dragSourceUnsubscribe();\n      this.dragSourceUnsubscribe = undefined;\n    }\n  }\n\n  disconnectDragPreview() {\n    if (this.dragPreviewUnsubscribe) {\n      this.dragPreviewUnsubscribe();\n      this.dragPreviewUnsubscribe = undefined;\n      this.dragPreviewNode = null;\n      this.dragPreviewRef = null;\n    }\n  }\n\n  get dragSource() {\n    return this.dragSourceNode || this.dragSourceRef && this.dragSourceRef.current;\n  }\n\n  get dragPreview() {\n    return this.dragPreviewNode || this.dragPreviewRef && this.dragPreviewRef.current;\n  }\n\n  clearDragSource() {\n    this.dragSourceNode = null;\n    this.dragSourceRef = null;\n  }\n\n  clearDragPreview() {\n    this.dragPreviewNode = null;\n    this.dragPreviewRef = null;\n  }\n\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dragSource: (node, options) => {\n        this.clearDragSource();\n        this.dragSourceOptions = options || null;\n\n        if (isRef(node)) {\n          this.dragSourceRef = node;\n        } else {\n          this.dragSourceNode = node;\n        }\n\n        this.reconnectDragSource();\n      },\n      dragPreview: (node, options) => {\n        this.clearDragPreview();\n        this.dragPreviewOptions = options || null;\n\n        if (isRef(node)) {\n          this.dragPreviewRef = node;\n        } else {\n          this.dragPreviewNode = node;\n        }\n\n        this.reconnectDragPreview();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dragSourceRef = null;\n    this.dragSourceOptionsInternal = null; // The drag preview may either be attached via ref or connect function\n\n    this.dragPreviewRef = null;\n    this.dragPreviewOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDragSource = null;\n    this.lastConnectedDragSourceOptions = null;\n    this.lastConnectedDragPreview = null;\n    this.lastConnectedDragPreviewOptions = null;\n    this.backend = backend;\n  }\n\n}\n\nclass TargetConnector {\n  get connectTarget() {\n    return this.dropTarget;\n  }\n\n  reconnect() {\n    // if nothing has changed then don't resubscribe\n    const didChange = this.didHandlerIdChange() || this.didDropTargetChange() || this.didOptionsChange();\n\n    if (didChange) {\n      this.disconnectDropTarget();\n    }\n\n    const dropTarget = this.dropTarget;\n\n    if (!this.handlerId) {\n      return;\n    }\n\n    if (!dropTarget) {\n      this.lastConnectedDropTarget = dropTarget;\n      return;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDropTarget = dropTarget;\n      this.lastConnectedDropTargetOptions = this.dropTargetOptions;\n      this.unsubscribeDropTarget = this.backend.connectDropTarget(this.handlerId, dropTarget, this.dropTargetOptions);\n    }\n  }\n\n  receiveHandlerId(newHandlerId) {\n    if (newHandlerId === this.handlerId) {\n      return;\n    }\n\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n\n  get dropTargetOptions() {\n    return this.dropTargetOptionsInternal;\n  }\n\n  set dropTargetOptions(options) {\n    this.dropTargetOptionsInternal = options;\n  }\n\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n\n  didDropTargetChange() {\n    return this.lastConnectedDropTarget !== this.dropTarget;\n  }\n\n  didOptionsChange() {\n    return !shallowEqual(this.lastConnectedDropTargetOptions, this.dropTargetOptions);\n  }\n\n  disconnectDropTarget() {\n    if (this.unsubscribeDropTarget) {\n      this.unsubscribeDropTarget();\n      this.unsubscribeDropTarget = undefined;\n    }\n  }\n\n  get dropTarget() {\n    return this.dropTargetNode || this.dropTargetRef && this.dropTargetRef.current;\n  }\n\n  clearDropTarget() {\n    this.dropTargetRef = null;\n    this.dropTargetNode = null;\n  }\n\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dropTarget: (node, options) => {\n        this.clearDropTarget();\n        this.dropTargetOptions = options;\n\n        if (isRef(node)) {\n          this.dropTargetRef = node;\n        } else {\n          this.dropTargetNode = node;\n        }\n\n        this.reconnect();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dropTargetRef = null;\n    this.dropTargetOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDropTarget = null;\n    this.lastConnectedDropTargetOptions = null;\n    this.backend = backend;\n  }\n\n}\n/**\n * A hook to retrieve the DragDropManager from Context\n */\n\n\nfunction useDragDropManager() {\n  const {\n    dragDropManager\n  } = useContext(DndContext);\n  invariant(dragDropManager != null, 'Expected drag drop context');\n  return dragDropManager;\n}\n\nfunction useDragSourceConnector(dragSourceOptions, dragPreviewOptions) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new SourceConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragSourceOptions = dragSourceOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragSource();\n  }, [connector, dragSourceOptions]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragPreviewOptions = dragPreviewOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragPreview();\n  }, [connector, dragPreviewOptions]);\n  return connector;\n}\n\nfunction useDragSourceMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DragSourceMonitorImpl(manager), [manager]);\n}\n\nclass DragSourceImpl {\n  beginDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    let result = null;\n\n    if (typeof spec.item === 'object') {\n      result = spec.item;\n    } else if (typeof spec.item === 'function') {\n      result = spec.item(monitor);\n    } else {\n      result = {};\n    }\n\n    return result !== null && result !== void 0 ? result : null;\n  }\n\n  canDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (typeof spec.canDrag === 'boolean') {\n      return spec.canDrag;\n    } else if (typeof spec.canDrag === 'function') {\n      return spec.canDrag(monitor);\n    } else {\n      return true;\n    }\n  }\n\n  isDragging(globalMonitor, target) {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const {\n      isDragging\n    } = spec;\n    return isDragging ? isDragging(monitor) : target === globalMonitor.getSourceId();\n  }\n\n  endDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const connector = this.connector;\n    const {\n      end\n    } = spec;\n\n    if (end) {\n      end(monitor.getItem(), monitor);\n    }\n\n    connector.reconnect();\n  }\n\n  constructor(spec, monitor, connector) {\n    this.spec = spec;\n    this.monitor = monitor;\n    this.connector = connector;\n  }\n\n}\n\nfunction useDragSource(spec, monitor, connector) {\n  const handler = useMemo(() => new DragSourceImpl(spec, monitor, connector), [monitor, connector]);\n  useEffect(() => {\n    handler.spec = spec;\n  }, [spec]);\n  return handler;\n}\n\nfunction useDragType(spec) {\n  return useMemo(() => {\n    const result = spec.type;\n    invariant(result != null, 'spec.type must be defined');\n    return result;\n  }, [spec]);\n}\n\nfunction useRegisteredDragSource(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const handler = useDragSource(spec, monitor, connector);\n  const itemType = useDragType(spec);\n  useIsomorphicLayoutEffect(function registerDragSource() {\n    if (itemType != null) {\n      const [handlerId, unregister] = registerSource(itemType, handler, manager);\n      monitor.receiveHandlerId(handlerId);\n      connector.receiveHandlerId(handlerId);\n      return unregister;\n    }\n\n    return;\n  }, [manager, monitor, connector, handler, itemType]);\n}\n/**\n * useDragSource hook\n * @param sourceSpec The drag source specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\n\nfunction useDrag(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  invariant(!spec.begin, `useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)`);\n  const monitor = useDragSourceMonitor();\n  const connector = useDragSourceConnector(spec.options, spec.previewOptions);\n  useRegisteredDragSource(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDragSource(connector), useConnectDragPreview(connector)];\n}\n/**\n * useDragLayer Hook\n * @param collector The property collector\n */\n\n\nfunction useDragLayer(collect) {\n  const dragDropManager = useDragDropManager();\n  const monitor = dragDropManager.getMonitor();\n  const [collected, updateCollected] = useCollector(monitor, collect);\n  useEffect(() => monitor.subscribeToOffsetChange(updateCollected));\n  useEffect(() => monitor.subscribeToStateChange(updateCollected));\n  return collected;\n}\n\nfunction useConnectDropTarget(connector) {\n  return useMemo(() => connector.hooks.dropTarget(), [connector]);\n}\n\nfunction useDropTargetConnector(options) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new TargetConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dropTargetOptions = options || null;\n    connector.reconnect();\n    return () => connector.disconnectDropTarget();\n  }, [options]);\n  return connector;\n}\n\nfunction useDropTargetMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DropTargetMonitorImpl(manager), [manager]);\n}\n/**\n * Internal utility hook to get an array-version of spec.accept.\n * The main utility here is that we aren't creating a new array on every render if a non-array spec.accept is passed in.\n * @param spec\n */\n\n\nfunction useAccept(spec) {\n  const {\n    accept\n  } = spec;\n  return useMemo(() => {\n    invariant(spec.accept != null, 'accept must be defined');\n    return Array.isArray(accept) ? accept : [accept];\n  }, [accept]);\n}\n\nclass DropTargetImpl {\n  canDrop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    return spec.canDrop ? spec.canDrop(monitor.getItem(), monitor) : true;\n  }\n\n  hover() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (spec.hover) {\n      spec.hover(monitor.getItem(), monitor);\n    }\n  }\n\n  drop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (spec.drop) {\n      return spec.drop(monitor.getItem(), monitor);\n    }\n\n    return;\n  }\n\n  constructor(spec, monitor) {\n    this.spec = spec;\n    this.monitor = monitor;\n  }\n\n}\n\nfunction useDropTarget(spec, monitor) {\n  const dropTarget = useMemo(() => new DropTargetImpl(spec, monitor), [monitor]);\n  useEffect(() => {\n    dropTarget.spec = spec;\n  }, [spec]);\n  return dropTarget;\n}\n\nfunction useRegisteredDropTarget(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const dropTarget = useDropTarget(spec, monitor);\n  const accept = useAccept(spec);\n  useIsomorphicLayoutEffect(function registerDropTarget() {\n    const [handlerId, unregister] = registerTarget(accept, dropTarget, manager);\n    monitor.receiveHandlerId(handlerId);\n    connector.receiveHandlerId(handlerId);\n    return unregister;\n  }, [manager, monitor, dropTarget, connector, accept.map(a => a.toString()).join('|')]);\n}\n/**\n * useDropTarget Hook\n * @param spec The drop target specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\n\nfunction useDrop(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  const monitor = useDropTargetMonitor();\n  const connector = useDropTargetConnector(spec.options);\n  useRegisteredDropTarget(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDropTarget(connector)];\n} // cheap lodash replacements\n\n\nfunction memoize(fn) {\n  let result = null;\n\n  const memoized = () => {\n    if (result == null) {\n      result = fn();\n    }\n\n    return result;\n  };\n\n  return memoized;\n}\n/**\n * drop-in replacement for _.without\n */\n\n\nfunction without(items, item) {\n  return items.filter(i => i !== item);\n}\n\nfunction union(itemsA, itemsB) {\n  const set = new Set();\n\n  const insertItem = item => set.add(item);\n\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  set.forEach(key => result.push(key));\n  return result;\n}\n\nclass EnterLeaveCounter {\n  enter(enteringNode) {\n    const previousLength = this.entered.length;\n\n    const isNodeEntered = node => this.isNodeInDocument(node) && (!node.contains || node.contains(enteringNode));\n\n    this.entered = union(this.entered.filter(isNodeEntered), [enteringNode]);\n    return previousLength === 0 && this.entered.length > 0;\n  }\n\n  leave(leavingNode) {\n    const previousLength = this.entered.length;\n    this.entered = without(this.entered.filter(this.isNodeInDocument), leavingNode);\n    return previousLength > 0 && this.entered.length === 0;\n  }\n\n  reset() {\n    this.entered = [];\n  }\n\n  constructor(isNodeInDocument) {\n    this.entered = [];\n    this.isNodeInDocument = isNodeInDocument;\n  }\n\n}\n\nclass NativeDragSource {\n  initializeExposedProperties() {\n    Object.keys(this.config.exposeProperties).forEach(property => {\n      Object.defineProperty(this.item, property, {\n        configurable: true,\n        enumerable: true,\n\n        get() {\n          // eslint-disable-next-line no-console\n          console.warn(`Browser doesn't allow reading \"${property}\" until the drop event.`);\n          return null;\n        }\n\n      });\n    });\n  }\n\n  loadDataTransfer(dataTransfer) {\n    if (dataTransfer) {\n      const newProperties = {};\n      Object.keys(this.config.exposeProperties).forEach(property => {\n        const propertyFn = this.config.exposeProperties[property];\n\n        if (propertyFn != null) {\n          newProperties[property] = {\n            value: propertyFn(dataTransfer, this.config.matchesTypes),\n            configurable: true,\n            enumerable: true\n          };\n        }\n      });\n      Object.defineProperties(this.item, newProperties);\n    }\n  }\n\n  canDrag() {\n    return true;\n  }\n\n  beginDrag() {\n    return this.item;\n  }\n\n  isDragging(monitor, handle) {\n    return handle === monitor.getSourceId();\n  }\n\n  endDrag() {// empty\n  }\n\n  constructor(config) {\n    this.config = config;\n    this.item = {};\n    this.initializeExposedProperties();\n  }\n\n}\n\nconst FILE = '__NATIVE_FILE__';\nconst URL = '__NATIVE_URL__';\nconst TEXT = '__NATIVE_TEXT__';\nconst HTML = '__NATIVE_HTML__';\nvar NativeTypes = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  FILE: FILE,\n  URL: URL,\n  TEXT: TEXT,\n  HTML: HTML\n});\n\nfunction getDataFromDataTransfer(dataTransfer, typesToTry, defaultValue) {\n  const result = typesToTry.reduce((resultSoFar, typeToTry) => resultSoFar || dataTransfer.getData(typeToTry), '');\n  return result != null ? result : defaultValue;\n}\n\nconst nativeTypesConfig = {\n  [FILE]: {\n    exposeProperties: {\n      files: dataTransfer => Array.prototype.slice.call(dataTransfer.files),\n      items: dataTransfer => dataTransfer.items,\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Files']\n  },\n  [HTML]: {\n    exposeProperties: {\n      html: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Html', 'text/html']\n  },\n  [URL]: {\n    exposeProperties: {\n      urls: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, '').split('\\n'),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Url', 'text/uri-list']\n  },\n  [TEXT]: {\n    exposeProperties: {\n      text: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Text', 'text/plain']\n  }\n};\n\nfunction createNativeDragSource(type, dataTransfer) {\n  const config = nativeTypesConfig[type];\n\n  if (!config) {\n    throw new Error(`native type ${type} has no configuration`);\n  }\n\n  const result = new NativeDragSource(config);\n  result.loadDataTransfer(dataTransfer);\n  return result;\n}\n\nfunction matchNativeItemType(dataTransfer) {\n  if (!dataTransfer) {\n    return null;\n  }\n\n  const dataTransferTypes = Array.prototype.slice.call(dataTransfer.types || []);\n  return Object.keys(nativeTypesConfig).filter(nativeItemType => {\n    const typeConfig = nativeTypesConfig[nativeItemType];\n\n    if (!(typeConfig === null || typeConfig === void 0 ? void 0 : typeConfig.matchesTypes)) {\n      return false;\n    }\n\n    return typeConfig.matchesTypes.some(t => dataTransferTypes.indexOf(t) > -1);\n  })[0] || null;\n}\n\nconst isFirefox = memoize(() => /firefox/i.test(navigator.userAgent));\nconst isSafari = memoize(() => Boolean(window.safari));\n\nclass MonotonicInterpolant {\n  interpolate(x) {\n    const {\n      xs,\n      ys,\n      c1s,\n      c2s,\n      c3s\n    } = this; // The rightmost point in the dataset should give an exact result\n\n    let i = xs.length - 1;\n\n    if (x === xs[i]) {\n      return ys[i];\n    } // Search for the interval x is in, returning the corresponding y if x is one of the original xs\n\n\n    let low = 0;\n    let high = c3s.length - 1;\n    let mid;\n\n    while (low <= high) {\n      mid = Math.floor(0.5 * (low + high));\n      const xHere = xs[mid];\n\n      if (xHere < x) {\n        low = mid + 1;\n      } else if (xHere > x) {\n        high = mid - 1;\n      } else {\n        return ys[mid];\n      }\n    }\n\n    i = Math.max(0, high); // Interpolate\n\n    const diff = x - xs[i];\n    const diffSq = diff * diff;\n    return ys[i] + c1s[i] * diff + c2s[i] * diffSq + c3s[i] * diff * diffSq;\n  }\n\n  constructor(xs, ys) {\n    const {\n      length\n    } = xs; // Rearrange xs and ys so that xs is sorted\n\n    const indexes = [];\n\n    for (let i = 0; i < length; i++) {\n      indexes.push(i);\n    }\n\n    indexes.sort((a, b) => xs[a] < xs[b] ? -1 : 1); // Get consecutive differences and slopes\n\n    const dxs = [];\n    const ms = [];\n    let dx;\n    let dy;\n\n    for (let i1 = 0; i1 < length - 1; i1++) {\n      dx = xs[i1 + 1] - xs[i1];\n      dy = ys[i1 + 1] - ys[i1];\n      dxs.push(dx);\n      ms.push(dy / dx);\n    } // Get degree-1 coefficients\n\n\n    const c1s = [ms[0]];\n\n    for (let i2 = 0; i2 < dxs.length - 1; i2++) {\n      const m2 = ms[i2];\n      const mNext = ms[i2 + 1];\n\n      if (m2 * mNext <= 0) {\n        c1s.push(0);\n      } else {\n        dx = dxs[i2];\n        const dxNext = dxs[i2 + 1];\n        const common = dx + dxNext;\n        c1s.push(3 * common / ((common + dxNext) / m2 + (common + dx) / mNext));\n      }\n    }\n\n    c1s.push(ms[ms.length - 1]); // Get degree-2 and degree-3 coefficients\n\n    const c2s = [];\n    const c3s = [];\n    let m;\n\n    for (let i3 = 0; i3 < c1s.length - 1; i3++) {\n      m = ms[i3];\n      const c1 = c1s[i3];\n      const invDx = 1 / dxs[i3];\n      const common = c1 + c1s[i3 + 1] - m - m;\n      c2s.push((m - c1 - common) * invDx);\n      c3s.push(common * invDx * invDx);\n    }\n\n    this.xs = xs;\n    this.ys = ys;\n    this.c1s = c1s;\n    this.c2s = c2s;\n    this.c3s = c3s;\n  }\n\n}\n\nconst ELEMENT_NODE$1 = 1;\n\nfunction getNodeClientOffset$1(node) {\n  const el = node.nodeType === ELEMENT_NODE$1 ? node : node.parentElement;\n\n  if (!el) {\n    return null;\n  }\n\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\n\nfunction getEventClientOffset$1(e) {\n  return {\n    x: e.clientX,\n    y: e.clientY\n  };\n}\n\nfunction isImageNode(node) {\n  var ref;\n  return node.nodeName === 'IMG' && (isFirefox() || !((ref = document.documentElement) === null || ref === void 0 ? void 0 : ref.contains(node)));\n}\n\nfunction getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight) {\n  let dragPreviewWidth = isImage ? dragPreview.width : sourceWidth;\n  let dragPreviewHeight = isImage ? dragPreview.height : sourceHeight; // Work around @2x coordinate discrepancies in browsers\n\n  if (isSafari() && isImage) {\n    dragPreviewHeight /= window.devicePixelRatio;\n    dragPreviewWidth /= window.devicePixelRatio;\n  }\n\n  return {\n    dragPreviewWidth,\n    dragPreviewHeight\n  };\n}\n\nfunction getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint) {\n  // The browsers will use the image intrinsic size under different conditions.\n  // Firefox only cares if it's an image, but WebKit also wants it to be detached.\n  const isImage = isImageNode(dragPreview);\n  const dragPreviewNode = isImage ? sourceNode : dragPreview;\n  const dragPreviewNodeOffsetFromClient = getNodeClientOffset$1(dragPreviewNode);\n  const offsetFromDragPreview = {\n    x: clientOffset.x - dragPreviewNodeOffsetFromClient.x,\n    y: clientOffset.y - dragPreviewNodeOffsetFromClient.y\n  };\n  const {\n    offsetWidth: sourceWidth,\n    offsetHeight: sourceHeight\n  } = sourceNode;\n  const {\n    anchorX,\n    anchorY\n  } = anchorPoint;\n  const {\n    dragPreviewWidth,\n    dragPreviewHeight\n  } = getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight);\n\n  const calculateYOffset = () => {\n    const interpolantY = new MonotonicInterpolant([0, 0.5, 1], [// Dock to the top\n    offsetFromDragPreview.y, // Align at the center\n    offsetFromDragPreview.y / sourceHeight * dragPreviewHeight, // Dock to the bottom\n    offsetFromDragPreview.y + dragPreviewHeight - sourceHeight]);\n    let y = interpolantY.interpolate(anchorY); // Work around Safari 8 positioning bug\n\n    if (isSafari() && isImage) {\n      // We'll have to wait for @3x to see if this is entirely correct\n      y += (window.devicePixelRatio - 1) * dragPreviewHeight;\n    }\n\n    return y;\n  };\n\n  const calculateXOffset = () => {\n    // Interpolate coordinates depending on anchor point\n    // If you know a simpler way to do this, let me know\n    const interpolantX = new MonotonicInterpolant([0, 0.5, 1], [// Dock to the left\n    offsetFromDragPreview.x, // Align at the center\n    offsetFromDragPreview.x / sourceWidth * dragPreviewWidth, // Dock to the right\n    offsetFromDragPreview.x + dragPreviewWidth - sourceWidth]);\n    return interpolantX.interpolate(anchorX);\n  }; // Force offsets if specified in the options.\n\n\n  const {\n    offsetX,\n    offsetY\n  } = offsetPoint;\n  const isManualOffsetX = offsetX === 0 || offsetX;\n  const isManualOffsetY = offsetY === 0 || offsetY;\n  return {\n    x: isManualOffsetX ? offsetX : calculateXOffset(),\n    y: isManualOffsetY ? offsetY : calculateYOffset()\n  };\n}\n\nclass OptionsReader$1 {\n  get window() {\n    if (this.globalContext) {\n      return this.globalContext;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n\n    return undefined;\n  }\n\n  get document() {\n    var ref;\n\n    if ((ref = this.globalContext) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.globalContext.document;\n    } else if (this.window) {\n      return this.window.document;\n    } else {\n      return undefined;\n    }\n  }\n\n  get rootElement() {\n    var ref;\n    return ((ref = this.optionsArgs) === null || ref === void 0 ? void 0 : ref.rootElement) || this.window;\n  }\n\n  constructor(globalContext, options) {\n    this.ownerDocument = null;\n    this.globalContext = globalContext;\n    this.optionsArgs = options;\n  }\n\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\n\nclass HTML5BackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref, ref1;\n    return {\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      sourceNodeOptions: this.sourceNodeOptions.size,\n      sourceNodes: this.sourceNodes.size,\n      dragStartSourceIds: ((ref = this.dragStartSourceIds) === null || ref === void 0 ? void 0 : ref.length) || 0,\n      dropTargetIds: this.dropTargetIds.length,\n      dragEnterTargetIds: this.dragEnterTargetIds.length,\n      dragOverTargetIds: ((ref1 = this.dragOverTargetIds) === null || ref1 === void 0 ? void 0 : ref1.length) || 0\n    };\n  } // public for test\n\n\n  get window() {\n    return this.options.window;\n  }\n\n  get document() {\n    return this.options.document;\n  }\n  /**\n  * Get the root element to use for event subscriptions\n  */\n\n\n  get rootElement() {\n    return this.options.rootElement;\n  }\n\n  setup() {\n    const root = this.rootElement;\n\n    if (root === undefined) {\n      return;\n    }\n\n    if (root.__isReactDndBackendSetUp) {\n      throw new Error('Cannot have two HTML5 backends at the same time.');\n    }\n\n    root.__isReactDndBackendSetUp = true;\n    this.addEventListeners(root);\n  }\n\n  teardown() {\n    const root = this.rootElement;\n\n    if (root === undefined) {\n      return;\n    }\n\n    root.__isReactDndBackendSetUp = false;\n    this.removeEventListeners(this.rootElement);\n    this.clearCurrentDragSourceNode();\n\n    if (this.asyncEndDragFrameId) {\n      var ref;\n      (ref = this.window) === null || ref === void 0 ? void 0 : ref.cancelAnimationFrame(this.asyncEndDragFrameId);\n    }\n  }\n\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n\n  connectDragSource(sourceId, node, options) {\n    this.sourceNodes.set(sourceId, node);\n    this.sourceNodeOptions.set(sourceId, options);\n\n    const handleDragStart = e => this.handleDragStart(e, sourceId);\n\n    const handleSelectStart = e => this.handleSelectStart(e);\n\n    node.setAttribute('draggable', 'true');\n    node.addEventListener('dragstart', handleDragStart);\n    node.addEventListener('selectstart', handleSelectStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.sourceNodeOptions.delete(sourceId);\n      node.removeEventListener('dragstart', handleDragStart);\n      node.removeEventListener('selectstart', handleSelectStart);\n      node.setAttribute('draggable', 'false');\n    };\n  }\n\n  connectDropTarget(targetId, node) {\n    const handleDragEnter = e => this.handleDragEnter(e, targetId);\n\n    const handleDragOver = e => this.handleDragOver(e, targetId);\n\n    const handleDrop = e => this.handleDrop(e, targetId);\n\n    node.addEventListener('dragenter', handleDragEnter);\n    node.addEventListener('dragover', handleDragOver);\n    node.addEventListener('drop', handleDrop);\n    return () => {\n      node.removeEventListener('dragenter', handleDragEnter);\n      node.removeEventListener('dragover', handleDragOver);\n      node.removeEventListener('drop', handleDrop);\n    };\n  }\n\n  addEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.addEventListener) {\n      return;\n    }\n\n    target.addEventListener('dragstart', this.handleTopDragStart);\n    target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.addEventListener('dragenter', this.handleTopDragEnter);\n    target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.addEventListener('dragover', this.handleTopDragOver);\n    target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.addEventListener('drop', this.handleTopDrop);\n    target.addEventListener('drop', this.handleTopDropCapture, true);\n  }\n\n  removeEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.removeEventListener) {\n      return;\n    }\n\n    target.removeEventListener('dragstart', this.handleTopDragStart);\n    target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.removeEventListener('dragenter', this.handleTopDragEnter);\n    target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.removeEventListener('dragover', this.handleTopDragOver);\n    target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.removeEventListener('drop', this.handleTopDrop);\n    target.removeEventListener('drop', this.handleTopDropCapture, true);\n  }\n\n  getCurrentSourceNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n    return _objectSpread({\n      dropEffect: this.altKeyPressed ? 'copy' : 'move'\n    }, sourceNodeOptions || {});\n  }\n\n  getCurrentDropEffect() {\n    if (this.isDraggingNativeItem()) {\n      // It makes more sense to default to 'copy' for native resources\n      return 'copy';\n    }\n\n    return this.getCurrentSourceNodeOptions().dropEffect;\n  }\n\n  getCurrentSourcePreviewNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n    return _objectSpread({\n      anchorX: 0.5,\n      anchorY: 0.5,\n      captureDraggingState: false\n    }, sourcePreviewNodeOptions || {});\n  }\n\n  isDraggingNativeItem() {\n    const itemType = this.monitor.getItemType();\n    return Object.keys(NativeTypes).some(key => NativeTypes[key] === itemType);\n  }\n\n  beginDragNativeItem(type, dataTransfer) {\n    this.clearCurrentDragSourceNode();\n    this.currentNativeSource = createNativeDragSource(type, dataTransfer);\n    this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n    this.actions.beginDrag([this.currentNativeHandle]);\n  }\n\n  setCurrentDragSourceNode(node) {\n    this.clearCurrentDragSourceNode();\n    this.currentDragSourceNode = node; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n\n    const MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n    // means it has ended and the drag source node disappeared from DOM,\n    // so the browser didn't dispatch the dragend event.\n    //\n    // We need to wait before we start listening for mousemove events.\n    // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n    // immediately in some browsers.\n    //\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    //\n\n    this.mouseMoveTimeoutTimer = setTimeout(() => {\n      var ref;\n      return (ref = this.rootElement) === null || ref === void 0 ? void 0 : ref.addEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n    }, MOUSE_MOVE_TIMEOUT);\n  }\n\n  clearCurrentDragSourceNode() {\n    if (this.currentDragSourceNode) {\n      this.currentDragSourceNode = null;\n\n      if (this.rootElement) {\n        var ref;\n        (ref = this.window) === null || ref === void 0 ? void 0 : ref.clearTimeout(this.mouseMoveTimeoutTimer || undefined);\n        this.rootElement.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n      }\n\n      this.mouseMoveTimeoutTimer = null;\n      return true;\n    }\n\n    return false;\n  }\n\n  handleDragStart(e, sourceId) {\n    if (e.defaultPrevented) {\n      return;\n    }\n\n    if (!this.dragStartSourceIds) {\n      this.dragStartSourceIds = [];\n    }\n\n    this.dragStartSourceIds.unshift(sourceId);\n  }\n\n  handleDragEnter(_e, targetId) {\n    this.dragEnterTargetIds.unshift(targetId);\n  }\n\n  handleDragOver(_e, targetId) {\n    if (this.dragOverTargetIds === null) {\n      this.dragOverTargetIds = [];\n    }\n\n    this.dragOverTargetIds.unshift(targetId);\n  }\n\n  handleDrop(_e, targetId) {\n    this.dropTargetIds.unshift(targetId);\n  }\n\n  constructor(manager, globalContext, options) {\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.sourceNodes = new Map();\n    this.sourceNodeOptions = new Map();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n    this.lastClientOffset = null;\n    this.hoverRafId = null;\n\n    this.getSourceClientOffset = sourceId => {\n      const source = this.sourceNodes.get(sourceId);\n      return source && getNodeClientOffset$1(source) || null;\n    };\n\n    this.endDragNativeItem = () => {\n      if (!this.isDraggingNativeItem()) {\n        return;\n      }\n\n      this.actions.endDrag();\n\n      if (this.currentNativeHandle) {\n        this.registry.removeSource(this.currentNativeHandle);\n      }\n\n      this.currentNativeHandle = null;\n      this.currentNativeSource = null;\n    };\n\n    this.isNodeInDocument = node => {\n      // Check the node either in the main document or in the current context\n      return Boolean(node && this.document && this.document.body && this.document.body.contains(node));\n    };\n\n    this.endDragIfSourceWasRemovedFromDOM = () => {\n      const node = this.currentDragSourceNode;\n\n      if (node == null || this.isNodeInDocument(node)) {\n        return;\n      }\n\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.scheduleHover = dragOverTargetIds => {\n      if (this.hoverRafId === null && typeof requestAnimationFrame !== 'undefined') {\n        this.hoverRafId = requestAnimationFrame(() => {\n          if (this.monitor.isDragging()) {\n            this.actions.hover(dragOverTargetIds || [], {\n              clientOffset: this.lastClientOffset\n            });\n          }\n\n          this.hoverRafId = null;\n        });\n      }\n    };\n\n    this.cancelHover = () => {\n      if (this.hoverRafId !== null && typeof cancelAnimationFrame !== 'undefined') {\n        cancelAnimationFrame(this.hoverRafId);\n        this.hoverRafId = null;\n      }\n    };\n\n    this.handleTopDragStartCapture = () => {\n      this.clearCurrentDragSourceNode();\n      this.dragStartSourceIds = [];\n    };\n\n    this.handleTopDragStart = e => {\n      if (e.defaultPrevented) {\n        return;\n      }\n\n      const {\n        dragStartSourceIds\n      } = this;\n      this.dragStartSourceIds = null;\n      const clientOffset = getEventClientOffset$1(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n      if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n        this.cancelHover();\n      } // Don't publish the source just yet (see why below)\n\n\n      this.actions.beginDrag(dragStartSourceIds || [], {\n        publishSource: false,\n        getSourceClientOffset: this.getSourceClientOffset,\n        clientOffset\n      });\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n\n      if (this.monitor.isDragging()) {\n        if (dataTransfer && typeof dataTransfer.setDragImage === 'function') {\n          // Use custom drag image if user specifies it.\n          // If child drag source refuses drag but parent agrees,\n          // use parent's node as drag image. Neither works in IE though.\n          const sourceId = this.monitor.getSourceId();\n          const sourceNode = this.sourceNodes.get(sourceId);\n          const dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode;\n\n          if (dragPreview) {\n            const {\n              anchorX,\n              anchorY,\n              offsetX,\n              offsetY\n            } = this.getCurrentSourcePreviewNodeOptions();\n            const anchorPoint = {\n              anchorX,\n              anchorY\n            };\n            const offsetPoint = {\n              offsetX,\n              offsetY\n            };\n            const dragPreviewOffset = getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n            dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n          }\n        }\n\n        try {\n          // Firefox won't drag without setting data\n          dataTransfer === null || dataTransfer === void 0 ? void 0 : dataTransfer.setData('application/json', {});\n        } catch (err) {// IE doesn't support MIME types in setData\n        } // Store drag source node so we can check whether\n        // it is removed from DOM and trigger endDrag manually.\n\n\n        this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n        const {\n          captureDraggingState\n        } = this.getCurrentSourcePreviewNodeOptions();\n\n        if (!captureDraggingState) {\n          // Usually we want to publish it in the next tick so that browser\n          // is able to screenshot the current (not yet dragging) state.\n          //\n          // It also neatly avoids a situation where render() returns null\n          // in the same tick for the source element, and browser freaks out.\n          setTimeout(() => this.actions.publishDragSource(), 0);\n        } else {\n          // In some cases the user may want to override this behavior, e.g.\n          // to work around IE not supporting custom drag previews.\n          //\n          // When using a custom drag layer, the only way to prevent\n          // the default drag preview from drawing in IE is to screenshot\n          // the dragging state in which the node itself has zero opacity\n          // and height. In this case, though, returning null from render()\n          // will abruptly end the dragging, which is not obvious.\n          //\n          // This is the reason such behavior is strictly opt-in.\n          this.actions.publishDragSource();\n        }\n      } else if (nativeType) {\n        // A native item (such as URL) dragged from inside the document\n        this.beginDragNativeItem(nativeType);\n      } else if (dataTransfer && !dataTransfer.types && (e.target && !e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n        // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n        // Just let it drag. It's a native type (URL or text) and will be picked up in\n        // dragenter handler.\n        return;\n      } else {\n        // If by this time no drag source reacted, tell browser not to drag.\n        e.preventDefault();\n      }\n    };\n\n    this.handleTopDragEndCapture = () => {\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        // Firefox can dispatch this event in an infinite loop\n        // if dragend handler does something like showing an alert.\n        // Only proceed if we have not handled it already.\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleTopDragEnterCapture = e => {\n      this.dragEnterTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n\n      const isFirstEnter = this.enterLeaveCounter.enter(e.target);\n\n      if (!isFirstEnter || this.monitor.isDragging()) {\n        return;\n      }\n\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n\n      if (nativeType) {\n        // A native item (such as file or URL) dragged from outside the document\n        this.beginDragNativeItem(nativeType, dataTransfer);\n      }\n    };\n\n    this.handleTopDragEnter = e => {\n      const {\n        dragEnterTargetIds\n      } = this;\n      this.dragEnterTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        return;\n      }\n\n      this.altKeyPressed = e.altKey; // If the target changes position as the result of `dragenter`, `dragover` might still\n      // get dispatched despite target being no longer there. The easy solution is to check\n      // whether there actually is a target before firing `hover`.\n\n      if (dragEnterTargetIds.length > 0) {\n        this.actions.hover(dragEnterTargetIds, {\n          clientOffset: getEventClientOffset$1(e)\n        });\n      }\n\n      const canDrop = dragEnterTargetIds.some(targetId => this.monitor.canDropOnTarget(targetId));\n\n      if (canDrop) {\n        // IE requires this to fire dragover events\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      }\n    };\n\n    this.handleTopDragOverCapture = e => {\n      this.dragOverTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n    };\n\n    this.handleTopDragOver = e => {\n      const {\n        dragOverTargetIds\n      } = this;\n      this.dragOverTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        // Prevent default \"drop and blow away the whole document\" action.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n\n        return;\n      }\n\n      this.altKeyPressed = e.altKey;\n      this.lastClientOffset = getEventClientOffset$1(e);\n      this.scheduleHover(dragOverTargetIds);\n      const canDrop = (dragOverTargetIds || []).some(targetId => this.monitor.canDropOnTarget(targetId));\n\n      if (canDrop) {\n        // Show user-specified drop effect.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      } else if (this.isDraggingNativeItem()) {\n        // Don't show a nice cursor but still prevent default\n        // \"drop and blow away the whole document\" action.\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n      }\n    };\n\n    this.handleTopDragLeaveCapture = e => {\n      if (this.isDraggingNativeItem()) {\n        e.preventDefault();\n      }\n\n      const isLastLeave = this.enterLeaveCounter.leave(e.target);\n\n      if (!isLastLeave) {\n        return;\n      }\n\n      if (this.isDraggingNativeItem()) {\n        setTimeout(() => this.endDragNativeItem(), 0);\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleTopDropCapture = e => {\n      this.dropTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        e.preventDefault();\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      } else if (matchNativeItemType(e.dataTransfer)) {\n        // Dragging some elements, like <a> and <img> may still behave like a native drag event,\n        // even if the current drag event matches a user-defined type.\n        // Stop the default behavior when we're not expecting a native item to be dropped.\n        e.preventDefault();\n      }\n\n      this.enterLeaveCounter.reset();\n    };\n\n    this.handleTopDrop = e => {\n      const {\n        dropTargetIds\n      } = this;\n      this.dropTargetIds = [];\n      this.actions.hover(dropTargetIds, {\n        clientOffset: getEventClientOffset$1(e)\n      });\n      this.actions.drop({\n        dropEffect: this.getCurrentDropEffect()\n      });\n\n      if (this.isDraggingNativeItem()) {\n        this.endDragNativeItem();\n      } else if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleSelectStart = e => {\n      const target = e.target; // Only IE requires us to explicitly say\n      // we want drag drop operation to start\n\n      if (typeof target.dragDrop !== 'function') {\n        return;\n      } // Inputs and textareas should be selectable\n\n\n      if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n        return;\n      } // For other targets, ask IE\n      // to enable drag and drop\n\n\n      e.preventDefault();\n      target.dragDrop();\n    };\n\n    this.options = new OptionsReader$1(globalContext, options);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.enterLeaveCounter = new EnterLeaveCounter(this.isNodeInDocument);\n  }\n\n}\n\nlet emptyImage;\n\nfunction getEmptyImage() {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    emptyImage.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  return emptyImage;\n}\n\nconst HTML5Backend = function createBackend(manager, context, options) {\n  return new HTML5BackendImpl(manager, context, options);\n};\n\nvar ListenerType;\n\n(function (ListenerType) {\n  ListenerType[\"mouse\"] = \"mouse\";\n  ListenerType[\"touch\"] = \"touch\";\n  ListenerType[\"keyboard\"] = \"keyboard\";\n})(ListenerType || (ListenerType = {}));\n\nclass OptionsReader {\n  get delay() {\n    var _delay;\n\n    return (_delay = this.args.delay) !== null && _delay !== void 0 ? _delay : 0;\n  }\n\n  get scrollAngleRanges() {\n    return this.args.scrollAngleRanges;\n  }\n\n  get getDropTargetElementsAtPoint() {\n    return this.args.getDropTargetElementsAtPoint;\n  }\n\n  get ignoreContextMenu() {\n    var _ignoreContextMenu;\n\n    return (_ignoreContextMenu = this.args.ignoreContextMenu) !== null && _ignoreContextMenu !== void 0 ? _ignoreContextMenu : false;\n  }\n\n  get enableHoverOutsideTarget() {\n    var _enableHoverOutsideTarget;\n\n    return (_enableHoverOutsideTarget = this.args.enableHoverOutsideTarget) !== null && _enableHoverOutsideTarget !== void 0 ? _enableHoverOutsideTarget : false;\n  }\n\n  get enableKeyboardEvents() {\n    var _enableKeyboardEvents;\n\n    return (_enableKeyboardEvents = this.args.enableKeyboardEvents) !== null && _enableKeyboardEvents !== void 0 ? _enableKeyboardEvents : false;\n  }\n\n  get enableMouseEvents() {\n    var _enableMouseEvents;\n\n    return (_enableMouseEvents = this.args.enableMouseEvents) !== null && _enableMouseEvents !== void 0 ? _enableMouseEvents : false;\n  }\n\n  get enableTouchEvents() {\n    var _enableTouchEvents;\n\n    return (_enableTouchEvents = this.args.enableTouchEvents) !== null && _enableTouchEvents !== void 0 ? _enableTouchEvents : true;\n  }\n\n  get touchSlop() {\n    return this.args.touchSlop || 0;\n  }\n\n  get delayTouchStart() {\n    var ref, ref1;\n    var ref2, ref3;\n    return (ref3 = (ref2 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayTouchStart) !== null && ref2 !== void 0 ? ref2 : (ref1 = this.args) === null || ref1 === void 0 ? void 0 : ref1.delay) !== null && ref3 !== void 0 ? ref3 : 0;\n  }\n\n  get delayMouseStart() {\n    var ref, ref4;\n    var ref5, ref6;\n    return (ref6 = (ref5 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayMouseStart) !== null && ref5 !== void 0 ? ref5 : (ref4 = this.args) === null || ref4 === void 0 ? void 0 : ref4.delay) !== null && ref6 !== void 0 ? ref6 : 0;\n  }\n\n  get window() {\n    if (this.context && this.context.window) {\n      return this.context.window;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n\n    return undefined;\n  }\n\n  get document() {\n    var ref;\n\n    if ((ref = this.context) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.context.document;\n    }\n\n    if (this.window) {\n      return this.window.document;\n    }\n\n    return undefined;\n  }\n\n  get rootElement() {\n    var ref;\n    return ((ref = this.args) === null || ref === void 0 ? void 0 : ref.rootElement) || this.document;\n  }\n\n  constructor(args, context) {\n    this.args = args;\n    this.context = context;\n  }\n\n}\n\nfunction distance(x1, y1, x2, y2) {\n  return Math.sqrt(Math.pow(Math.abs(x2 - x1), 2) + Math.pow(Math.abs(y2 - y1), 2));\n}\n\nfunction inAngleRanges(x1, y1, x2, y2, angleRanges) {\n  if (!angleRanges) {\n    return false;\n  }\n\n  const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI + 180;\n\n  for (let i = 0; i < angleRanges.length; ++i) {\n    const ar = angleRanges[i];\n\n    if (ar && (ar.start == null || angle >= ar.start) && (ar.end == null || angle <= ar.end)) {\n      return true;\n    }\n  }\n\n  return false;\n} // Used for MouseEvent.buttons (note the s on the end).\n\n\nconst MouseButtons = {\n  Left: 1,\n  Right: 2,\n  Center: 4\n}; // Used for e.button (note the lack of an s on the end).\n\nconst MouseButton = {\n  Left: 0,\n  Center: 1,\n  Right: 2\n};\n/**\n * Only touch events and mouse events where the left button is pressed should initiate a drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldStartDrag(e) {\n  // For touch events, button will be undefined. If e.button is defined,\n  // then it should be MouseButton.Left.\n  return e.button === undefined || e.button === MouseButton.Left;\n}\n/**\n * Only touch events and mouse events where the left mouse button is no longer held should end a drag.\n * It's possible the user mouse downs with the left mouse button, then mouse down and ups with the right mouse button.\n * We don't want releasing the right mouse button to end the drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\n\nfunction eventShouldEndDrag(e) {\n  // Touch events will have buttons be undefined, while mouse events will have e.buttons's left button\n  // bit field unset if the left mouse button has been released\n  return e.buttons === undefined || (e.buttons & MouseButtons.Left) === 0;\n}\n\nfunction isTouchEvent(e) {\n  return !!e.targetTouches;\n}\n\nconst ELEMENT_NODE = 1;\n\nfunction getNodeClientOffset(node) {\n  const el = node.nodeType === ELEMENT_NODE ? node : node.parentElement;\n\n  if (!el) {\n    return undefined;\n  }\n\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\n\nfunction getEventClientTouchOffset(e, lastTargetTouchFallback) {\n  if (e.targetTouches.length === 1) {\n    return getEventClientOffset(e.targetTouches[0]);\n  } else if (lastTargetTouchFallback && e.touches.length === 1) {\n    if (e.touches[0].target === lastTargetTouchFallback.target) {\n      return getEventClientOffset(e.touches[0]);\n    }\n  }\n\n  return;\n}\n\nfunction getEventClientOffset(e, lastTargetTouchFallback) {\n  if (isTouchEvent(e)) {\n    return getEventClientTouchOffset(e, lastTargetTouchFallback);\n  } else {\n    return {\n      x: e.clientX,\n      y: e.clientY\n    };\n  }\n}\n\nconst supportsPassive = (() => {\n  // simular to jQuery's test\n  let supported = false;\n\n  try {\n    addEventListener('test', () => {// do nothing\n    }, Object.defineProperty({}, 'passive', {\n      get() {\n        supported = true;\n        return true;\n      }\n\n    }));\n  } catch (e) {// do nothing\n  }\n\n  return supported;\n})();\n\nconst eventNames = {\n  [ListenerType.mouse]: {\n    start: 'mousedown',\n    move: 'mousemove',\n    end: 'mouseup',\n    contextmenu: 'contextmenu'\n  },\n  [ListenerType.touch]: {\n    start: 'touchstart',\n    move: 'touchmove',\n    end: 'touchend'\n  },\n  [ListenerType.keyboard]: {\n    keydown: 'keydown'\n  }\n};\n\nclass TouchBackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref;\n    return {\n      sourceNodes: this.sourceNodes.size,\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      targetNodes: this.targetNodes.size,\n      dragOverTargetIds: ((ref = this.dragOverTargetIds) === null || ref === void 0 ? void 0 : ref.length) || 0\n    };\n  } // public for test\n\n\n  get document() {\n    return this.options.document;\n  }\n\n  setup() {\n    const root = this.options.rootElement;\n\n    if (!root) {\n      return;\n    }\n\n    invariant(!TouchBackendImpl.isSetUp, 'Cannot have two Touch backends at the same time.');\n    TouchBackendImpl.isSetUp = true;\n    this.addEventListener(root, 'start', this.getTopMoveStartHandler());\n    this.addEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.addEventListener(root, 'move', this.handleTopMove);\n    this.addEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.addEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.addEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.addEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n  }\n\n  teardown() {\n    const root = this.options.rootElement;\n\n    if (!root) {\n      return;\n    }\n\n    TouchBackendImpl.isSetUp = false;\n    this._mouseClientOffset = {};\n    this.removeEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.removeEventListener(root, 'start', this.handleTopMoveStart);\n    this.removeEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.removeEventListener(root, 'move', this.handleTopMove);\n    this.removeEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.removeEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.removeEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n\n    this.uninstallSourceNodeRemovalObserver();\n  }\n\n  addEventListener(subject, event, handler) {\n    let capture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n\n      if (evt) {\n        subject.addEventListener(evt, handler, options);\n      }\n    });\n  }\n\n  removeEventListener(subject, event, handler) {\n    let capture = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n\n      if (evt) {\n        subject.removeEventListener(evt, handler, options);\n      }\n    });\n  }\n\n  connectDragSource(sourceId, node) {\n    const handleMoveStart = this.handleMoveStart.bind(this, sourceId);\n    this.sourceNodes.set(sourceId, node);\n    this.addEventListener(node, 'start', handleMoveStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.removeEventListener(node, 'start', handleMoveStart);\n    };\n  }\n\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n\n  connectDropTarget(targetId, node) {\n    const root = this.options.rootElement;\n\n    if (!this.document || !root) {\n      return () => {\n        /* noop */\n      };\n    }\n\n    const handleMove = e => {\n      if (!this.document || !root || !this.monitor.isDragging()) {\n        return;\n      }\n\n      let coords;\n      /**\n      * Grab the coordinates for the current mouse/touch position\n      */\n\n      switch (e.type) {\n        case eventNames.mouse.move:\n          coords = {\n            x: e.clientX,\n            y: e.clientY\n          };\n          break;\n\n        case eventNames.touch.move:\n          var ref, ref1;\n          coords = {\n            x: ((ref = e.touches[0]) === null || ref === void 0 ? void 0 : ref.clientX) || 0,\n            y: ((ref1 = e.touches[0]) === null || ref1 === void 0 ? void 0 : ref1.clientY) || 0\n          };\n          break;\n      }\n      /**\n      * Use the coordinates to grab the element the drag ended on.\n      * If the element is the same as the target node (or any of it's children) then we have hit a drop target and can handle the move.\n      */\n\n\n      const droppedOn = coords != null ? this.document.elementFromPoint(coords.x, coords.y) : undefined;\n      const childMatch = droppedOn && node.contains(droppedOn);\n\n      if (droppedOn === node || childMatch) {\n        return this.handleMove(e, targetId);\n      }\n    };\n    /**\n    * Attaching the event listener to the body so that touchmove will work while dragging over multiple target elements.\n    */\n\n\n    this.addEventListener(this.document.body, 'move', handleMove);\n    this.targetNodes.set(targetId, node);\n    return () => {\n      if (this.document) {\n        this.targetNodes.delete(targetId);\n        this.removeEventListener(this.document.body, 'move', handleMove);\n      }\n    };\n  }\n\n  getTopMoveStartHandler() {\n    if (!this.options.delayTouchStart && !this.options.delayMouseStart) {\n      return this.handleTopMoveStart;\n    }\n\n    return this.handleTopMoveStartDelay;\n  }\n\n  installSourceNodeRemovalObserver(node) {\n    this.uninstallSourceNodeRemovalObserver();\n    this.draggedSourceNode = node;\n    this.draggedSourceNodeRemovalObserver = new MutationObserver(() => {\n      if (node && !node.parentElement) {\n        this.resurrectSourceNode();\n        this.uninstallSourceNodeRemovalObserver();\n      }\n    });\n\n    if (!node || !node.parentElement) {\n      return;\n    }\n\n    this.draggedSourceNodeRemovalObserver.observe(node.parentElement, {\n      childList: true\n    });\n  }\n\n  resurrectSourceNode() {\n    if (this.document && this.draggedSourceNode) {\n      this.draggedSourceNode.style.display = 'none';\n      this.draggedSourceNode.removeAttribute('data-reactid');\n      this.document.body.appendChild(this.draggedSourceNode);\n    }\n  }\n\n  uninstallSourceNodeRemovalObserver() {\n    if (this.draggedSourceNodeRemovalObserver) {\n      this.draggedSourceNodeRemovalObserver.disconnect();\n    }\n\n    this.draggedSourceNodeRemovalObserver = undefined;\n    this.draggedSourceNode = undefined;\n  }\n\n  constructor(manager, context, options) {\n    this.getSourceClientOffset = sourceId => {\n      const element = this.sourceNodes.get(sourceId);\n      return element && getNodeClientOffset(element);\n    };\n\n    this.handleTopMoveStartCapture = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n\n      this.moveStartSourceIds = [];\n    };\n\n    this.handleMoveStart = sourceId => {\n      // Just because we received an event doesn't necessarily mean we need to collect drag sources.\n      // We only collect start collecting drag sources on touch and left mouse events.\n      if (Array.isArray(this.moveStartSourceIds)) {\n        this.moveStartSourceIds.unshift(sourceId);\n      }\n    };\n\n    this.handleTopMoveStart = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      } // Don't prematurely preventDefault() here since it might:\n      // 1. Mess up scrolling\n      // 2. Mess up long tap (which brings up context menu)\n      // 3. If there's an anchor link as a child, tap won't be triggered on link\n\n\n      const clientOffset = getEventClientOffset(e);\n\n      if (clientOffset) {\n        if (isTouchEvent(e)) {\n          this.lastTargetTouchFallback = e.targetTouches[0];\n        }\n\n        this._mouseClientOffset = clientOffset;\n      }\n\n      this.waitingForDelay = false;\n    };\n\n    this.handleTopMoveStartDelay = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n\n      const delay = e.type === eventNames.touch.start ? this.options.delayTouchStart : this.options.delayMouseStart;\n      this.timeout = setTimeout(this.handleTopMoveStart.bind(this, e), delay);\n      this.waitingForDelay = true;\n    };\n\n    this.handleTopMoveCapture = () => {\n      this.dragOverTargetIds = [];\n    };\n\n    this.handleMove = (_evt, targetId) => {\n      if (this.dragOverTargetIds) {\n        this.dragOverTargetIds.unshift(targetId);\n      }\n    };\n\n    this.handleTopMove = e1 => {\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n      }\n\n      if (!this.document || this.waitingForDelay) {\n        return;\n      }\n\n      const {\n        moveStartSourceIds,\n        dragOverTargetIds\n      } = this;\n      const enableHoverOutsideTarget = this.options.enableHoverOutsideTarget;\n      const clientOffset = getEventClientOffset(e1, this.lastTargetTouchFallback);\n\n      if (!clientOffset) {\n        return;\n      } // If the touch move started as a scroll, or is is between the scroll angles\n\n\n      if (this._isScrolling || !this.monitor.isDragging() && inAngleRanges(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y, this.options.scrollAngleRanges)) {\n        this._isScrolling = true;\n        return;\n      } // If we're not dragging and we've moved a little, that counts as a drag start\n\n\n      if (!this.monitor.isDragging() && // eslint-disable-next-line no-prototype-builtins\n      this._mouseClientOffset.hasOwnProperty('x') && moveStartSourceIds && distance(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y) > (this.options.touchSlop ? this.options.touchSlop : 0)) {\n        this.moveStartSourceIds = undefined;\n        this.actions.beginDrag(moveStartSourceIds, {\n          clientOffset: this._mouseClientOffset,\n          getSourceClientOffset: this.getSourceClientOffset,\n          publishSource: false\n        });\n      }\n\n      if (!this.monitor.isDragging()) {\n        return;\n      }\n\n      const sourceNode = this.sourceNodes.get(this.monitor.getSourceId());\n      this.installSourceNodeRemovalObserver(sourceNode);\n      this.actions.publishDragSource();\n      if (e1.cancelable) e1.preventDefault(); // Get the node elements of the hovered DropTargets\n\n      const dragOverTargetNodes = (dragOverTargetIds || []).map(key => this.targetNodes.get(key)).filter(e => !!e); // Get the a ordered list of nodes that are touched by\n\n      const elementsAtPoint = this.options.getDropTargetElementsAtPoint ? this.options.getDropTargetElementsAtPoint(clientOffset.x, clientOffset.y, dragOverTargetNodes) : this.document.elementsFromPoint(clientOffset.x, clientOffset.y); // Extend list with parents that are not receiving elementsFromPoint events (size 0 elements and svg groups)\n\n      const elementsAtPointExtended = [];\n\n      for (const nodeId in elementsAtPoint) {\n        // eslint-disable-next-line no-prototype-builtins\n        if (!elementsAtPoint.hasOwnProperty(nodeId)) {\n          continue;\n        }\n\n        let currentNode = elementsAtPoint[nodeId];\n\n        if (currentNode != null) {\n          elementsAtPointExtended.push(currentNode);\n        }\n\n        while (currentNode) {\n          currentNode = currentNode.parentElement;\n\n          if (currentNode && elementsAtPointExtended.indexOf(currentNode) === -1) {\n            elementsAtPointExtended.push(currentNode);\n          }\n        }\n      }\n\n      const orderedDragOverTargetIds = elementsAtPointExtended // Filter off nodes that arent a hovered DropTargets nodes\n      .filter(node => dragOverTargetNodes.indexOf(node) > -1) // Map back the nodes elements to targetIds\n      .map(node => this._getDropTargetId(node)) // Filter off possible null rows\n      .filter(node => !!node).filter((id, index, ids) => ids.indexOf(id) === index); // Invoke hover for drop targets when source node is still over and pointer is outside\n\n      if (enableHoverOutsideTarget) {\n        for (const targetId in this.targetNodes) {\n          const targetNode = this.targetNodes.get(targetId);\n\n          if (sourceNode && targetNode && targetNode.contains(sourceNode) && orderedDragOverTargetIds.indexOf(targetId) === -1) {\n            orderedDragOverTargetIds.unshift(targetId);\n            break;\n          }\n        }\n      } // Reverse order because dnd-core reverse it before calling the DropTarget drop methods\n\n\n      orderedDragOverTargetIds.reverse();\n      this.actions.hover(orderedDragOverTargetIds, {\n        clientOffset: clientOffset\n      });\n    };\n    /**\n    *\n    * visible for testing\n    */\n\n\n    this._getDropTargetId = node => {\n      const keys = this.targetNodes.keys();\n      let next = keys.next();\n\n      while (next.done === false) {\n        const targetId = next.value;\n\n        if (node === this.targetNodes.get(targetId)) {\n          return targetId;\n        } else {\n          next = keys.next();\n        }\n      }\n\n      return undefined;\n    };\n\n    this.handleTopMoveEndCapture = e => {\n      this._isScrolling = false;\n      this.lastTargetTouchFallback = undefined;\n\n      if (!eventShouldEndDrag(e)) {\n        return;\n      }\n\n      if (!this.monitor.isDragging() || this.monitor.didDrop()) {\n        this.moveStartSourceIds = undefined;\n        return;\n      }\n\n      if (e.cancelable) e.preventDefault();\n      this._mouseClientOffset = {};\n      this.uninstallSourceNodeRemovalObserver();\n      this.actions.drop();\n      this.actions.endDrag();\n    };\n\n    this.handleCancelOnEscape = e => {\n      if (e.key === 'Escape' && this.monitor.isDragging()) {\n        this._mouseClientOffset = {};\n        this.uninstallSourceNodeRemovalObserver();\n        this.actions.endDrag();\n      }\n    };\n\n    this.options = new OptionsReader(options, context);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.sourceNodes = new Map();\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.targetNodes = new Map();\n    this.listenerTypes = [];\n    this._mouseClientOffset = {};\n    this._isScrolling = false;\n\n    if (this.options.enableMouseEvents) {\n      this.listenerTypes.push(ListenerType.mouse);\n    }\n\n    if (this.options.enableTouchEvents) {\n      this.listenerTypes.push(ListenerType.touch);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.listenerTypes.push(ListenerType.keyboard);\n    }\n  }\n\n}\n\nconst TouchBackend = function createBackend(manager) {\n  let context = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return new TouchBackendImpl(manager, context, options);\n};\n\nconst COLUMNS = 'abcdefgh'.split('');\nconst chessboardDefaultProps = {\n  animationDuration: 300,\n  areArrowsAllowed: true,\n  arePiecesDraggable: true,\n  arePremovesAllowed: false,\n  boardOrientation: 'white',\n  boardWidth: 560,\n  clearPremovesOnRightClick: true,\n  customArrows: [],\n  customArrowColor: 'rgb(255,170,0)',\n  customBoardStyle: {},\n  customDarkSquareStyle: {\n    backgroundColor: '#B58863'\n  },\n  customDndBackend: undefined,\n  customDndBackendOptions: undefined,\n  customDropSquareStyle: {\n    boxShadow: 'inset 0 0 1px 6px rgba(255,255,255,0.75)'\n  },\n  customLightSquareStyle: {\n    backgroundColor: '#F0D9B5'\n  },\n  customPieces: {},\n  customPremoveDarkSquareStyle: {\n    backgroundColor: '#A42323'\n  },\n  customPremoveLightSquareStyle: {\n    backgroundColor: '#BD2828'\n  },\n  customSquareStyles: {},\n  dropOffBoardAction: 'snapback',\n  id: 0,\n  isDraggablePiece: () => true,\n  getPositionObject: () => {},\n  onArrowsChange: () => {},\n  onDragOverSquare: () => {},\n  onMouseOutSquare: () => {},\n  onMouseOverSquare: () => {},\n  onPieceClick: () => {},\n  onPieceDragBegin: () => {},\n  onPieceDragEnd: () => {},\n  onPieceDrop: () => true,\n  onSquareClick: () => {},\n  onSquareRightClick: () => {},\n  position: 'start',\n  showBoardNotation: true,\n  // showSparePieces: false,\n  snapToCursor: true\n};\nconst startPositionObject = {\n  a8: 'bR',\n  b8: 'bN',\n  c8: 'bB',\n  d8: 'bQ',\n  e8: 'bK',\n  f8: 'bB',\n  g8: 'bN',\n  h8: 'bR',\n  a7: 'bP',\n  b7: 'bP',\n  c7: 'bP',\n  d7: 'bP',\n  e7: 'bP',\n  f7: 'bP',\n  g7: 'bP',\n  h7: 'bP',\n  a2: 'wP',\n  b2: 'wP',\n  c2: 'wP',\n  d2: 'wP',\n  e2: 'wP',\n  f2: 'wP',\n  g2: 'wP',\n  h2: 'wP',\n  a1: 'wR',\n  b1: 'wN',\n  c1: 'wB',\n  d1: 'wQ',\n  e1: 'wK',\n  f1: 'wB',\n  g1: 'wN',\n  h1: 'wR'\n};\nconst whiteColumnValues = {\n  a: 0,\n  b: 1,\n  c: 2,\n  d: 3,\n  e: 4,\n  f: 5,\n  g: 6,\n  h: 7\n};\nconst blackColumnValues = {\n  a: 7,\n  b: 6,\n  c: 5,\n  d: 4,\n  e: 3,\n  f: 2,\n  g: 1,\n  h: 0\n};\nconst whiteRows = [7, 6, 5, 4, 3, 2, 1, 0];\nconst blackRows = [0, 1, 2, 3, 4, 5, 6, 7];\n\nconst getRelativeCoords = (boardOrientation, boardWidth, square) => {\n  const squareWidth = boardWidth / 8;\n  const columns = boardOrientation === 'white' ? whiteColumnValues : blackColumnValues;\n  const rows = boardOrientation === 'white' ? whiteRows : blackRows;\n  const x = columns[square[0]] * squareWidth + squareWidth / 2;\n  const y = rows[square[1] - 1] * squareWidth + squareWidth / 2;\n  return {\n    x,\n    y\n  };\n};\n\nconst isDifferentFromStart = newPosition => {\n  let isDifferent = false;\n  Object.keys(startPositionObject).forEach(square => {\n    if (newPosition[square] !== startPositionObject[square]) isDifferent = true;\n  });\n  Object.keys(newPosition).forEach(square => {\n    if (startPositionObject[square] !== newPosition[square]) isDifferent = true;\n  });\n  return isDifferent;\n};\n\nconst getPositionDifferences = (currentPosition, newPosition) => {\n  const difference = {\n    removed: {},\n    added: {}\n  }; // removed from current\n\n  Object.keys(currentPosition).forEach(square => {\n    if (newPosition[square] !== currentPosition[square]) difference.removed[square] = currentPosition[square];\n  }); // added from new\n\n  Object.keys(newPosition).forEach(square => {\n    if (currentPosition[square] !== newPosition[square]) difference.added[square] = newPosition[square];\n  });\n  return difference;\n};\n\nfunction isString(s) {\n  return typeof s === 'string';\n}\n\nfunction convertPositionToObject(position) {\n  if (position === 'start') return fenToObj('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR');\n  if (validFen(position)) return fenToObj(position);\n  if (validPositionObject(position)) return position;\n  return {};\n}\n\nfunction fenToObj(fen) {\n  if (!validFen(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, '');\n  const rows = fen.split('/');\n  const position = {};\n  let currentRow = 8;\n\n  for (let i = 0; i < 8; i++) {\n    const row = rows[i].split('');\n    let colIdx = 0; // loop through each character in the FEN section\n\n    for (let j = 0; j < row.length; j++) {\n      // number / empty squares\n      if (row[j].search(/[1-8]/) !== -1) {\n        const numEmptySquares = parseInt(row[j], 10);\n        colIdx = colIdx + numEmptySquares;\n      } else {\n        // piece\n        const square = COLUMNS[colIdx] + currentRow;\n        position[square] = fenToPieceCode(row[j]);\n        colIdx = colIdx + 1;\n      }\n    }\n\n    currentRow = currentRow - 1;\n  }\n\n  return position;\n}\n\nfunction expandFenEmptySquares(fen) {\n  return fen.replace(/8/g, '11111111').replace(/7/g, '1111111').replace(/6/g, '111111').replace(/5/g, '11111').replace(/4/g, '1111').replace(/3/g, '111').replace(/2/g, '11');\n}\n\nfunction validFen(fen) {\n  if (!isString(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, ''); // expand the empty square numbers to just 1s\n\n  fen = expandFenEmptySquares(fen); // FEN should be 8 sections separated by slashes\n\n  const chunks = fen.split('/');\n  if (chunks.length !== 8) return false; // check each section\n\n  for (let i = 0; i < 8; i++) {\n    if (chunks[i].length !== 8 || chunks[i].search(/[^kqrnbpKQRNBP1]/) !== -1) {\n      return false;\n    }\n  }\n\n  return true;\n} // convert FEN piece code to bP, wK, etc\n\n\nfunction fenToPieceCode(piece) {\n  // black piece\n  if (piece.toLowerCase() === piece) {\n    return 'b' + piece.toUpperCase();\n  } // white piece\n\n\n  return 'w' + piece.toUpperCase();\n}\n\nfunction validSquare(square) {\n  return isString(square) && square.search(/^[a-h][1-8]$/) !== -1;\n}\n\nfunction validPieceCode(code) {\n  return isString(code) && code.search(/^[bw][KQRNBP]$/) !== -1;\n}\n\nfunction validPositionObject(pos) {\n  if (pos === null || typeof pos !== 'object') return false;\n\n  for (const i in pos) {\n    if (!pos[i]) continue;\n\n    if (!validSquare(i) || !validPieceCode(pos[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nconst defaultPieces = {\n  wP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  wR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 34,14 L 31,17 L 14,17 L 11,14\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,17 L 31,29.5 L 14,29.5 L 14,17\",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  wB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#ffffff',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,33.5 C 18,32.5 27,32.5 33,33.5\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      })]\n    })\n  }),\n  wK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  bP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  bR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,35.5 L 33,35.5 L 33,35.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 13,31.5 L 32,31.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 31,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 31,16.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \",\n        style: {\n          fill: '#ffffff',\n          stroke: 'none'\n        }\n      })]\n    })\n  }),\n  bB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#000000',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#000000',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\",\n        style: {\n          strokeLinecap: 'butt',\n          fill: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 12,33.5 c 6,-1 15,-1 21,0\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,38.5 A 35,35 1 0 0 34,38.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 11,29 A 35,35 1 0 1 34,29\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 12.5,31.5 L 32.5,31.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"\n        })]\n      })]\n    })\n  }),\n  bK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        },\n        id: \"path6570\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#000000',\n          fillOpacity: '1',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      })]\n    })\n  })\n};\nconst ChessboardContext = /*#__PURE__*/React.createContext();\n\nconst useChessboard = () => useContext(ChessboardContext);\n\nconst ChessboardProvider = /*#__PURE__*/forwardRef((_ref3, ref) => {\n  let {\n    animationDuration,\n    areArrowsAllowed,\n    arePiecesDraggable,\n    arePremovesAllowed,\n    boardOrientation,\n    boardWidth,\n    clearPremovesOnRightClick,\n    customArrows,\n    customArrowColor,\n    customBoardStyle,\n    customDarkSquareStyle,\n    customDropSquareStyle,\n    customLightSquareStyle,\n    customPieces,\n    customPremoveDarkSquareStyle,\n    customPremoveLightSquareStyle,\n    customSquareStyles,\n    dropOffBoardAction,\n    id,\n    isDraggablePiece,\n    getPositionObject,\n    onArrowsChange,\n    onDragOverSquare,\n    onMouseOutSquare,\n    onMouseOverSquare,\n    onPieceClick,\n    onPieceDragBegin,\n    onPieceDragEnd,\n    onPieceDrop,\n    onSquareClick,\n    onSquareRightClick,\n    position,\n    showBoardNotation,\n    showSparePieces,\n    snapToCursor,\n    children\n  } = _ref3;\n  // position stored and displayed on board\n  const [currentPosition, setCurrentPosition] = useState(convertPositionToObject(position)); // calculated differences between current and incoming positions\n\n  const [positionDifferences, setPositionDifferences] = useState({}); // colour of last piece moved to determine if premoving\n\n  const [lastPieceColour, setLastPieceColour] = useState(undefined); // current premoves\n\n  const [premoves, setPremoves] = useState([]); // ref used to access current value during timeouts (closures)\n\n  const premovesRef = useRef(premoves); // current right mouse down square\n\n  const [currentRightClickDown, setCurrentRightClickDown] = useState(); // current arrows\n\n  const [arrows, setArrows] = useState([]); // chess pieces/styling\n\n  const [chessPieces, setChessPieces] = useState({ ...defaultPieces,\n    ...customPieces\n  }); // whether the last move was a manual drop or not\n\n  const [manualDrop, setManualDrop] = useState(false); // the most recent timeout whilst waiting for animation to complete\n\n  const [previousTimeout, setPreviousTimeout] = useState(undefined); // if currently waiting for an animation to finish\n\n  const [waitingForAnimation, setWaitingForAnimation] = useState(false); // open clearPremoves() to allow user to call on undo/reset/whenever\n\n  useImperativeHandle(ref, () => ({\n    clearPremoves() {\n      let clearLastPieceColour = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n      clearPremoves(clearLastPieceColour);\n    }\n\n  })); // handle custom pieces change\n\n  useEffect(() => {\n    setChessPieces({ ...defaultPieces,\n      ...customPieces\n    });\n  }, [customPieces]); // handle external position change\n\n  useEffect(() => {\n    var _Object$keys, _Object$entries, _Object$entries$;\n\n    const newPosition = convertPositionToObject(position);\n    const differences = getPositionDifferences(currentPosition, newPosition);\n    const newPieceColour = ((_Object$keys = Object.keys(differences.added)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.length) <= 2 ? (_Object$entries = Object.entries(differences.added)) === null || _Object$entries === void 0 ? void 0 : (_Object$entries$ = _Object$entries[0]) === null || _Object$entries$ === void 0 ? void 0 : _Object$entries$[1][0] : undefined; // external move has come in before animation is over\n    // cancel animation and immediately update position\n\n    if (waitingForAnimation) {\n      setCurrentPosition(newPosition);\n      setWaitingForAnimation(false);\n      arePremovesAllowed && attemptPremove(newPieceColour);\n\n      if (previousTimeout) {\n        clearTimeout(previousTimeout);\n      }\n    } else {\n      // move was made using drag and drop\n      if (manualDrop) {\n        setCurrentPosition(newPosition);\n        setWaitingForAnimation(false);\n        arePremovesAllowed && attemptPremove(newPieceColour);\n      } else {\n        // move was made by external position change\n        // if position === start then don't override newPieceColour\n        // needs isDifferentFromStart in scenario where premoves have been cleared upon board reset but first move is made by computer, the last move colour would need to be updated\n        if (isDifferentFromStart(newPosition) && lastPieceColour !== undefined) {\n          setLastPieceColour(newPieceColour);\n        } else {\n          // position === start, likely a board reset\n          setLastPieceColour(undefined);\n        }\n\n        setPositionDifferences(differences); // animate external move\n\n        setWaitingForAnimation(true);\n        const newTimeout = setTimeout(() => {\n          setCurrentPosition(newPosition);\n          setWaitingForAnimation(false);\n          arePremovesAllowed && attemptPremove(newPieceColour);\n        }, animationDuration);\n        setPreviousTimeout(newTimeout);\n      }\n    } // reset manual drop, ready for next move to be made by user or external\n\n\n    setManualDrop(false); // inform latest position information\n\n    getPositionObject(newPosition); // clear arrows\n\n    clearArrows(); // clear timeout on unmount\n\n    return () => {\n      clearTimeout(previousTimeout);\n    };\n  }, [position]); // handle external arrows change\n\n  useEffect(() => {\n    setArrows(customArrows);\n  }, [customArrows]); // callback when new arrows are set\n\n  useEffect(() => {\n    onArrowsChange(arrows);\n  }, [arrows]); // handle drop position change\n\n  function handleSetPosition(sourceSq, targetSq, piece) {\n    // if dropped back down, don't do anything\n    if (sourceSq === targetSq) {\n      return;\n    }\n\n    clearArrows(); // if second move is made for same colour, or there are still premoves queued, then this move needs to be added to premove queue instead of played\n    // premoves length check for colour is added in because white could make 3 premoves, and then black responds to the first move (changing the last piece colour) and then white pre-moves again\n\n    if (arePremovesAllowed && waitingForAnimation || arePremovesAllowed && (lastPieceColour === piece[0] || premovesRef.current.filter(p => p.piece[0] === piece[0]).length > 0)) {\n      const oldPremoves = [...premovesRef.current];\n      oldPremoves.push({\n        sourceSq,\n        targetSq,\n        piece\n      });\n      premovesRef.current = oldPremoves;\n      setPremoves([...oldPremoves]);\n      return;\n    } // if transitioning, don't allow new drop\n\n\n    if (!arePremovesAllowed && waitingForAnimation) return;\n    const newOnDropPosition = { ...currentPosition\n    };\n    setManualDrop(true);\n    setLastPieceColour(piece[0]); // if onPieceDrop function provided, execute it, position must be updated externally and captured by useEffect above for this move to show on board\n\n    if (onPieceDrop.length) {\n      const isValidMove = onPieceDrop(sourceSq, targetSq, piece);\n      if (!isValidMove) clearPremoves();\n    } else {\n      // delete if dropping off board\n      if (dropOffBoardAction === 'trash' && !targetSq) {\n        delete newOnDropPosition[sourceSq];\n      } // delete source piece if not dropping from spare piece\n\n\n      if (sourceSq !== 'spare') {\n        delete newOnDropPosition[sourceSq];\n      } // add piece in new position\n\n\n      newOnDropPosition[targetSq] = piece;\n      setCurrentPosition(newOnDropPosition);\n    } // inform latest position information\n\n\n    getPositionObject(newOnDropPosition);\n  }\n\n  function attemptPremove(newPieceColour) {\n    if (premovesRef.current.length === 0) return; // get current value of premove as this is called in a timeout so value may have changed since timeout was set\n\n    const premove = premovesRef.current[0]; // if premove is a differing colour to last move made, then this move can be made\n\n    if (premove.piece[0] !== undefined && premove.piece[0] !== newPieceColour && onPieceDrop.length) {\n      setLastPieceColour(premove.piece[0]);\n      setManualDrop(true); // pre-move doesn't need animation\n\n      const isValidMove = onPieceDrop(premove.sourceSq, premove.targetSq, premove.piece); // premove was successful and can be removed from queue\n\n      if (isValidMove) {\n        const oldPremoves = [...premovesRef.current];\n        oldPremoves.shift();\n        premovesRef.current = oldPremoves;\n        setPremoves([...oldPremoves]);\n      } else {\n        // premove wasn't successful, clear premove queue\n        clearPremoves();\n      }\n    }\n  }\n\n  function clearPremoves() {\n    let clearLastPieceColour = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : true;\n    // don't clear when right clicking to clear, otherwise you won't be able to premove again before next go\n    if (clearLastPieceColour) setLastPieceColour(undefined);\n    premovesRef.current = [];\n    setPremoves([]);\n  }\n\n  function onRightClickDown(square) {\n    setCurrentRightClickDown(square);\n  }\n\n  function onRightClickUp(square) {\n    if (!areArrowsAllowed) return;\n\n    if (currentRightClickDown) {\n      // same square, don't draw an arrow, but do clear premoves and run onSquareRightClick\n      if (currentRightClickDown === square) {\n        setCurrentRightClickDown(null);\n        clearPremovesOnRightClick && clearPremoves(false);\n        onSquareRightClick(square);\n        return;\n      } // if arrow already exists then it needs to be removed\n\n\n      for (const i in arrows) {\n        if (arrows[i][0] === currentRightClickDown && arrows[i][1] === square) {\n          setArrows(oldArrows => {\n            const newArrows = [...oldArrows];\n            newArrows.splice(i, 1);\n            return newArrows;\n          });\n          return;\n        }\n      } // different square, draw an arrow\n\n\n      setArrows(oldArrows => [...oldArrows, [currentRightClickDown, square]]);\n    } else setCurrentRightClickDown(null);\n  }\n\n  function clearCurrentRightClickDown() {\n    setCurrentRightClickDown(null);\n  }\n\n  function clearArrows() {\n    setArrows([]);\n  }\n\n  return /*#__PURE__*/jsx(ChessboardContext.Provider, {\n    value: {\n      animationDuration,\n      arePiecesDraggable,\n      arePremovesAllowed,\n      boardOrientation,\n      boardWidth,\n      customArrowColor,\n      customBoardStyle,\n      customDarkSquareStyle,\n      customDropSquareStyle,\n      customLightSquareStyle,\n      customPremoveDarkSquareStyle,\n      customPremoveLightSquareStyle,\n      customSquareStyles,\n      dropOffBoardAction,\n      id,\n      isDraggablePiece,\n      getPositionObject,\n      onDragOverSquare,\n      onMouseOutSquare,\n      onMouseOverSquare,\n      onPieceClick,\n      onPieceDragBegin,\n      onPieceDragEnd,\n      onPieceDrop,\n      onSquareClick,\n      onSquareRightClick,\n      showBoardNotation,\n      showSparePieces,\n      snapToCursor,\n      arrows,\n      chessPieces,\n      clearArrows,\n      clearCurrentRightClickDown,\n      clearPremoves,\n      currentPosition,\n      handleSetPosition,\n      lastPieceColour,\n      manualDrop,\n      onRightClickDown,\n      onRightClickUp,\n      positionDifferences,\n      premoves,\n      setChessPieces,\n      setCurrentPosition,\n      setManualDrop,\n      waitingForAnimation\n    },\n    children: children\n  });\n});\n\nfunction Notation(_ref4) {\n  let {\n    row,\n    col\n  } = _ref4;\n  const {\n    boardOrientation,\n    boardWidth,\n    customDarkSquareStyle,\n    customLightSquareStyle\n  } = useChessboard();\n  const whiteColor = customLightSquareStyle.backgroundColor;\n  const blackColor = customDarkSquareStyle.backgroundColor;\n  const isRow = col === 0;\n  const isColumn = row === 7;\n  const isBottomLeftSquare = isRow && isColumn;\n\n  function getRow() {\n    return boardOrientation === 'white' ? 8 - row : row + 1;\n  }\n\n  function getColumn() {\n    return boardOrientation === 'black' ? COLUMNS[7 - col] : COLUMNS[col];\n  }\n\n  function renderBottomLeft() {\n    return /*#__PURE__*/jsxs(Fragment, {\n      children: [/*#__PURE__*/jsx(\"div\", {\n        style: { ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...numericStyle(boardWidth)\n        },\n        children: getRow()\n      }), /*#__PURE__*/jsx(\"div\", {\n        style: { ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...alphaStyle(boardWidth)\n        },\n        children: getColumn()\n      })]\n    });\n  }\n\n  function renderLetters() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: { ...notationStyle,\n        ...{\n          color: col % 2 !== 0 ? blackColor : whiteColor\n        },\n        ...alphaStyle(boardWidth)\n      },\n      children: getColumn()\n    });\n  }\n\n  function renderNumbers() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: { ...notationStyle,\n        ...(boardOrientation === 'black' ? {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        } : {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        }),\n        ...numericStyle(boardWidth)\n      },\n      children: getRow()\n    });\n  }\n\n  if (isBottomLeftSquare) {\n    return renderBottomLeft();\n  }\n\n  if (isColumn) {\n    return renderLetters();\n  }\n\n  if (isRow) {\n    return renderNumbers();\n  }\n\n  return null;\n}\n\nconst alphaStyle = width => ({\n  alignSelf: 'flex-end',\n  paddingLeft: width / 8 - width / 48,\n  fontSize: width / 48\n});\n\nconst numericStyle = width => ({\n  alignSelf: 'flex-start',\n  paddingRight: width / 8 - width / 48,\n  fontSize: width / 48\n});\n\nconst notationStyle = {\n  zIndex: 3,\n  position: 'absolute'\n};\n\nfunction Piece(_ref5) {\n  let {\n    piece,\n    square,\n    squares,\n    isPremovedPiece = false\n  } = _ref5;\n  const {\n    animationDuration,\n    arePiecesDraggable,\n    arePremovesAllowed,\n    boardWidth,\n    id,\n    isDraggablePiece,\n    onPieceClick,\n    onPieceDragBegin,\n    onPieceDragEnd,\n    premoves,\n    chessPieces,\n    dropTarget,\n    positionDifferences,\n    waitingForAnimation,\n    currentPosition\n  } = useChessboard();\n  const [pieceStyle, setPieceStyle] = useState({\n    opacity: 1,\n    zIndex: 5,\n    touchAction: 'none',\n    cursor: arePiecesDraggable && isDraggablePiece({\n      piece,\n      sourceSquare: square\n    }) ? '-webkit-grab' : 'default'\n  });\n  const [{\n    canDrag,\n    isDragging\n  }, drag, dragPreview] = useDrag(() => ({\n    type: 'piece',\n    item: () => {\n      onPieceDragBegin(piece, square);\n      return {\n        piece,\n        square,\n        id\n      };\n    },\n    end: () => onPieceDragEnd(piece, square),\n    collect: monitor => ({\n      canDrag: isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }),\n      isDragging: !!monitor.isDragging()\n    })\n  }), [piece, square, currentPosition, id]); // hide the default preview\n\n  dragPreview(getEmptyImage(), {\n    captureDraggingState: true\n  }); // hide piece on drag\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      opacity: isDragging ? 0 : 1\n    }));\n  }, [isDragging]); // hide piece on matching premoves\n\n  useEffect(() => {\n    // if premoves aren't allowed, don't waste time on calculations\n    if (!arePremovesAllowed) return;\n    let hidePiece = false; // side effect: if piece moves into pre-moved square, its hidden\n    // if there are any premove targets on this square, hide the piece underneath\n\n    if (!isPremovedPiece && premoves.find(p => p.targetSq === square)) hidePiece = true; // if sourceSq === sq and piece matches then this piece has been pre-moved elsewhere?\n\n    if (premoves.find(p => p.sourceSq === square && p.piece === piece)) hidePiece = true; // TODO: If a premoved piece returns to a premoved square, it will hide (e1, e2, e1)\n\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      display: hidePiece ? 'none' : 'unset'\n    }));\n  }, [currentPosition, premoves]); // new move has come in\n  // if waiting for animation, then animation has started and we can perform animation\n  // we need to head towards where we need to go, we are the source, we are heading towards the target\n\n  useEffect(() => {\n    var _positionDifferences$;\n\n    const removedPiece = (_positionDifferences$ = positionDifferences.removed) === null || _positionDifferences$ === void 0 ? void 0 : _positionDifferences$[square]; // return as null and not loaded yet\n\n    if (!positionDifferences.added) return; // check if piece matches or if removed piece was a pawn and new square is on 1st or 8th rank (promotion)\n\n    const newSquare = Object.entries(positionDifferences.added).find(_ref6 => {\n      let [s, p] = _ref6;\n      return p === removedPiece || (removedPiece === null || removedPiece === void 0 ? void 0 : removedPiece[1]) === 'P' && (s[1] === '1' || s[1] === '8');\n    }); // we can perform animation if our square was in removed, AND the matching piece is in added AND this isn't a premoved piece\n\n    if (waitingForAnimation && removedPiece && newSquare && !isPremovedPiece) {\n      const {\n        sourceSq,\n        targetSq\n      } = getSquareCoordinates(square, newSquare[0]);\n\n      if (sourceSq && targetSq) {\n        setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n          transform: `translate(${targetSq.x - sourceSq.x}px, ${targetSq.y - sourceSq.y}px)`,\n          transition: `transform ${animationDuration}ms`,\n          zIndex: 6\n        }));\n      }\n    }\n  }, [positionDifferences]); // translate to their own positions (repaint on undo)\n\n  useEffect(() => {\n    const {\n      sourceSq\n    } = getSingleSquareCoordinates(square);\n\n    if (sourceSq) {\n      setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n        transform: `translate(${0}px, ${0}px)`,\n        transition: `transform ${0}ms`\n      }));\n    }\n  }, [currentPosition]); // update is piece draggable\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      cursor: arePiecesDraggable && isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }) ? '-webkit-grab' : 'default'\n    }));\n  }, [square, currentPosition, arePiecesDraggable]);\n\n  function getSingleSquareCoordinates(square) {\n    return {\n      sourceSq: squares[square]\n    };\n  }\n\n  function getSquareCoordinates(sourceSquare, targetSquare) {\n    return {\n      sourceSq: squares[sourceSquare],\n      targetSq: squares[targetSquare]\n    };\n  }\n\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: arePiecesDraggable ? canDrag ? drag : null : null,\n    onClick: () => onPieceClick(piece),\n    style: pieceStyle,\n    children: typeof chessPieces[piece] === 'function' ? chessPieces[piece]({\n      squareWidth: boardWidth / 8,\n      isDragging,\n      droppedPiece: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.piece,\n      targetSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.target,\n      sourceSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.source\n    }) : /*#__PURE__*/jsx(\"svg\", {\n      viewBox: '1 1 43 43',\n      width: boardWidth / 8,\n      height: boardWidth / 8,\n      children: /*#__PURE__*/jsx(\"g\", {\n        children: chessPieces[piece]\n      })\n    })\n  });\n}\n\nfunction Square(_ref7) {\n  let {\n    square,\n    squareColor,\n    setSquares,\n    squareHasPremove,\n    children\n  } = _ref7;\n  const squareRef = useRef();\n  const {\n    boardWidth,\n    boardOrientation,\n    clearArrows,\n    currentPosition,\n    customBoardStyle,\n    customDarkSquareStyle,\n    customDropSquareStyle,\n    customLightSquareStyle,\n    customPremoveDarkSquareStyle,\n    customPremoveLightSquareStyle,\n    customSquareStyles,\n    handleSetPosition,\n    lastPieceColour,\n    onDragOverSquare,\n    onMouseOutSquare,\n    onMouseOverSquare,\n    onPieceDrop,\n    onRightClickDown,\n    onRightClickUp,\n    onSquareClick,\n    waitingForAnimation\n  } = useChessboard();\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: 'piece',\n    drop: item => handleSetPosition(item.square, square, item.piece),\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }), [square, currentPosition, onPieceDrop, waitingForAnimation, lastPieceColour]);\n  useEffect(() => {\n    const {\n      x,\n      y\n    } = squareRef.current.getBoundingClientRect();\n    setSquares(oldSquares => ({ ...oldSquares,\n      [square]: {\n        x,\n        y\n      }\n    }));\n  }, [boardWidth, boardOrientation]);\n  const defaultSquareStyle = { ...borderRadius(customBoardStyle, square, boardOrientation),\n    ...(squareColor === 'black' ? customDarkSquareStyle : customLightSquareStyle),\n    ...(squareHasPremove && (squareColor === 'black' ? customPremoveDarkSquareStyle : customPremoveLightSquareStyle)),\n    ...(isOver && customDropSquareStyle)\n  };\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: drop,\n    style: defaultSquareStyle,\n    \"data-square-color\": squareColor,\n    \"data-square\": square,\n    onMouseOver: e => {\n      // noop if moving from child of square into square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOverSquare(square);\n    },\n    onMouseOut: e => {\n      // noop if moving from square into a child of square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOutSquare(square);\n    },\n    onMouseDown: e => {\n      if (e.button === 2) onRightClickDown(square);\n    },\n    onMouseUp: e => {\n      if (e.button === 2) onRightClickUp(square);\n    },\n    onDragEnter: () => onDragOverSquare(square),\n    onClick: () => {\n      onSquareClick(square);\n      clearArrows();\n    },\n    onContextMenu: e => {\n      e.preventDefault();\n    },\n    children: /*#__PURE__*/jsx(\"div\", {\n      ref: squareRef,\n      style: { ...size(boardWidth),\n        ...center,\n        ...(!squareHasPremove && (customSquareStyles === null || customSquareStyles === void 0 ? void 0 : customSquareStyles[square]))\n      },\n      children: children\n    })\n  });\n}\n\nconst center = {\n  display: 'flex',\n  justifyContent: 'center'\n};\n\nconst size = width => ({\n  width: width / 8,\n  height: width / 8\n});\n\nconst borderRadius = (customBoardStyle, square, boardOrientation) => {\n  if (!customBoardStyle.borderRadius) return {};\n\n  if (square === 'a1') {\n    return boardOrientation === 'white' ? {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'a8') {\n    return boardOrientation === 'white' ? {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'h1') {\n    return boardOrientation === 'white' ? {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'h8') {\n    return boardOrientation === 'white' ? {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  return {};\n};\n\nfunction Squares(_ref8) {\n  let {\n    children\n  } = _ref8;\n  const {\n    boardOrientation,\n    boardWidth,\n    customBoardStyle,\n    id\n  } = useChessboard();\n  return /*#__PURE__*/jsx(\"div\", {\n    \"data-boardid\": id,\n    style: { ...boardStyles(boardWidth),\n      ...customBoardStyle\n    },\n    children: [...Array(8)].map((_, r) => {\n      return /*#__PURE__*/jsx(\"div\", {\n        style: rowStyles(boardWidth),\n        children: [...Array(8)].map((_, c) => {\n          // a1, a2 ...\n          const square = boardOrientation === 'black' ? COLUMNS[7 - c] + (r + 1) : COLUMNS[c] + (8 - r);\n          const squareColor = c % 2 === r % 2 ? 'white' : 'black';\n          return children({\n            square,\n            squareColor,\n            col: c,\n            row: r\n          });\n        })\n      }, r.toString());\n    })\n  });\n}\n\nconst boardStyles = width => ({\n  cursor: 'default',\n  height: width,\n  width\n});\n\nconst rowStyles = width => ({\n  display: 'flex',\n  flexWrap: 'nowrap',\n  width\n});\n\nconst errorImage = {\n  whiteKing: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    style: {\n      shapeRendering: 'geometricPrecision',\n      textRendering: 'geometricPrecision',\n      imageRendering: 'optimizeQuality'\n    },\n    viewBox: \"0 0 4210 12970\",\n    x: \"0px\",\n    y: \"0px\",\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    width: \"250\",\n    height: \"250\",\n    children: /*#__PURE__*/jsx(\"g\", {\n      children: /*#__PURE__*/jsx(\"path\", {\n        style: {\n          fill: 'black',\n          fillRule: 'nonzero'\n        },\n        d: \"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z\"\n      })\n    })\n  })\n};\n\nfunction ErrorBoundary(_ref9) {\n  let {\n    children\n  } = _ref9;\n\n  try {\n    return children;\n  } catch (error) {\n    return /*#__PURE__*/jsx(WhiteKing, {\n      showError: true\n    });\n  }\n}\n\nfunction WhiteKing(_ref10) {\n  let {\n    showError = false\n  } = _ref10;\n  return /*#__PURE__*/jsxs(\"div\", {\n    style: container,\n    children: [/*#__PURE__*/jsx(\"div\", {\n      style: whiteKingStyle,\n      children: errorImage.whiteKing\n    }), showError && /*#__PURE__*/jsx(\"h1\", {\n      children: \"Something went wrong\"\n    })]\n  });\n}\n\nconst container = {\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  flexDirection: 'column'\n};\nconst whiteKingStyle = {\n  width: 250,\n  height: 250,\n  transform: 'rotate(90deg)'\n};\n\nfunction Board() {\n  const boardRef = useRef();\n  const [squares, setSquares] = useState({});\n  const {\n    arrows,\n    boardOrientation,\n    boardWidth,\n    clearCurrentRightClickDown,\n    customArrowColor,\n    showBoardNotation,\n    currentPosition,\n    premoves\n  } = useChessboard();\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (boardRef.current && !boardRef.current.contains(event.target)) {\n        clearCurrentRightClickDown();\n      }\n    }\n\n    document.addEventListener('mouseup', handleClickOutside);\n    return () => {\n      document.removeEventListener('mouseup', handleClickOutside);\n    };\n  }, []);\n  return boardWidth ? /*#__PURE__*/jsxs(\"div\", {\n    ref: boardRef,\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/jsx(Squares, {\n      children: _ref11 => {\n        let {\n          square,\n          squareColor,\n          col,\n          row\n        } = _ref11;\n        const squareHasPremove = premoves.find(p => p.sourceSq === square || p.targetSq === square);\n        const squareHasPremoveTarget = premoves.find(p => p.targetSq === square);\n        return /*#__PURE__*/jsxs(Square, {\n          square: square,\n          squareColor: squareColor,\n          setSquares: setSquares,\n          squareHasPremove: squareHasPremove,\n          children: [currentPosition[square] && /*#__PURE__*/jsx(Piece, {\n            piece: currentPosition[square],\n            square: square,\n            squares: squares\n          }), squareHasPremoveTarget && /*#__PURE__*/jsx(Piece, {\n            isPremovedPiece: true,\n            piece: squareHasPremoveTarget.piece,\n            square: square,\n            squares: squares\n          }), showBoardNotation && /*#__PURE__*/jsx(Notation, {\n            row: row,\n            col: col\n          })]\n        }, `${col}${row}`);\n      }\n    }), /*#__PURE__*/jsx(\"svg\", {\n      width: boardWidth,\n      height: boardWidth,\n      style: {\n        position: 'absolute',\n        top: '0',\n        left: '0',\n        pointerEvents: 'none',\n        zIndex: '10'\n      },\n      children: arrows.map(arrow => {\n        const from = getRelativeCoords(boardOrientation, boardWidth, arrow[0]);\n        const to = getRelativeCoords(boardOrientation, boardWidth, arrow[1]);\n        return /*#__PURE__*/jsxs(Fragment$1, {\n          children: [/*#__PURE__*/jsx(\"defs\", {\n            children: /*#__PURE__*/jsx(\"marker\", {\n              id: \"arrowhead\",\n              markerWidth: \"2\",\n              markerHeight: \"2.5\",\n              refX: \"1.25\",\n              refY: \"1.25\",\n              orient: \"auto\",\n              children: /*#__PURE__*/jsx(\"polygon\", {\n                points: \"0 0, 2 1.25, 0 2.5\",\n                style: {\n                  fill: customArrowColor\n                }\n              })\n            })\n          }), /*#__PURE__*/jsx(\"line\", {\n            x1: from.x,\n            y1: from.y,\n            x2: to.x,\n            y2: to.y,\n            style: {\n              stroke: customArrowColor,\n              strokeWidth: boardWidth / 36\n            },\n            markerEnd: \"url(#arrowhead)\"\n          })]\n        }, `${arrow[0]}-${arrow[1]}`);\n      })\n    })]\n  }) : /*#__PURE__*/jsx(WhiteKing, {});\n}\n\nfunction CustomDragLayer() {\n  const {\n    boardWidth,\n    chessPieces,\n    id,\n    snapToCursor\n  } = useChessboard();\n  const collectedProps = useDragLayer(monitor => ({\n    item: monitor.getItem(),\n    clientOffset: monitor.getClientOffset(),\n    sourceClientOffset: monitor.getSourceClientOffset(),\n    isDragging: monitor.isDragging()\n  }));\n  const {\n    isDragging,\n    item,\n    clientOffset,\n    sourceClientOffset\n  } = collectedProps;\n  const layerStyles = {\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: 10,\n    left: 0,\n    top: 0\n  };\n  const getItemStyle = useCallback((clientOffset, sourceClientOffset) => {\n    if (!clientOffset || !sourceClientOffset) return {\n      display: 'none'\n    };\n    let {\n      x,\n      y\n    } = snapToCursor ? clientOffset : sourceClientOffset;\n\n    if (snapToCursor) {\n      const halfSquareWidth = boardWidth / 8 / 2;\n      x -= halfSquareWidth;\n      y -= halfSquareWidth;\n    }\n\n    const transform = `translate(${x}px, ${y}px)`;\n    return {\n      transform,\n      WebkitTransform: transform,\n      touchAction: 'none'\n    };\n  }, [boardWidth, snapToCursor]);\n  return isDragging && item.id === id ? /*#__PURE__*/jsx(\"div\", {\n    style: layerStyles,\n    children: /*#__PURE__*/jsx(\"div\", {\n      style: getItemStyle(clientOffset, sourceClientOffset),\n      children: typeof chessPieces[item.piece] === 'function' ? chessPieces[item.piece]({\n        squareWidth: boardWidth / 8,\n        isDragging: true\n      }) : /*#__PURE__*/jsx(\"svg\", {\n        viewBox: '1 1 43 43',\n        width: boardWidth / 8,\n        height: boardWidth / 8,\n        children: /*#__PURE__*/jsx(\"g\", {\n          children: chessPieces[item.piece]\n        })\n      })\n    })\n  }) : null;\n}\n\nconst Chessboard = /*#__PURE__*/forwardRef((props, ref) => {\n  const [backendSet, setBackendSet] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const {\n    customDndBackend,\n    customDndBackendOptions,\n    ...otherProps\n  } = props;\n  useEffect(() => {\n    setIsMobile('ontouchstart' in window);\n    setBackendSet(true);\n  }, []);\n  const backend = customDndBackend || (isMobile ? TouchBackend : HTML5Backend);\n  return backendSet && /*#__PURE__*/jsx(ErrorBoundary, {\n    children: /*#__PURE__*/jsx(DndProvider, {\n      backend: backend,\n      children: /*#__PURE__*/jsxs(ChessboardProvider, {\n        ref: ref,\n        ...otherProps,\n        children: [/*#__PURE__*/jsx(CustomDragLayer, {}), /*#__PURE__*/jsx(Board, {})]\n      })\n    })\n  });\n});\nChessboard.defaultProps = chessboardDefaultProps;\nexport { Chessboard };","map":{"version":3,"names":["React","createContext","memo","useEffect","useLayoutEffect","useState","useCallback","useMemo","isValidElement","cloneElement","useContext","forwardRef","useRef","useImperativeHandle","Fragment","Fragment$1","jsx","jsxs","DndContext","dragDropManager","undefined","formatProdErrorMessage","code","$$observable","Symbol","observable","randomString","Math","random","toString","substring","split","join","ActionTypes","INIT","REPLACE","PROBE_UNKNOWN_ACTION","isPlainObject","obj","proto","Object","getPrototypeOf","miniKindOf","val","type","Array","isArray","isDate","isError","constructorName","ctorName","slice","toLowerCase","replace","constructor","name","Error","message","stackTraceLimit","Date","toDateString","getDate","setDate","kindOf","typeOfVal","process","env","NODE_ENV","createStore","reducer","preloadedState","enhancer","_ref2","arguments","currentReducer","currentState","currentListeners","nextListeners","isDispatching","ensureCanMutateNextListeners","getState","subscribe","listener","isSubscribed","push","unsubscribe","index","indexOf","splice","dispatch","action","listeners","i","length","replaceReducer","nextReducer","_ref","outerSubscribe","observer","observeState","next","warning","console","error","e","isCrushed","invariant","condition","format","args","isProduction","argIndex","framesToPop","get","path","defaultValue","reduce","a","c","without$1","items","item","filter","isObject","input","xor","itemsA","itemsB","map","Map","insertItem","set","has","forEach","result","count","key","intersection","t","INIT_COORDS","BEGIN_DRAG","PUBLISH_DRAG_SOURCE","HOVER","DROP","END_DRAG","setClientOffset","clientOffset","sourceClientOffset","payload","ResetCoordinatesAction","createBeginDrag","manager","beginDrag","sourceIds","options","publishSource","getSourceClientOffset","monitor","getMonitor","registry","getRegistry","verifyInvariants$1","sourceId","getDraggableSource","verifyGetSourceClientOffsetIsFunction","source","getSource","verifyItemIsObject","pinSource","itemType","getSourceType","isSourcePublic","isDragging","canDragSource","_defineProperty$4","value","defineProperty","enumerable","configurable","writable","_objectSpread$4","target","ownKeys","keys","getOwnPropertySymbols","concat","sym","getOwnPropertyDescriptor","createDrop","drop","verifyInvariants","targetIds","getDroppableTargets","targetId","dropResult","determineDropResult","didDrop","getTarget","verifyDropResultType","getDropResult","getTargetIds","canDropOnTarget","reverse","createEndDrag","endDrag","verifyIsDragging","getSourceId","unpinSource","matchesType","targetType","draggedItemType","some","createHover","hover","targetIdsArg","verifyTargetIdsIsArray","getItemType","removeNonMatchingTargetIds","checkInvariants","hoverAllTargets","lastIndexOf","getTargetType","createPublishDragSource","publishDragSource","createDragDropActions","DragDropManagerImpl","receiveBackend","backend","getBackend","getActions","store","bindActionCreator","actionCreator","apply","actions","boundActions","isSetUp","handleRefCountChange","shouldSetUp","refCount","setup","teardown","add","b","x","y","subtract","state","initialClientOffset","initialSourceClientOffset","getDifferenceFromInitialOffset","NONE","ALL","__IS_NONE__","__IS_ALL__","areDirty","dirtyIds","handlerIds","commonIds","DragDropMonitorImpl","subscribeToStateChange","prevStateId","stateId","handleChange","currentStateId","canSkipListener","dirtyHandlerIds","subscribeToOffsetChange","previousState","dragOffset","nextState","canDrag","canDrop","Boolean","isDraggingSource","sourceType","isOverTarget","shallow","dragOperation","getItem","getInitialClientOffset","getInitialSourceClientOffset","getClientOffset","scope","global","self","BrowserMutationObserver","MutationObserver","WebKitMutationObserver","makeRequestCallFromTimer","callback","requestCall","timeoutHandle","setTimeout","handleTimer","intervalHandle","setInterval","clearTimeout","clearInterval","makeRequestCallFromMutationObserver","toggle","node","document","createTextNode","observe","characterData","data","makeRequestCall","AsapQueue","enqueueTask","task","queue","q","requestFlush","flushing","pendingErrors","capacity","flush","currentIndex","call","scan","newLength","registerPendingError","err","requestErrorThrow","shift","RawTask","onError","release","TaskFactory","create","tasks","freeTasks","t1","pop","asapQueue","taskFactory","asap","ADD_SOURCE","ADD_TARGET","REMOVE_SOURCE","REMOVE_TARGET","addSource","addTarget","removeSource","removeTarget","validateSourceContract","validateTargetContract","validateType","allowArray","HandlerRole","nextUniqueId","getNextUniqueId","getNextHandlerId","role","id","SOURCE","TARGET","parseRoleFromHandlerId","handlerId","mapContainsValue","searchValue","entries","isDone","done","HandlerRegistryImpl","addHandler","containsHandler","handler","dragSources","dropTargets","includePinned","isSourceId","isPinned","pinnedSourceId","pinnedSource","isTargetId","types","delete","strictEquality","areCoordsEqual","offsetA","offsetB","areArraysEqual","isEqual","reduce$5","_state","prevTargetIds","didChange","prevInnermostTargetId","innermostTargetId","_defineProperty$3","_objectSpread$3","initialState$1","reduce$4","_defineProperty$2","_objectSpread$2","initialState","reduce$3","reduce$2","reduce$1","_defineProperty$1","_objectSpread$1","createDragDropManager","backendFactory","globalContext","backendOptions","debugMode","makeStoreInstance","reduxDevTools","window","__REDUX_DEVTOOLS_EXTENSION__","instanceId","_objectWithoutProperties","excluded","_objectWithoutPropertiesLoose","sourceSymbolKeys","prototype","propertyIsEnumerable","sourceKeys","INSTANCE_SYM","for","DndProvider","_param","children","props","isGlobalInstance","getDndContextValue","context","getGlobalContext","Provider","createSingletonDndContext","ctx","fastDeepEqual","equal","RegExp","flags","valueOf","hasOwnProperty","useIsomorphicLayoutEffect","useCollector","collect","onUpdate","collected","setCollected","updateCollected","nextValue","useMonitorOutput","onCollect","subscribeToMonitorStateChange","getHandlerId","useCollectedProps","collector","connector","reconnect","useOptionalFactory","arg","deps","memoDeps","useConnectDragSource","hooks","dragSource","useConnectDragPreview","dragPreview","isCallingCanDrag","isCallingIsDragging","DragSourceMonitorImpl","receiveHandlerId","internalMonitor","isCallingCanDrop","DropTargetMonitorImpl","isOver","registerTarget","registerSource","shallowEqual","objA","objB","compare","compareContext","compareResult","keysA","keysB","bHasOwnProperty","bind","idx","valueA","valueB","isRef","throwIfCompositeComponentElement","element","displayName","wrapHookToRecognizeElement","hook","elementOrNode","ref","cloneWithRef","wrapConnectorHooks","wrappedHooks","endsWith","wrappedHook","setRef","current","newRef","previousRef","SourceConnector","newHandlerId","connectTarget","dragSourceOptions","dragSourceOptionsInternal","dragPreviewOptions","dragPreviewOptionsInternal","reconnectDragSource","reconnectDragPreview","didHandlerIdChange","didConnectedDragSourceChange","didDragSourceOptionsChange","disconnectDragSource","lastConnectedDragSource","lastConnectedHandlerId","lastConnectedDragSourceOptions","dragSourceUnsubscribe","connectDragSource","forceDidChange","didConnectedDragPreviewChange","didDragPreviewOptionsChange","disconnectDragPreview","lastConnectedDragPreview","lastConnectedDragPreviewOptions","dragPreviewUnsubscribe","connectDragPreview","dragPreviewNode","dragPreviewRef","dragSourceNode","dragSourceRef","clearDragSource","clearDragPreview","TargetConnector","dropTarget","didDropTargetChange","didOptionsChange","disconnectDropTarget","lastConnectedDropTarget","lastConnectedDropTargetOptions","dropTargetOptions","unsubscribeDropTarget","connectDropTarget","dropTargetOptionsInternal","dropTargetNode","dropTargetRef","clearDropTarget","useDragDropManager","useDragSourceConnector","useDragSourceMonitor","DragSourceImpl","spec","globalMonitor","end","useDragSource","useDragType","useRegisteredDragSource","registerDragSource","unregister","useDrag","specArg","begin","previewOptions","useDragLayer","useConnectDropTarget","useDropTargetConnector","useDropTargetMonitor","useAccept","accept","DropTargetImpl","useDropTarget","useRegisteredDropTarget","registerDropTarget","useDrop","memoize","fn","memoized","without","union","Set","EnterLeaveCounter","enter","enteringNode","previousLength","entered","isNodeEntered","isNodeInDocument","contains","leave","leavingNode","reset","NativeDragSource","initializeExposedProperties","config","exposeProperties","property","warn","loadDataTransfer","dataTransfer","newProperties","propertyFn","matchesTypes","defineProperties","handle","FILE","URL","TEXT","HTML","NativeTypes","freeze","__proto__","getDataFromDataTransfer","typesToTry","resultSoFar","typeToTry","getData","nativeTypesConfig","files","html","urls","text","createNativeDragSource","matchNativeItemType","dataTransferTypes","nativeItemType","typeConfig","isFirefox","test","navigator","userAgent","isSafari","safari","MonotonicInterpolant","interpolate","xs","ys","c1s","c2s","c3s","low","high","mid","floor","xHere","max","diff","diffSq","indexes","sort","dxs","ms","dx","dy","i1","i2","m2","mNext","dxNext","common","m","i3","c1","invDx","ELEMENT_NODE$1","getNodeClientOffset$1","el","nodeType","parentElement","top","left","getBoundingClientRect","getEventClientOffset$1","clientX","clientY","isImageNode","nodeName","documentElement","getDragPreviewSize","isImage","sourceWidth","sourceHeight","dragPreviewWidth","width","dragPreviewHeight","height","devicePixelRatio","getDragPreviewOffset","sourceNode","anchorPoint","offsetPoint","dragPreviewNodeOffsetFromClient","offsetFromDragPreview","offsetWidth","offsetHeight","anchorX","anchorY","calculateYOffset","interpolantY","calculateXOffset","interpolantX","offsetX","offsetY","isManualOffsetX","isManualOffsetY","OptionsReader$1","rootElement","optionsArgs","ownerDocument","_defineProperty","_objectSpread","HTML5BackendImpl","profile","ref1","sourcePreviewNodes","size","sourcePreviewNodeOptions","sourceNodeOptions","sourceNodes","dragStartSourceIds","dropTargetIds","dragEnterTargetIds","dragOverTargetIds","root","__isReactDndBackendSetUp","addEventListeners","removeEventListeners","clearCurrentDragSourceNode","asyncEndDragFrameId","cancelAnimationFrame","handleDragStart","handleSelectStart","setAttribute","addEventListener","removeEventListener","handleDragEnter","handleDragOver","handleDrop","handleTopDragStart","handleTopDragStartCapture","handleTopDragEndCapture","handleTopDragEnter","handleTopDragEnterCapture","handleTopDragLeaveCapture","handleTopDragOver","handleTopDragOverCapture","handleTopDrop","handleTopDropCapture","getCurrentSourceNodeOptions","dropEffect","altKeyPressed","getCurrentDropEffect","isDraggingNativeItem","getCurrentSourcePreviewNodeOptions","captureDraggingState","beginDragNativeItem","currentNativeSource","currentNativeHandle","setCurrentDragSourceNode","currentDragSourceNode","MOUSE_MOVE_TIMEOUT","mouseMoveTimeoutTimer","endDragIfSourceWasRemovedFromDOM","defaultPrevented","unshift","_e","lastClientOffset","hoverRafId","endDragNativeItem","body","cancelHover","scheduleHover","requestAnimationFrame","nativeType","setDragImage","dragPreviewOffset","setData","hasAttribute","preventDefault","isFirstEnter","enterLeaveCounter","altKey","isLastLeave","dragDrop","tagName","isContentEditable","emptyImage","getEmptyImage","Image","src","HTML5Backend","createBackend","ListenerType","OptionsReader","delay","_delay","scrollAngleRanges","getDropTargetElementsAtPoint","ignoreContextMenu","_ignoreContextMenu","enableHoverOutsideTarget","_enableHoverOutsideTarget","enableKeyboardEvents","_enableKeyboardEvents","enableMouseEvents","_enableMouseEvents","enableTouchEvents","_enableTouchEvents","touchSlop","delayTouchStart","ref2","ref3","delayMouseStart","ref4","ref5","ref6","distance","x1","y1","x2","y2","sqrt","pow","abs","inAngleRanges","angleRanges","angle","atan2","PI","ar","start","MouseButtons","Left","Right","Center","MouseButton","eventShouldStartDrag","button","eventShouldEndDrag","buttons","isTouchEvent","targetTouches","ELEMENT_NODE","getNodeClientOffset","getEventClientTouchOffset","lastTargetTouchFallback","getEventClientOffset","touches","supportsPassive","supported","eventNames","mouse","move","contextmenu","touch","keyboard","keydown","TouchBackendImpl","targetNodes","getTopMoveStartHandler","handleTopMoveStartCapture","handleTopMove","handleTopMoveCapture","handleTopMoveEndCapture","handleCancelOnEscape","_mouseClientOffset","handleTopMoveStart","uninstallSourceNodeRemovalObserver","subject","event","capture","passive","listenerTypes","listenerType","evt","handleMoveStart","handleMove","coords","droppedOn","elementFromPoint","childMatch","handleTopMoveStartDelay","installSourceNodeRemovalObserver","draggedSourceNode","draggedSourceNodeRemovalObserver","resurrectSourceNode","childList","style","display","removeAttribute","appendChild","disconnect","moveStartSourceIds","waitingForDelay","timeout","_evt","e1","_isScrolling","cancelable","dragOverTargetNodes","elementsAtPoint","elementsFromPoint","elementsAtPointExtended","nodeId","currentNode","orderedDragOverTargetIds","_getDropTargetId","ids","targetNode","TouchBackend","COLUMNS","chessboardDefaultProps","animationDuration","areArrowsAllowed","arePiecesDraggable","arePremovesAllowed","boardOrientation","boardWidth","clearPremovesOnRightClick","customArrows","customArrowColor","customBoardStyle","customDarkSquareStyle","backgroundColor","customDndBackend","customDndBackendOptions","customDropSquareStyle","boxShadow","customLightSquareStyle","customPieces","customPremoveDarkSquareStyle","customPremoveLightSquareStyle","customSquareStyles","dropOffBoardAction","isDraggablePiece","getPositionObject","onArrowsChange","onDragOverSquare","onMouseOutSquare","onMouseOverSquare","onPieceClick","onPieceDragBegin","onPieceDragEnd","onPieceDrop","onSquareClick","onSquareRightClick","position","showBoardNotation","snapToCursor","startPositionObject","a8","b8","c8","d8","e8","f8","g8","h8","a7","b7","c7","d7","e7","f7","g7","h7","a2","b2","c2","d2","e2","f2","g2","h2","a1","b1","d1","f1","g1","h1","whiteColumnValues","d","f","g","h","blackColumnValues","whiteRows","blackRows","getRelativeCoords","square","squareWidth","columns","rows","isDifferentFromStart","newPosition","isDifferent","getPositionDifferences","currentPosition","difference","removed","added","isString","s","convertPositionToObject","fenToObj","validFen","validPositionObject","fen","currentRow","row","colIdx","j","search","numEmptySquares","parseInt","fenToPieceCode","expandFenEmptySquares","chunks","piece","toUpperCase","validSquare","validPieceCode","pos","defaultPieces","wP","xmlns","version","opacity","fill","fillOpacity","fillRule","stroke","strokeWidth","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeDasharray","strokeOpacity","wR","wN","transform","wB","wQ","cx","cy","r","wK","bP","bR","bN","bB","bQ","bK","ChessboardContext","useChessboard","ChessboardProvider","showSparePieces","setCurrentPosition","positionDifferences","setPositionDifferences","lastPieceColour","setLastPieceColour","premoves","setPremoves","premovesRef","currentRightClickDown","setCurrentRightClickDown","arrows","setArrows","chessPieces","setChessPieces","manualDrop","setManualDrop","previousTimeout","setPreviousTimeout","waitingForAnimation","setWaitingForAnimation","clearPremoves","clearLastPieceColour","_Object$keys","_Object$entries","_Object$entries$","differences","newPieceColour","attemptPremove","newTimeout","clearArrows","handleSetPosition","sourceSq","targetSq","p","oldPremoves","newOnDropPosition","isValidMove","premove","onRightClickDown","onRightClickUp","oldArrows","newArrows","clearCurrentRightClickDown","Notation","col","whiteColor","blackColor","isRow","isColumn","isBottomLeftSquare","getRow","getColumn","renderBottomLeft","notationStyle","color","numericStyle","alphaStyle","renderLetters","renderNumbers","alignSelf","paddingLeft","fontSize","paddingRight","zIndex","Piece","squares","isPremovedPiece","pieceStyle","setPieceStyle","touchAction","cursor","sourceSquare","drag","oldPieceStyle","hidePiece","find","_positionDifferences$","removedPiece","newSquare","getSquareCoordinates","transition","getSingleSquareCoordinates","targetSquare","onClick","droppedPiece","viewBox","Square","squareColor","setSquares","squareHasPremove","squareRef","oldSquares","defaultSquareStyle","borderRadius","onMouseOver","relatedTarget","currentTarget","onMouseOut","onMouseDown","onMouseUp","onDragEnter","onContextMenu","center","justifyContent","borderBottomLeftRadius","borderTopRightRadius","borderTopLeftRadius","borderBottomRightRadius","Squares","boardStyles","_","rowStyles","flexWrap","errorImage","whiteKing","shapeRendering","textRendering","imageRendering","clipRule","ErrorBoundary","WhiteKing","showError","container","whiteKingStyle","alignItems","flexDirection","Board","boardRef","handleClickOutside","squareHasPremoveTarget","pointerEvents","arrow","from","to","markerWidth","markerHeight","refX","refY","orient","points","markerEnd","CustomDragLayer","collectedProps","layerStyles","getItemStyle","halfSquareWidth","WebkitTransform","Chessboard","backendSet","setBackendSet","isMobile","setIsMobile","otherProps","defaultProps"],"sources":["/home/kurone/unist/se/UNISTAGRAM/src/main/frontend/node_modules/react-chessboard/dist/index.esm.js"],"sourcesContent":["import React, { createContext, memo, useEffect, useLayoutEffect, useState, useCallback, useMemo, isValidElement, cloneElement, useContext, forwardRef, useRef, useImperativeHandle, Fragment as Fragment$1 } from 'react';\nimport { jsx, jsxs, Fragment } from 'react/jsx-runtime';\n\n/**\n * Create the React Context\n */\n\nconst DndContext = /*#__PURE__*/createContext({\n  dragDropManager: undefined\n});\n\n/**\n * Adapted from React: https://github.com/facebook/react/blob/master/packages/shared/formatProdErrorMessage.js\n *\n * Do not require this module directly! Use normal throw error calls. These messages will be replaced with error codes\n * during build.\n * @param {number} code\n */\n\nfunction formatProdErrorMessage(code) {\n  return \"Minified Redux error #\" + code + \"; visit https://redux.js.org/Errors?code=\" + code + \" for the full message or \" + 'use the non-minified dev environment for full errors. ';\n} // Inlined version of the `symbol-observable` polyfill\n\n\nvar $$observable = function () {\n  return typeof Symbol === 'function' && Symbol.observable || '@@observable';\n}();\n/**\n * These are private action types reserved by Redux.\n * For any unknown actions, you must return the current state.\n * If the current state is undefined, you must return the initial state.\n * Do not reference these action types directly in your code.\n */\n\n\nvar randomString = function randomString() {\n  return Math.random().toString(36).substring(7).split('').join('.');\n};\n\nvar ActionTypes = {\n  INIT: \"@@redux/INIT\" + randomString(),\n  REPLACE: \"@@redux/REPLACE\" + randomString(),\n  PROBE_UNKNOWN_ACTION: function PROBE_UNKNOWN_ACTION() {\n    return \"@@redux/PROBE_UNKNOWN_ACTION\" + randomString();\n  }\n};\n/**\n * @param {any} obj The object to inspect.\n * @returns {boolean} True if the argument appears to be a plain object.\n */\n\nfunction isPlainObject(obj) {\n  if (typeof obj !== 'object' || obj === null) return false;\n  var proto = obj;\n\n  while (Object.getPrototypeOf(proto) !== null) {\n    proto = Object.getPrototypeOf(proto);\n  }\n\n  return Object.getPrototypeOf(obj) === proto;\n} // Inlined / shortened version of `kindOf` from https://github.com/jonschlinkert/kind-of\n\n\nfunction miniKindOf(val) {\n  if (val === void 0) return 'undefined';\n  if (val === null) return 'null';\n  var type = typeof val;\n\n  switch (type) {\n    case 'boolean':\n    case 'string':\n    case 'number':\n    case 'symbol':\n    case 'function':\n      {\n        return type;\n      }\n  }\n\n  if (Array.isArray(val)) return 'array';\n  if (isDate(val)) return 'date';\n  if (isError(val)) return 'error';\n  var constructorName = ctorName(val);\n\n  switch (constructorName) {\n    case 'Symbol':\n    case 'Promise':\n    case 'WeakMap':\n    case 'WeakSet':\n    case 'Map':\n    case 'Set':\n      return constructorName;\n  } // other\n\n\n  return type.slice(8, -1).toLowerCase().replace(/\\s/g, '');\n}\n\nfunction ctorName(val) {\n  return typeof val.constructor === 'function' ? val.constructor.name : null;\n}\n\nfunction isError(val) {\n  return val instanceof Error || typeof val.message === 'string' && val.constructor && typeof val.constructor.stackTraceLimit === 'number';\n}\n\nfunction isDate(val) {\n  if (val instanceof Date) return true;\n  return typeof val.toDateString === 'function' && typeof val.getDate === 'function' && typeof val.setDate === 'function';\n}\n\nfunction kindOf(val) {\n  var typeOfVal = typeof val;\n\n  if (process.env.NODE_ENV !== 'production') {\n    typeOfVal = miniKindOf(val);\n  }\n\n  return typeOfVal;\n}\n/**\n * @deprecated\n *\n * **We recommend using the `configureStore` method\n * of the `@reduxjs/toolkit` package**, which replaces `createStore`.\n *\n * Redux Toolkit is our recommended approach for writing Redux logic today,\n * including store setup, reducers, data fetching, and more.\n *\n * **For more details, please read this Redux docs page:**\n * **https://redux.js.org/introduction/why-rtk-is-redux-today**\n *\n * `configureStore` from Redux Toolkit is an improved version of `createStore` that\n * simplifies setup and helps avoid common bugs.\n *\n * You should not be using the `redux` core package by itself today, except for learning purposes.\n * The `createStore` method from the core `redux` package will not be removed, but we encourage\n * all users to migrate to using Redux Toolkit for all Redux code.\n *\n * If you want to use `createStore` without this visual deprecation warning, use\n * the `legacy_createStore` import instead:\n *\n * `import { legacy_createStore as createStore} from 'redux'`\n *\n */\n\n\nfunction createStore(reducer, preloadedState, enhancer) {\n  var _ref2;\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'function' || typeof enhancer === 'function' && typeof arguments[3] === 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(0) : 'It looks like you are passing several store enhancers to ' + 'createStore(). This is not supported. Instead, compose them ' + 'together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.');\n  }\n\n  if (typeof preloadedState === 'function' && typeof enhancer === 'undefined') {\n    enhancer = preloadedState;\n    preloadedState = undefined;\n  }\n\n  if (typeof enhancer !== 'undefined') {\n    if (typeof enhancer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(1) : \"Expected the enhancer to be a function. Instead, received: '\" + kindOf(enhancer) + \"'\");\n    }\n\n    return enhancer(createStore)(reducer, preloadedState);\n  }\n\n  if (typeof reducer !== 'function') {\n    throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(2) : \"Expected the root reducer to be a function. Instead, received: '\" + kindOf(reducer) + \"'\");\n  }\n\n  var currentReducer = reducer;\n  var currentState = preloadedState;\n  var currentListeners = [];\n  var nextListeners = currentListeners;\n  var isDispatching = false;\n  /**\n   * This makes a shallow copy of currentListeners so we can use\n   * nextListeners as a temporary list while dispatching.\n   *\n   * This prevents any bugs around consumers calling\n   * subscribe/unsubscribe in the middle of a dispatch.\n   */\n\n  function ensureCanMutateNextListeners() {\n    if (nextListeners === currentListeners) {\n      nextListeners = currentListeners.slice();\n    }\n  }\n  /**\n   * Reads the state tree managed by the store.\n   *\n   * @returns {any} The current state tree of your application.\n   */\n\n\n  function getState() {\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(3) : 'You may not call store.getState() while the reducer is executing. ' + 'The reducer has already received the state as an argument. ' + 'Pass it down from the top reducer instead of reading it from the store.');\n    }\n\n    return currentState;\n  }\n  /**\n   * Adds a change listener. It will be called any time an action is dispatched,\n   * and some part of the state tree may potentially have changed. You may then\n   * call `getState()` to read the current state tree inside the callback.\n   *\n   * You may call `dispatch()` from a change listener, with the following\n   * caveats:\n   *\n   * 1. The subscriptions are snapshotted just before every `dispatch()` call.\n   * If you subscribe or unsubscribe while the listeners are being invoked, this\n   * will not have any effect on the `dispatch()` that is currently in progress.\n   * However, the next `dispatch()` call, whether nested or not, will use a more\n   * recent snapshot of the subscription list.\n   *\n   * 2. The listener should not expect to see all state changes, as the state\n   * might have been updated multiple times during a nested `dispatch()` before\n   * the listener is called. It is, however, guaranteed that all subscribers\n   * registered before the `dispatch()` started will be called with the latest\n   * state by the time it exits.\n   *\n   * @param {Function} listener A callback to be invoked on every dispatch.\n   * @returns {Function} A function to remove this change listener.\n   */\n\n\n  function subscribe(listener) {\n    if (typeof listener !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(4) : \"Expected the listener to be a function. Instead, received: '\" + kindOf(listener) + \"'\");\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(5) : 'You may not call store.subscribe() while the reducer is executing. ' + 'If you would like to be notified after the store has been updated, subscribe from a ' + 'component and invoke store.getState() in the callback to access the latest state. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n    }\n\n    var isSubscribed = true;\n    ensureCanMutateNextListeners();\n    nextListeners.push(listener);\n    return function unsubscribe() {\n      if (!isSubscribed) {\n        return;\n      }\n\n      if (isDispatching) {\n        throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(6) : 'You may not unsubscribe from a store listener while the reducer is executing. ' + 'See https://redux.js.org/api/store#subscribelistener for more details.');\n      }\n\n      isSubscribed = false;\n      ensureCanMutateNextListeners();\n      var index = nextListeners.indexOf(listener);\n      nextListeners.splice(index, 1);\n      currentListeners = null;\n    };\n  }\n  /**\n   * Dispatches an action. It is the only way to trigger a state change.\n   *\n   * The `reducer` function, used to create the store, will be called with the\n   * current state tree and the given `action`. Its return value will\n   * be considered the **next** state of the tree, and the change listeners\n   * will be notified.\n   *\n   * The base implementation only supports plain object actions. If you want to\n   * dispatch a Promise, an Observable, a thunk, or something else, you need to\n   * wrap your store creating function into the corresponding middleware. For\n   * example, see the documentation for the `redux-thunk` package. Even the\n   * middleware will eventually dispatch plain object actions using this method.\n   *\n   * @param {Object} action A plain object representing “what changed”. It is\n   * a good idea to keep actions serializable so you can record and replay user\n   * sessions, or use the time travelling `redux-devtools`. An action must have\n   * a `type` property which may not be `undefined`. It is a good idea to use\n   * string constants for action types.\n   *\n   * @returns {Object} For convenience, the same action object you dispatched.\n   *\n   * Note that, if you use a custom middleware, it may wrap `dispatch()` to\n   * return something else (for example, a Promise you can await).\n   */\n\n\n  function dispatch(action) {\n    if (!isPlainObject(action)) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(7) : \"Actions must be plain objects. Instead, the actual type was: '\" + kindOf(action) + \"'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.\");\n    }\n\n    if (typeof action.type === 'undefined') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(8) : 'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.');\n    }\n\n    if (isDispatching) {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(9) : 'Reducers may not dispatch actions.');\n    }\n\n    try {\n      isDispatching = true;\n      currentState = currentReducer(currentState, action);\n    } finally {\n      isDispatching = false;\n    }\n\n    var listeners = currentListeners = nextListeners;\n\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      listener();\n    }\n\n    return action;\n  }\n  /**\n   * Replaces the reducer currently used by the store to calculate the state.\n   *\n   * You might need this if your app implements code splitting and you want to\n   * load some of the reducers dynamically. You might also need this if you\n   * implement a hot reloading mechanism for Redux.\n   *\n   * @param {Function} nextReducer The reducer for the store to use instead.\n   * @returns {void}\n   */\n\n\n  function replaceReducer(nextReducer) {\n    if (typeof nextReducer !== 'function') {\n      throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(10) : \"Expected the nextReducer to be a function. Instead, received: '\" + kindOf(nextReducer));\n    }\n\n    currentReducer = nextReducer; // This action has a similiar effect to ActionTypes.INIT.\n    // Any reducers that existed in both the new and old rootReducer\n    // will receive the previous state. This effectively populates\n    // the new state tree with any relevant data from the old one.\n\n    dispatch({\n      type: ActionTypes.REPLACE\n    });\n  }\n  /**\n   * Interoperability point for observable/reactive libraries.\n   * @returns {observable} A minimal observable of state changes.\n   * For more information, see the observable proposal:\n   * https://github.com/tc39/proposal-observable\n   */\n\n\n  function observable() {\n    var _ref;\n\n    var outerSubscribe = subscribe;\n    return _ref = {\n      /**\n       * The minimal observable subscription method.\n       * @param {Object} observer Any object that can be used as an observer.\n       * The observer object should have a `next` method.\n       * @returns {subscription} An object with an `unsubscribe` method that can\n       * be used to unsubscribe the observable from the store, and prevent further\n       * emission of values from the observable.\n       */\n      subscribe: function subscribe(observer) {\n        if (typeof observer !== 'object' || observer === null) {\n          throw new Error(process.env.NODE_ENV === \"production\" ? formatProdErrorMessage(11) : \"Expected the observer to be an object. Instead, received: '\" + kindOf(observer) + \"'\");\n        }\n\n        function observeState() {\n          if (observer.next) {\n            observer.next(getState());\n          }\n        }\n\n        observeState();\n        var unsubscribe = outerSubscribe(observeState);\n        return {\n          unsubscribe: unsubscribe\n        };\n      }\n    }, _ref[$$observable] = function () {\n      return this;\n    }, _ref;\n  } // When a store is created, an \"INIT\" action is dispatched so that every\n  // reducer returns their initial state. This effectively populates\n  // the initial state tree.\n\n\n  dispatch({\n    type: ActionTypes.INIT\n  });\n  return _ref2 = {\n    dispatch: dispatch,\n    subscribe: subscribe,\n    getState: getState,\n    replaceReducer: replaceReducer\n  }, _ref2[$$observable] = observable, _ref2;\n}\n/**\n * Prints a warning in the console if it exists.\n *\n * @param {String} message The warning message.\n * @returns {void}\n */\n\nfunction warning(message) {\n  /* eslint-disable no-console */\n  if (typeof console !== 'undefined' && typeof console.error === 'function') {\n    console.error(message);\n  }\n  /* eslint-enable no-console */\n\n\n  try {\n    // This error was thrown as a convenience so that if you enable\n    // \"break on all exceptions\" in your console,\n    // it would pause the execution at this line.\n    throw new Error(message);\n  } catch (e) {} // eslint-disable-line no-empty\n\n}\n/*\n * This is a dummy function to check if the function name has been altered by minification.\n * If the function has been minified and NODE_ENV !== 'production', warn the user.\n */\n\n\nfunction isCrushed() {}\n\nif (process.env.NODE_ENV !== 'production' && typeof isCrushed.name === 'string' && isCrushed.name !== 'isCrushed') {\n  warning('You are currently using minified code outside of NODE_ENV === \"production\". ' + 'This means that you are running a slower development build of Redux. ' + 'You can use loose-envify (https://github.com/zertosh/loose-envify) for browserify ' + 'or setting mode to production in webpack (https://webpack.js.org/concepts/mode/) ' + 'to ensure you have the correct code for your production build.');\n}\n\n/**\n * Use invariant() to assert state which your program assumes to be true.\n *\n * Provide sprintf-style format (only %s is supported) and arguments\n * to provide information about what broke and what you were\n * expecting.\n *\n * The invariant message will be stripped in production, but the invariant\n * will remain to ensure logic does not differ in production.\n */\nfunction invariant(condition, format, ...args) {\n  if (isProduction()) {\n    if (format === undefined) {\n      throw new Error('invariant requires an error message argument');\n    }\n  }\n\n  if (!condition) {\n    let error;\n\n    if (format === undefined) {\n      error = new Error('Minified exception occurred; use the non-minified dev environment ' + 'for the full error message and additional helpful warnings.');\n    } else {\n      let argIndex = 0;\n      error = new Error(format.replace(/%s/g, function () {\n        return args[argIndex++];\n      }));\n      error.name = 'Invariant Violation';\n    }\n\n    error.framesToPop = 1 // we don't care about invariant's own frame\n    ;\n    throw error;\n  }\n}\n\nfunction isProduction() {\n  return typeof process !== 'undefined' && process.env['NODE_ENV'] === 'production';\n}\n\n// cheap lodash replacements\n\n/**\n * drop-in replacement for _.get\n * @param obj\n * @param path\n * @param defaultValue\n */\nfunction get(obj, path, defaultValue) {\n  return path.split('.').reduce((a, c) => a && a[c] ? a[c] : defaultValue || null, obj);\n}\n/**\n * drop-in replacement for _.without\n */\n\nfunction without$1(items, item) {\n  return items.filter(i => i !== item);\n}\n/**\n * drop-in replacement for _.isString\n * @param input\n */\n\nfunction isObject(input) {\n  return typeof input === 'object';\n}\n/**\n * replacement for _.xor\n * @param itemsA\n * @param itemsB\n */\n\nfunction xor(itemsA, itemsB) {\n  const map = new Map();\n\n  const insertItem = item => {\n    map.set(item, map.has(item) ? map.get(item) + 1 : 1);\n  };\n\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  map.forEach((count, key) => {\n    if (count === 1) {\n      result.push(key);\n    }\n  });\n  return result;\n}\n/**\n * replacement for _.intersection\n * @param itemsA\n * @param itemsB\n */\n\nfunction intersection(itemsA, itemsB) {\n  return itemsA.filter(t => itemsB.indexOf(t) > -1);\n}\n\nconst INIT_COORDS = 'dnd-core/INIT_COORDS';\nconst BEGIN_DRAG = 'dnd-core/BEGIN_DRAG';\nconst PUBLISH_DRAG_SOURCE = 'dnd-core/PUBLISH_DRAG_SOURCE';\nconst HOVER = 'dnd-core/HOVER';\nconst DROP = 'dnd-core/DROP';\nconst END_DRAG = 'dnd-core/END_DRAG';\n\nfunction setClientOffset(clientOffset, sourceClientOffset) {\n  return {\n    type: INIT_COORDS,\n    payload: {\n      sourceClientOffset: sourceClientOffset || null,\n      clientOffset: clientOffset || null\n    }\n  };\n}\n\nconst ResetCoordinatesAction = {\n  type: INIT_COORDS,\n  payload: {\n    clientOffset: null,\n    sourceClientOffset: null\n  }\n};\nfunction createBeginDrag(manager) {\n  return function beginDrag(sourceIds = [], options = {\n    publishSource: true\n  }) {\n    const {\n      publishSource = true,\n      clientOffset,\n      getSourceClientOffset\n    } = options;\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry(); // Initialize the coordinates using the client offset\n\n    manager.dispatch(setClientOffset(clientOffset));\n    verifyInvariants$1(sourceIds, monitor, registry); // Get the draggable source\n\n    const sourceId = getDraggableSource(sourceIds, monitor);\n\n    if (sourceId == null) {\n      manager.dispatch(ResetCoordinatesAction);\n      return;\n    } // Get the source client offset\n\n\n    let sourceClientOffset = null;\n\n    if (clientOffset) {\n      if (!getSourceClientOffset) {\n        throw new Error('getSourceClientOffset must be defined');\n      }\n\n      verifyGetSourceClientOffsetIsFunction(getSourceClientOffset);\n      sourceClientOffset = getSourceClientOffset(sourceId);\n    } // Initialize the full coordinates\n\n\n    manager.dispatch(setClientOffset(clientOffset, sourceClientOffset));\n    const source = registry.getSource(sourceId);\n    const item = source.beginDrag(monitor, sourceId); // If source.beginDrag returns null, this is an indicator to cancel the drag\n\n    if (item == null) {\n      return undefined;\n    }\n\n    verifyItemIsObject(item);\n    registry.pinSource(sourceId);\n    const itemType = registry.getSourceType(sourceId);\n    return {\n      type: BEGIN_DRAG,\n      payload: {\n        itemType,\n        item,\n        sourceId,\n        clientOffset: clientOffset || null,\n        sourceClientOffset: sourceClientOffset || null,\n        isSourcePublic: !!publishSource\n      }\n    };\n  };\n}\n\nfunction verifyInvariants$1(sourceIds, monitor, registry) {\n  invariant(!monitor.isDragging(), 'Cannot call beginDrag while dragging.');\n  sourceIds.forEach(function (sourceId) {\n    invariant(registry.getSource(sourceId), 'Expected sourceIds to be registered.');\n  });\n}\n\nfunction verifyGetSourceClientOffsetIsFunction(getSourceClientOffset) {\n  invariant(typeof getSourceClientOffset === 'function', 'When clientOffset is provided, getSourceClientOffset must be a function.');\n}\n\nfunction verifyItemIsObject(item) {\n  invariant(isObject(item), 'Item must be an object.');\n}\n\nfunction getDraggableSource(sourceIds, monitor) {\n  let sourceId = null;\n\n  for (let i = sourceIds.length - 1; i >= 0; i--) {\n    if (monitor.canDragSource(sourceIds[i])) {\n      sourceId = sourceIds[i];\n      break;\n    }\n  }\n\n  return sourceId;\n}\n\nfunction _defineProperty$4(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$4(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$4(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nfunction createDrop(manager) {\n  return function drop(options = {}) {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyInvariants(monitor);\n    const targetIds = getDroppableTargets(monitor); // Multiple actions are dispatched here, which is why this doesn't return an action\n\n    targetIds.forEach((targetId, index) => {\n      const dropResult = determineDropResult(targetId, index, registry, monitor);\n      const action = {\n        type: DROP,\n        payload: {\n          dropResult: _objectSpread$4({}, options, dropResult)\n        }\n      };\n      manager.dispatch(action);\n    });\n  };\n}\n\nfunction verifyInvariants(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call drop while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call drop twice during one drag operation.');\n}\n\nfunction determineDropResult(targetId, index, registry, monitor) {\n  const target = registry.getTarget(targetId);\n  let dropResult = target ? target.drop(monitor, targetId) : undefined;\n  verifyDropResultType(dropResult);\n\n  if (typeof dropResult === 'undefined') {\n    dropResult = index === 0 ? {} : monitor.getDropResult();\n  }\n\n  return dropResult;\n}\n\nfunction verifyDropResultType(dropResult) {\n  invariant(typeof dropResult === 'undefined' || isObject(dropResult), 'Drop result must either be an object or undefined.');\n}\n\nfunction getDroppableTargets(monitor) {\n  const targetIds = monitor.getTargetIds().filter(monitor.canDropOnTarget, monitor);\n  targetIds.reverse();\n  return targetIds;\n}\n\nfunction createEndDrag(manager) {\n  return function endDrag() {\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    verifyIsDragging(monitor);\n    const sourceId = monitor.getSourceId();\n\n    if (sourceId != null) {\n      const source = registry.getSource(sourceId, true);\n      source.endDrag(monitor, sourceId);\n      registry.unpinSource();\n    }\n\n    return {\n      type: END_DRAG\n    };\n  };\n}\n\nfunction verifyIsDragging(monitor) {\n  invariant(monitor.isDragging(), 'Cannot call endDrag while not dragging.');\n}\n\nfunction matchesType(targetType, draggedItemType) {\n  if (draggedItemType === null) {\n    return targetType === null;\n  }\n\n  return Array.isArray(targetType) ? targetType.some(t => t === draggedItemType) : targetType === draggedItemType;\n}\n\nfunction createHover(manager) {\n  return function hover(targetIdsArg, {\n    clientOffset\n  } = {}) {\n    verifyTargetIdsIsArray(targetIdsArg);\n    const targetIds = targetIdsArg.slice(0);\n    const monitor = manager.getMonitor();\n    const registry = manager.getRegistry();\n    const draggedItemType = monitor.getItemType();\n    removeNonMatchingTargetIds(targetIds, registry, draggedItemType);\n    checkInvariants(targetIds, monitor, registry);\n    hoverAllTargets(targetIds, monitor, registry);\n    return {\n      type: HOVER,\n      payload: {\n        targetIds,\n        clientOffset: clientOffset || null\n      }\n    };\n  };\n}\n\nfunction verifyTargetIdsIsArray(targetIdsArg) {\n  invariant(Array.isArray(targetIdsArg), 'Expected targetIds to be an array.');\n}\n\nfunction checkInvariants(targetIds, monitor, registry) {\n  invariant(monitor.isDragging(), 'Cannot call hover while not dragging.');\n  invariant(!monitor.didDrop(), 'Cannot call hover after drop.');\n\n  for (let i = 0; i < targetIds.length; i++) {\n    const targetId = targetIds[i];\n    invariant(targetIds.lastIndexOf(targetId) === i, 'Expected targetIds to be unique in the passed array.');\n    const target = registry.getTarget(targetId);\n    invariant(target, 'Expected targetIds to be registered.');\n  }\n}\n\nfunction removeNonMatchingTargetIds(targetIds, registry, draggedItemType) {\n  // Remove those targetIds that don't match the targetType.  This\n  // fixes shallow isOver which would only be non-shallow because of\n  // non-matching targets.\n  for (let i = targetIds.length - 1; i >= 0; i--) {\n    const targetId = targetIds[i];\n    const targetType = registry.getTargetType(targetId);\n\n    if (!matchesType(targetType, draggedItemType)) {\n      targetIds.splice(i, 1);\n    }\n  }\n}\n\nfunction hoverAllTargets(targetIds, monitor, registry) {\n  // Finally call hover on all matching targets.\n  targetIds.forEach(function (targetId) {\n    const target = registry.getTarget(targetId);\n    target.hover(monitor, targetId);\n  });\n}\n\nfunction createPublishDragSource(manager) {\n  return function publishDragSource() {\n    const monitor = manager.getMonitor();\n\n    if (monitor.isDragging()) {\n      return {\n        type: PUBLISH_DRAG_SOURCE\n      };\n    }\n\n    return;\n  };\n}\n\nfunction createDragDropActions(manager) {\n  return {\n    beginDrag: createBeginDrag(manager),\n    publishDragSource: createPublishDragSource(manager),\n    hover: createHover(manager),\n    drop: createDrop(manager),\n    endDrag: createEndDrag(manager)\n  };\n}\n\nclass DragDropManagerImpl {\n  receiveBackend(backend) {\n    this.backend = backend;\n  }\n\n  getMonitor() {\n    return this.monitor;\n  }\n\n  getBackend() {\n    return this.backend;\n  }\n\n  getRegistry() {\n    return this.monitor.registry;\n  }\n\n  getActions() {\n    /* eslint-disable-next-line @typescript-eslint/no-this-alias */\n    const manager = this;\n    const {\n      dispatch\n    } = this.store;\n\n    function bindActionCreator(actionCreator) {\n      return (...args) => {\n        const action = actionCreator.apply(manager, args);\n\n        if (typeof action !== 'undefined') {\n          dispatch(action);\n        }\n      };\n    }\n\n    const actions = createDragDropActions(this);\n    return Object.keys(actions).reduce((boundActions, key) => {\n      const action = actions[key];\n      boundActions[key] = bindActionCreator(action);\n      return boundActions;\n    }, {});\n  }\n\n  dispatch(action) {\n    this.store.dispatch(action);\n  }\n\n  constructor(store, monitor) {\n    this.isSetUp = false;\n\n    this.handleRefCountChange = () => {\n      const shouldSetUp = this.store.getState().refCount > 0;\n\n      if (this.backend) {\n        if (shouldSetUp && !this.isSetUp) {\n          this.backend.setup();\n          this.isSetUp = true;\n        } else if (!shouldSetUp && this.isSetUp) {\n          this.backend.teardown();\n          this.isSetUp = false;\n        }\n      }\n    };\n\n    this.store = store;\n    this.monitor = monitor;\n    store.subscribe(this.handleRefCountChange);\n  }\n\n}\n\n/**\n * Coordinate addition\n * @param a The first coordinate\n * @param b The second coordinate\n */\nfunction add(a, b) {\n  return {\n    x: a.x + b.x,\n    y: a.y + b.y\n  };\n}\n/**\n * Coordinate subtraction\n * @param a The first coordinate\n * @param b The second coordinate\n */\n\nfunction subtract(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}\n/**\n * Returns the cartesian distance of the drag source component's position, based on its position\n * at the time when the current drag operation has started, and the movement difference.\n *\n * Returns null if no item is being dragged.\n *\n * @param state The offset state to compute from\n */\n\nfunction getSourceClientOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset,\n    initialSourceClientOffset\n  } = state;\n\n  if (!clientOffset || !initialClientOffset || !initialSourceClientOffset) {\n    return null;\n  }\n\n  return subtract(add(clientOffset, initialSourceClientOffset), initialClientOffset);\n}\n/**\n * Determines the x,y offset between the client offset and the initial client offset\n *\n * @param state The offset state to compute from\n */\n\nfunction getDifferenceFromInitialOffset(state) {\n  const {\n    clientOffset,\n    initialClientOffset\n  } = state;\n\n  if (!clientOffset || !initialClientOffset) {\n    return null;\n  }\n\n  return subtract(clientOffset, initialClientOffset);\n}\n\nconst NONE = [];\nconst ALL = [];\nNONE.__IS_NONE__ = true;\nALL.__IS_ALL__ = true;\n/**\n * Determines if the given handler IDs are dirty or not.\n *\n * @param dirtyIds The set of dirty handler ids\n * @param handlerIds The set of handler ids to check\n */\n\nfunction areDirty(dirtyIds, handlerIds) {\n  if (dirtyIds === NONE) {\n    return false;\n  }\n\n  if (dirtyIds === ALL || typeof handlerIds === 'undefined') {\n    return true;\n  }\n\n  const commonIds = intersection(handlerIds, dirtyIds);\n  return commonIds.length > 0;\n}\n\nclass DragDropMonitorImpl {\n  subscribeToStateChange(listener, options = {}) {\n    const {\n      handlerIds\n    } = options;\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    invariant(typeof handlerIds === 'undefined' || Array.isArray(handlerIds), 'handlerIds, when specified, must be an array of strings.');\n    let prevStateId = this.store.getState().stateId;\n\n    const handleChange = () => {\n      const state = this.store.getState();\n      const currentStateId = state.stateId;\n\n      try {\n        const canSkipListener = currentStateId === prevStateId || currentStateId === prevStateId + 1 && !areDirty(state.dirtyHandlerIds, handlerIds);\n\n        if (!canSkipListener) {\n          listener();\n        }\n      } finally {\n        prevStateId = currentStateId;\n      }\n    };\n\n    return this.store.subscribe(handleChange);\n  }\n\n  subscribeToOffsetChange(listener) {\n    invariant(typeof listener === 'function', 'listener must be a function.');\n    let previousState = this.store.getState().dragOffset;\n\n    const handleChange = () => {\n      const nextState = this.store.getState().dragOffset;\n\n      if (nextState === previousState) {\n        return;\n      }\n\n      previousState = nextState;\n      listener();\n    };\n\n    return this.store.subscribe(handleChange);\n  }\n\n  canDragSource(sourceId) {\n    if (!sourceId) {\n      return false;\n    }\n\n    const source = this.registry.getSource(sourceId);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n\n    if (this.isDragging()) {\n      return false;\n    }\n\n    return source.canDrag(this, sourceId);\n  }\n\n  canDropOnTarget(targetId) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n\n    const target = this.registry.getTarget(targetId);\n    invariant(target, `Expected to find a valid target. targetId=${targetId}`);\n\n    if (!this.isDragging() || this.didDrop()) {\n      return false;\n    }\n\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n    return matchesType(targetType, draggedItemType) && target.canDrop(this, targetId);\n  }\n\n  isDragging() {\n    return Boolean(this.getItemType());\n  }\n\n  isDraggingSource(sourceId) {\n    // undefined on initial render\n    if (!sourceId) {\n      return false;\n    }\n\n    const source = this.registry.getSource(sourceId, true);\n    invariant(source, `Expected to find a valid source. sourceId=${sourceId}`);\n\n    if (!this.isDragging() || !this.isSourcePublic()) {\n      return false;\n    }\n\n    const sourceType = this.registry.getSourceType(sourceId);\n    const draggedItemType = this.getItemType();\n\n    if (sourceType !== draggedItemType) {\n      return false;\n    }\n\n    return source.isDragging(this, sourceId);\n  }\n\n  isOverTarget(targetId, options = {\n    shallow: false\n  }) {\n    // undefined on initial render\n    if (!targetId) {\n      return false;\n    }\n\n    const {\n      shallow\n    } = options;\n\n    if (!this.isDragging()) {\n      return false;\n    }\n\n    const targetType = this.registry.getTargetType(targetId);\n    const draggedItemType = this.getItemType();\n\n    if (draggedItemType && !matchesType(targetType, draggedItemType)) {\n      return false;\n    }\n\n    const targetIds = this.getTargetIds();\n\n    if (!targetIds.length) {\n      return false;\n    }\n\n    const index = targetIds.indexOf(targetId);\n\n    if (shallow) {\n      return index === targetIds.length - 1;\n    } else {\n      return index > -1;\n    }\n  }\n\n  getItemType() {\n    return this.store.getState().dragOperation.itemType;\n  }\n\n  getItem() {\n    return this.store.getState().dragOperation.item;\n  }\n\n  getSourceId() {\n    return this.store.getState().dragOperation.sourceId;\n  }\n\n  getTargetIds() {\n    return this.store.getState().dragOperation.targetIds;\n  }\n\n  getDropResult() {\n    return this.store.getState().dragOperation.dropResult;\n  }\n\n  didDrop() {\n    return this.store.getState().dragOperation.didDrop;\n  }\n\n  isSourcePublic() {\n    return Boolean(this.store.getState().dragOperation.isSourcePublic);\n  }\n\n  getInitialClientOffset() {\n    return this.store.getState().dragOffset.initialClientOffset;\n  }\n\n  getInitialSourceClientOffset() {\n    return this.store.getState().dragOffset.initialSourceClientOffset;\n  }\n\n  getClientOffset() {\n    return this.store.getState().dragOffset.clientOffset;\n  }\n\n  getSourceClientOffset() {\n    return getSourceClientOffset(this.store.getState().dragOffset);\n  }\n\n  getDifferenceFromInitialOffset() {\n    return getDifferenceFromInitialOffset(this.store.getState().dragOffset);\n  }\n\n  constructor(store, registry) {\n    this.store = store;\n    this.registry = registry;\n  }\n\n}\n\n// Safari 6 and 6.1 for desktop, iPad, and iPhone are the only browsers that\n// have WebKitMutationObserver but not un-prefixed MutationObserver.\n// Must use `global` or `self` instead of `window` to work in both frames and web\n// workers. `global` is a provision of Browserify, Mr, Mrs, or Mop.\n\n/* globals self */\nconst scope = typeof global !== 'undefined' ? global : self;\nconst BrowserMutationObserver = scope.MutationObserver || scope.WebKitMutationObserver;\nfunction makeRequestCallFromTimer(callback) {\n  return function requestCall() {\n    // We dispatch a timeout with a specified delay of 0 for engines that\n    // can reliably accommodate that request. This will usually be snapped\n    // to a 4 milisecond delay, but once we're flushing, there's no delay\n    // between events.\n    const timeoutHandle = setTimeout(handleTimer, 0); // However, since this timer gets frequently dropped in Firefox\n    // workers, we enlist an interval handle that will try to fire\n    // an event 20 times per second until it succeeds.\n\n    const intervalHandle = setInterval(handleTimer, 50);\n\n    function handleTimer() {\n      // Whichever timer succeeds will cancel both timers and\n      // execute the callback.\n      clearTimeout(timeoutHandle);\n      clearInterval(intervalHandle);\n      callback();\n    }\n  };\n} // To request a high priority event, we induce a mutation observer by toggling\n// the text of a text node between \"1\" and \"-1\".\n\nfunction makeRequestCallFromMutationObserver(callback) {\n  let toggle = 1;\n  const observer = new BrowserMutationObserver(callback);\n  const node = document.createTextNode('');\n  observer.observe(node, {\n    characterData: true\n  });\n  return function requestCall() {\n    toggle = -toggle;\n    node.data = toggle;\n  };\n}\nconst makeRequestCall = typeof BrowserMutationObserver === 'function' ? // reliably everywhere they are implemented.\n// They are implemented in all modern browsers.\n//\n// - Android 4-4.3\n// - Chrome 26-34\n// - Firefox 14-29\n// - Internet Explorer 11\n// - iPad Safari 6-7.1\n// - iPhone Safari 7-7.1\n// - Safari 6-7\nmakeRequestCallFromMutationObserver : // task queue, are implemented in Internet Explorer 10, Safari 5.0-1, and Opera\n// 11-12, and in web workers in many engines.\n// Although message channels yield to any queued rendering and IO tasks, they\n// would be better than imposing the 4ms delay of timers.\n// However, they do not work reliably in Internet Explorer or Safari.\n// Internet Explorer 10 is the only browser that has setImmediate but does\n// not have MutationObservers.\n// Although setImmediate yields to the browser's renderer, it would be\n// preferrable to falling back to setTimeout since it does not have\n// the minimum 4ms penalty.\n// Unfortunately there appears to be a bug in Internet Explorer 10 Mobile (and\n// Desktop to a lesser extent) that renders both setImmediate and\n// MessageChannel useless for the purposes of ASAP.\n// https://github.com/kriskowal/q/issues/396\n// Timers are implemented universally.\n// We fall back to timers in workers in most engines, and in foreground\n// contexts in the following browsers.\n// However, note that even this simple case requires nuances to operate in a\n// broad spectrum of browsers.\n//\n// - Firefox 3-13\n// - Internet Explorer 6-9\n// - iPad Safari 4.3\n// - Lynx 2.8.7\nmakeRequestCallFromTimer;\n\n/* eslint-disable no-restricted-globals, @typescript-eslint/ban-ts-comment, @typescript-eslint/no-unused-vars, @typescript-eslint/no-non-null-assertion */\nclass AsapQueue {\n  // Use the fastest means possible to execute a task in its own turn, with\n  // priority over other events including IO, animation, reflow, and redraw\n  // events in browsers.\n  //\n  // An exception thrown by a task will permanently interrupt the processing of\n  // subsequent tasks. The higher level `asap` function ensures that if an\n  // exception is thrown by a task, that the task queue will continue flushing as\n  // soon as possible, but if you use `rawAsap` directly, you are responsible to\n  // either ensure that no exceptions are thrown from your task, or to manually\n  // call `rawAsap.requestFlush` if an exception is thrown.\n  enqueueTask(task) {\n    const {\n      queue: q,\n      requestFlush\n    } = this;\n\n    if (!q.length) {\n      requestFlush();\n      this.flushing = true;\n    } // Equivalent to push, but avoids a function call.\n\n\n    q[q.length] = task;\n  }\n\n  constructor() {\n    this.queue = []; // We queue errors to ensure they are thrown in right order (FIFO).\n    // Array-as-queue is good enough here, since we are just dealing with exceptions.\n\n    this.pendingErrors = []; // Once a flush has been requested, no further calls to `requestFlush` are\n    // necessary until the next `flush` completes.\n    // @ts-ignore\n\n    this.flushing = false; // The position of the next task to execute in the task queue. This is\n    // preserved between calls to `flush` so that it can be resumed if\n    // a task throws an exception.\n\n    this.index = 0; // If a task schedules additional tasks recursively, the task queue can grow\n    // unbounded. To prevent memory exhaustion, the task queue will periodically\n    // truncate already-completed tasks.\n\n    this.capacity = 1024; // The flush function processes all tasks that have been scheduled with\n    // `rawAsap` unless and until one of those tasks throws an exception.\n    // If a task throws an exception, `flush` ensures that its state will remain\n    // consistent and will resume where it left off when called again.\n    // However, `flush` does not make any arrangements to be called again if an\n    // exception is thrown.\n\n    this.flush = () => {\n      const {\n        queue: q\n      } = this;\n\n      while (this.index < q.length) {\n        const currentIndex = this.index; // Advance the index before calling the task. This ensures that we will\n        // begin flushing on the next task the task throws an error.\n\n        this.index++;\n        q[currentIndex].call(); // Prevent leaking memory for long chains of recursive calls to `asap`.\n        // If we call `asap` within tasks scheduled by `asap`, the queue will\n        // grow, but to avoid an O(n) walk for every task we execute, we don't\n        // shift tasks off the queue after they have been executed.\n        // Instead, we periodically shift 1024 tasks off the queue.\n\n        if (this.index > this.capacity) {\n          // Manually shift all values starting at the index back to the\n          // beginning of the queue.\n          for (let scan = 0, newLength = q.length - this.index; scan < newLength; scan++) {\n            q[scan] = q[scan + this.index];\n          }\n\n          q.length -= this.index;\n          this.index = 0;\n        }\n      }\n\n      q.length = 0;\n      this.index = 0;\n      this.flushing = false;\n    }; // In a web browser, exceptions are not fatal. However, to avoid\n    // slowing down the queue of pending tasks, we rethrow the error in a\n    // lower priority turn.\n\n\n    this.registerPendingError = err => {\n      this.pendingErrors.push(err);\n      this.requestErrorThrow();\n    }; // `requestFlush` requests that the high priority event queue be flushed as\n    // soon as possible.\n    // This is useful to prevent an error thrown in a task from stalling the event\n    // queue if the exception handled by Node.js’s\n    // `process.on(\"uncaughtException\")` or by a domain.\n    // `requestFlush` is implemented using a strategy based on data collected from\n    // every available SauceLabs Selenium web driver worker at time of writing.\n    // https://docs.google.com/spreadsheets/d/1mG-5UYGup5qxGdEMWkhP6BWCz053NUb2E1QoUTU16uA/edit#gid=783724593\n\n\n    this.requestFlush = makeRequestCall(this.flush);\n    this.requestErrorThrow = makeRequestCallFromTimer(() => {\n      // Throw first error\n      if (this.pendingErrors.length) {\n        throw this.pendingErrors.shift();\n      }\n    });\n  }\n\n} // The message channel technique was discovered by Malte Ubl and was the\n// original foundation for this library.\n// http://www.nonblocking.io/2011/06/windownexttick.html\n// Safari 6.0.5 (at least) intermittently fails to create message ports on a\n// page's first load. Thankfully, this version of Safari supports\n// MutationObservers, so we don't need to fall back in that case.\n// function makeRequestCallFromMessageChannel(callback) {\n//     var channel = new MessageChannel();\n//     channel.port1.onmessage = callback;\n//     return function requestCall() {\n//         channel.port2.postMessage(0);\n//     };\n// }\n// For reasons explained above, we are also unable to use `setImmediate`\n// under any circumstances.\n// Even if we were, there is another bug in Internet Explorer 10.\n// It is not sufficient to assign `setImmediate` to `requestFlush` because\n// `setImmediate` must be called *by name* and therefore must be wrapped in a\n// closure.\n// Never forget.\n// function makeRequestCallFromSetImmediate(callback) {\n//     return function requestCall() {\n//         setImmediate(callback);\n//     };\n// }\n// Safari 6.0 has a problem where timers will get lost while the user is\n// scrolling. This problem does not impact ASAP because Safari 6.0 supports\n// mutation observers, so that implementation is used instead.\n// However, if we ever elect to use timers in Safari, the prevalent work-around\n// is to add a scroll event listener that calls for a flush.\n// `setTimeout` does not call the passed callback if the delay is less than\n// approximately 7 in web workers in Firefox 8 through 18, and sometimes not\n// even then.\n// This is for `asap.js` only.\n// Its name will be periodically randomized to break any code that depends on\n// // its existence.\n// rawAsap.makeRequestCallFromTimer = makeRequestCallFromTimer\n// ASAP was originally a nextTick shim included in Q. This was factored out\n// into this ASAP package. It was later adapted to RSVP which made further\n// amendments. These decisions, particularly to marginalize MessageChannel and\n// to capture the MutationObserver implementation in a closure, were integrated\n// back into ASAP proper.\n// https://github.com/tildeio/rsvp.js/blob/cddf7232546a9cf858524b75cde6f9edf72620a7/lib/rsvp/asap.js\n\n// `call`, just like a function.\nclass RawTask {\n  call() {\n    try {\n      this.task && this.task();\n    } catch (error) {\n      this.onError(error);\n    } finally {\n      this.task = null;\n      this.release(this);\n    }\n  }\n\n  constructor(onError, release) {\n    this.onError = onError;\n    this.release = release;\n    this.task = null;\n  }\n\n}\n\nclass TaskFactory {\n  create(task) {\n    const tasks = this.freeTasks;\n    const t1 = tasks.length ? tasks.pop() : new RawTask(this.onError, t => tasks[tasks.length] = t);\n    t1.task = task;\n    return t1;\n  }\n\n  constructor(onError) {\n    this.onError = onError;\n    this.freeTasks = [];\n  }\n\n}\n\nconst asapQueue = new AsapQueue();\nconst taskFactory = new TaskFactory(asapQueue.registerPendingError);\n/**\n * Calls a task as soon as possible after returning, in its own event, with priority\n * over other events like animation, reflow, and repaint. An error thrown from an\n * event will not interrupt, nor even substantially slow down the processing of\n * other events, but will be rather postponed to a lower priority event.\n * @param {{call}} task A callable object, typically a function that takes no\n * arguments.\n */\n\nfunction asap(task) {\n  asapQueue.enqueueTask(taskFactory.create(task));\n}\n\nconst ADD_SOURCE = 'dnd-core/ADD_SOURCE';\nconst ADD_TARGET = 'dnd-core/ADD_TARGET';\nconst REMOVE_SOURCE = 'dnd-core/REMOVE_SOURCE';\nconst REMOVE_TARGET = 'dnd-core/REMOVE_TARGET';\nfunction addSource(sourceId) {\n  return {\n    type: ADD_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\nfunction addTarget(targetId) {\n  return {\n    type: ADD_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\nfunction removeSource(sourceId) {\n  return {\n    type: REMOVE_SOURCE,\n    payload: {\n      sourceId\n    }\n  };\n}\nfunction removeTarget(targetId) {\n  return {\n    type: REMOVE_TARGET,\n    payload: {\n      targetId\n    }\n  };\n}\n\nfunction validateSourceContract(source) {\n  invariant(typeof source.canDrag === 'function', 'Expected canDrag to be a function.');\n  invariant(typeof source.beginDrag === 'function', 'Expected beginDrag to be a function.');\n  invariant(typeof source.endDrag === 'function', 'Expected endDrag to be a function.');\n}\nfunction validateTargetContract(target) {\n  invariant(typeof target.canDrop === 'function', 'Expected canDrop to be a function.');\n  invariant(typeof target.hover === 'function', 'Expected hover to be a function.');\n  invariant(typeof target.drop === 'function', 'Expected beginDrag to be a function.');\n}\nfunction validateType(type, allowArray) {\n  if (allowArray && Array.isArray(type)) {\n    type.forEach(t => validateType(t, false));\n    return;\n  }\n\n  invariant(typeof type === 'string' || typeof type === 'symbol', allowArray ? 'Type can only be a string, a symbol, or an array of either.' : 'Type can only be a string or a symbol.');\n}\n\nvar HandlerRole;\n\n(function (HandlerRole) {\n  HandlerRole[\"SOURCE\"] = \"SOURCE\";\n  HandlerRole[\"TARGET\"] = \"TARGET\";\n})(HandlerRole || (HandlerRole = {}));\n\nlet nextUniqueId = 0;\nfunction getNextUniqueId() {\n  return nextUniqueId++;\n}\n\nfunction getNextHandlerId(role) {\n  const id = getNextUniqueId().toString();\n\n  switch (role) {\n    case HandlerRole.SOURCE:\n      return `S${id}`;\n\n    case HandlerRole.TARGET:\n      return `T${id}`;\n\n    default:\n      throw new Error(`Unknown Handler Role: ${role}`);\n  }\n}\n\nfunction parseRoleFromHandlerId(handlerId) {\n  switch (handlerId[0]) {\n    case 'S':\n      return HandlerRole.SOURCE;\n\n    case 'T':\n      return HandlerRole.TARGET;\n\n    default:\n      throw new Error(`Cannot parse handler ID: ${handlerId}`);\n  }\n}\n\nfunction mapContainsValue(map, searchValue) {\n  const entries = map.entries();\n  let isDone = false;\n\n  do {\n    const {\n      done,\n      value: [, value]\n    } = entries.next();\n\n    if (value === searchValue) {\n      return true;\n    }\n\n    isDone = !!done;\n  } while (!isDone);\n\n  return false;\n}\n\nclass HandlerRegistryImpl {\n  addSource(type, source) {\n    validateType(type);\n    validateSourceContract(source);\n    const sourceId = this.addHandler(HandlerRole.SOURCE, type, source);\n    this.store.dispatch(addSource(sourceId));\n    return sourceId;\n  }\n\n  addTarget(type, target) {\n    validateType(type, true);\n    validateTargetContract(target);\n    const targetId = this.addHandler(HandlerRole.TARGET, type, target);\n    this.store.dispatch(addTarget(targetId));\n    return targetId;\n  }\n\n  containsHandler(handler) {\n    return mapContainsValue(this.dragSources, handler) || mapContainsValue(this.dropTargets, handler);\n  }\n\n  getSource(sourceId, includePinned = false) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    const isPinned = includePinned && sourceId === this.pinnedSourceId;\n    const source = isPinned ? this.pinnedSource : this.dragSources.get(sourceId);\n    return source;\n  }\n\n  getTarget(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.dropTargets.get(targetId);\n  }\n\n  getSourceType(sourceId) {\n    invariant(this.isSourceId(sourceId), 'Expected a valid source ID.');\n    return this.types.get(sourceId);\n  }\n\n  getTargetType(targetId) {\n    invariant(this.isTargetId(targetId), 'Expected a valid target ID.');\n    return this.types.get(targetId);\n  }\n\n  isSourceId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.SOURCE;\n  }\n\n  isTargetId(handlerId) {\n    const role = parseRoleFromHandlerId(handlerId);\n    return role === HandlerRole.TARGET;\n  }\n\n  removeSource(sourceId) {\n    invariant(this.getSource(sourceId), 'Expected an existing source.');\n    this.store.dispatch(removeSource(sourceId));\n    asap(() => {\n      this.dragSources.delete(sourceId);\n      this.types.delete(sourceId);\n    });\n  }\n\n  removeTarget(targetId) {\n    invariant(this.getTarget(targetId), 'Expected an existing target.');\n    this.store.dispatch(removeTarget(targetId));\n    this.dropTargets.delete(targetId);\n    this.types.delete(targetId);\n  }\n\n  pinSource(sourceId) {\n    const source = this.getSource(sourceId);\n    invariant(source, 'Expected an existing source.');\n    this.pinnedSourceId = sourceId;\n    this.pinnedSource = source;\n  }\n\n  unpinSource() {\n    invariant(this.pinnedSource, 'No source is pinned at the time.');\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n  }\n\n  addHandler(role, type, handler) {\n    const id = getNextHandlerId(role);\n    this.types.set(id, type);\n\n    if (role === HandlerRole.SOURCE) {\n      this.dragSources.set(id, handler);\n    } else if (role === HandlerRole.TARGET) {\n      this.dropTargets.set(id, handler);\n    }\n\n    return id;\n  }\n\n  constructor(store) {\n    this.types = new Map();\n    this.dragSources = new Map();\n    this.dropTargets = new Map();\n    this.pinnedSourceId = null;\n    this.pinnedSource = null;\n    this.store = store;\n  }\n\n}\n\nconst strictEquality = (a, b) => a === b;\n/**\n * Determine if two cartesian coordinate offsets are equal\n * @param offsetA\n * @param offsetB\n */\n\nfunction areCoordsEqual(offsetA, offsetB) {\n  if (!offsetA && !offsetB) {\n    return true;\n  } else if (!offsetA || !offsetB) {\n    return false;\n  } else {\n    return offsetA.x === offsetB.x && offsetA.y === offsetB.y;\n  }\n}\n/**\n * Determines if two arrays of items are equal\n * @param a The first array of items\n * @param b The second array of items\n */\n\nfunction areArraysEqual(a, b, isEqual = strictEquality) {\n  if (a.length !== b.length) {\n    return false;\n  }\n\n  for (let i = 0; i < a.length; ++i) {\n    if (!isEqual(a[i], b[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction reduce$5( // eslint-disable-next-line @typescript-eslint/no-unused-vars\n_state = NONE, action) {\n  switch (action.type) {\n    case HOVER:\n      break;\n\n    case ADD_SOURCE:\n    case ADD_TARGET:\n    case REMOVE_TARGET:\n    case REMOVE_SOURCE:\n      return NONE;\n\n    case BEGIN_DRAG:\n    case PUBLISH_DRAG_SOURCE:\n    case END_DRAG:\n    case DROP:\n    default:\n      return ALL;\n  }\n\n  const {\n    targetIds = [],\n    prevTargetIds = []\n  } = action.payload;\n  const result = xor(targetIds, prevTargetIds);\n  const didChange = result.length > 0 || !areArraysEqual(targetIds, prevTargetIds);\n\n  if (!didChange) {\n    return NONE;\n  } // Check the target ids at the innermost position. If they are valid, add them\n  // to the result\n\n\n  const prevInnermostTargetId = prevTargetIds[prevTargetIds.length - 1];\n  const innermostTargetId = targetIds[targetIds.length - 1];\n\n  if (prevInnermostTargetId !== innermostTargetId) {\n    if (prevInnermostTargetId) {\n      result.push(prevInnermostTargetId);\n    }\n\n    if (innermostTargetId) {\n      result.push(innermostTargetId);\n    }\n  }\n\n  return result;\n}\n\nfunction _defineProperty$3(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$3(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$3(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nconst initialState$1 = {\n  initialSourceClientOffset: null,\n  initialClientOffset: null,\n  clientOffset: null\n};\nfunction reduce$4(state = initialState$1, action) {\n  const {\n    payload\n  } = action;\n\n  switch (action.type) {\n    case INIT_COORDS:\n    case BEGIN_DRAG:\n      return {\n        initialSourceClientOffset: payload.sourceClientOffset,\n        initialClientOffset: payload.clientOffset,\n        clientOffset: payload.clientOffset\n      };\n\n    case HOVER:\n      if (areCoordsEqual(state.clientOffset, payload.clientOffset)) {\n        return state;\n      }\n\n      return _objectSpread$3({}, state, {\n        clientOffset: payload.clientOffset\n      });\n\n    case END_DRAG:\n    case DROP:\n      return initialState$1;\n\n    default:\n      return state;\n  }\n}\n\nfunction _defineProperty$2(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$2(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$2(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nconst initialState = {\n  itemType: null,\n  item: null,\n  sourceId: null,\n  targetIds: [],\n  dropResult: null,\n  didDrop: false,\n  isSourcePublic: null\n};\nfunction reduce$3(state = initialState, action) {\n  const {\n    payload\n  } = action;\n\n  switch (action.type) {\n    case BEGIN_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: payload.itemType,\n        item: payload.item,\n        sourceId: payload.sourceId,\n        isSourcePublic: payload.isSourcePublic,\n        dropResult: null,\n        didDrop: false\n      });\n\n    case PUBLISH_DRAG_SOURCE:\n      return _objectSpread$2({}, state, {\n        isSourcePublic: true\n      });\n\n    case HOVER:\n      return _objectSpread$2({}, state, {\n        targetIds: payload.targetIds\n      });\n\n    case REMOVE_TARGET:\n      if (state.targetIds.indexOf(payload.targetId) === -1) {\n        return state;\n      }\n\n      return _objectSpread$2({}, state, {\n        targetIds: without$1(state.targetIds, payload.targetId)\n      });\n\n    case DROP:\n      return _objectSpread$2({}, state, {\n        dropResult: payload.dropResult,\n        didDrop: true,\n        targetIds: []\n      });\n\n    case END_DRAG:\n      return _objectSpread$2({}, state, {\n        itemType: null,\n        item: null,\n        sourceId: null,\n        dropResult: null,\n        didDrop: false,\n        isSourcePublic: null,\n        targetIds: []\n      });\n\n    default:\n      return state;\n  }\n}\n\nfunction reduce$2(state = 0, action) {\n  switch (action.type) {\n    case ADD_SOURCE:\n    case ADD_TARGET:\n      return state + 1;\n\n    case REMOVE_SOURCE:\n    case REMOVE_TARGET:\n      return state - 1;\n\n    default:\n      return state;\n  }\n}\n\nfunction reduce$1(state = 0) {\n  return state + 1;\n}\n\nfunction _defineProperty$1(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread$1(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty$1(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nfunction reduce(state = {}, action) {\n  return {\n    dirtyHandlerIds: reduce$5(state.dirtyHandlerIds, {\n      type: action.type,\n      payload: _objectSpread$1({}, action.payload, {\n        prevTargetIds: get(state, 'dragOperation.targetIds', [])\n      })\n    }),\n    dragOffset: reduce$4(state.dragOffset, action),\n    refCount: reduce$2(state.refCount, action),\n    dragOperation: reduce$3(state.dragOperation, action),\n    stateId: reduce$1(state.stateId)\n  };\n}\n\nfunction createDragDropManager(backendFactory, globalContext = undefined, backendOptions = {}, debugMode = false) {\n  const store = makeStoreInstance(debugMode);\n  const monitor = new DragDropMonitorImpl(store, new HandlerRegistryImpl(store));\n  const manager = new DragDropManagerImpl(store, monitor);\n  const backend = backendFactory(manager, globalContext, backendOptions);\n  manager.receiveBackend(backend);\n  return manager;\n}\n\nfunction makeStoreInstance(debugMode) {\n  // TODO: if we ever make a react-native version of this,\n  // we'll need to consider how to pull off dev-tooling\n  const reduxDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__;\n  return createStore(reduce, debugMode && reduxDevTools && reduxDevTools({\n    name: 'dnd-core',\n    instanceId: 'dnd-core'\n  }));\n}\n\nfunction _objectWithoutProperties(source, excluded) {\n  if (source == null) return {};\n\n  var target = _objectWithoutPropertiesLoose(source, excluded);\n\n  var key, i;\n\n  if (Object.getOwnPropertySymbols) {\n    var sourceSymbolKeys = Object.getOwnPropertySymbols(source);\n\n    for (i = 0; i < sourceSymbolKeys.length; i++) {\n      key = sourceSymbolKeys[i];\n      if (excluded.indexOf(key) >= 0) continue;\n      if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue;\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\nfunction _objectWithoutPropertiesLoose(source, excluded) {\n  if (source == null) return {};\n  var target = {};\n  var sourceKeys = Object.keys(source);\n  var key, i;\n\n  for (i = 0; i < sourceKeys.length; i++) {\n    key = sourceKeys[i];\n    if (excluded.indexOf(key) >= 0) continue;\n    target[key] = source[key];\n  }\n\n  return target;\n}\nlet refCount = 0;\nconst INSTANCE_SYM = Symbol.for('__REACT_DND_CONTEXT_INSTANCE__');\nvar DndProvider = /*#__PURE__*/memo(function DndProvider(_param) {\n  var {\n    children\n  } = _param,\n      props = _objectWithoutProperties(_param, [\"children\"]);\n\n  const [manager, isGlobalInstance] = getDndContextValue(props) // memoized from props\n  ;\n  /**\n  * If the global context was used to store the DND context\n  * then where theres no more references to it we should\n  * clean it up to avoid memory leaks\n  */\n\n  useEffect(() => {\n    if (isGlobalInstance) {\n      const context = getGlobalContext();\n      ++refCount;\n      return () => {\n        if (--refCount === 0) {\n          context[INSTANCE_SYM] = null;\n        }\n      };\n    }\n\n    return;\n  }, []);\n  return /*#__PURE__*/jsx(DndContext.Provider, {\n    value: manager,\n    children: children\n  });\n});\n\nfunction getDndContextValue(props) {\n  if ('manager' in props) {\n    const manager = {\n      dragDropManager: props.manager\n    };\n    return [manager, false];\n  }\n\n  const manager = createSingletonDndContext(props.backend, props.context, props.options, props.debugMode);\n  const isGlobalInstance = !props.context;\n  return [manager, isGlobalInstance];\n}\n\nfunction createSingletonDndContext(backend, context = getGlobalContext(), options, debugMode) {\n  const ctx = context;\n\n  if (!ctx[INSTANCE_SYM]) {\n    ctx[INSTANCE_SYM] = {\n      dragDropManager: createDragDropManager(backend, context, options, debugMode)\n    };\n  }\n\n  return ctx[INSTANCE_SYM];\n}\n\nfunction getGlobalContext() {\n  return typeof global !== 'undefined' ? global : window;\n}\n\nvar fastDeepEqual = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n    var length, i, keys;\n\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n\n      for (i = length; i-- !== 0;) if (!equal(a[i], b[i])) return false;\n\n      return true;\n    }\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;) if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  } // true if both NaN, false otherwise\n\n\n  return a !== a && b !== b;\n};\n\nconst useIsomorphicLayoutEffect = typeof window !== 'undefined' ? useLayoutEffect : useEffect;\n\n/**\n *\n * @param monitor The monitor to collect state from\n * @param collect The collecting function\n * @param onUpdate A method to invoke when updates occur\n */\n\nfunction useCollector(monitor, collect, onUpdate) {\n  const [collected, setCollected] = useState(() => collect(monitor));\n  const updateCollected = useCallback(() => {\n    const nextValue = collect(monitor); // This needs to be a deep-equality check because some monitor-collected values\n    // include XYCoord objects that may be equivalent, but do not have instance equality.\n\n    if (!fastDeepEqual(collected, nextValue)) {\n      setCollected(nextValue);\n\n      if (onUpdate) {\n        onUpdate();\n      }\n    }\n  }, [collected, monitor, onUpdate]); // update the collected properties after react renders.\n  // Note that the \"Dustbin Stress Test\" fails if this is not\n  // done when the component updates\n\n  useIsomorphicLayoutEffect(updateCollected);\n  return [collected, updateCollected];\n}\n\nfunction useMonitorOutput(monitor, collect, onCollect) {\n  const [collected, updateCollected] = useCollector(monitor, collect, onCollect);\n  useIsomorphicLayoutEffect(function subscribeToMonitorStateChange() {\n    const handlerId = monitor.getHandlerId();\n\n    if (handlerId == null) {\n      return;\n    }\n\n    return monitor.subscribeToStateChange(updateCollected, {\n      handlerIds: [handlerId]\n    });\n  }, [monitor, updateCollected]);\n  return collected;\n}\n\nfunction useCollectedProps(collector, monitor, connector) {\n  return useMonitorOutput(monitor, collector || (() => ({})), () => connector.reconnect());\n}\n\nfunction useOptionalFactory(arg, deps) {\n  const memoDeps = [...(deps || [])];\n\n  if (deps == null && typeof arg !== 'function') {\n    memoDeps.push(arg);\n  }\n\n  return useMemo(() => {\n    return typeof arg === 'function' ? arg() : arg;\n  }, memoDeps);\n}\n\nfunction useConnectDragSource(connector) {\n  return useMemo(() => connector.hooks.dragSource(), [connector]);\n}\nfunction useConnectDragPreview(connector) {\n  return useMemo(() => connector.hooks.dragPreview(), [connector]);\n}\n\nlet isCallingCanDrag = false;\nlet isCallingIsDragging = false;\nclass DragSourceMonitorImpl {\n  receiveHandlerId(sourceId) {\n    this.sourceId = sourceId;\n  }\n\n  getHandlerId() {\n    return this.sourceId;\n  }\n\n  canDrag() {\n    invariant(!isCallingCanDrag, 'You may not call monitor.canDrag() inside your canDrag() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n\n    try {\n      isCallingCanDrag = true;\n      return this.internalMonitor.canDragSource(this.sourceId);\n    } finally {\n      isCallingCanDrag = false;\n    }\n  }\n\n  isDragging() {\n    if (!this.sourceId) {\n      return false;\n    }\n\n    invariant(!isCallingIsDragging, 'You may not call monitor.isDragging() inside your isDragging() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drag-source-monitor');\n\n    try {\n      isCallingIsDragging = true;\n      return this.internalMonitor.isDraggingSource(this.sourceId);\n    } finally {\n      isCallingIsDragging = false;\n    }\n  }\n\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n\n  isDraggingSource(sourceId) {\n    return this.internalMonitor.isDraggingSource(sourceId);\n  }\n\n  isOverTarget(targetId, options) {\n    return this.internalMonitor.isOverTarget(targetId, options);\n  }\n\n  getTargetIds() {\n    return this.internalMonitor.getTargetIds();\n  }\n\n  isSourcePublic() {\n    return this.internalMonitor.isSourcePublic();\n  }\n\n  getSourceId() {\n    return this.internalMonitor.getSourceId();\n  }\n\n  subscribeToOffsetChange(listener) {\n    return this.internalMonitor.subscribeToOffsetChange(listener);\n  }\n\n  canDragSource(sourceId) {\n    return this.internalMonitor.canDragSource(sourceId);\n  }\n\n  canDropOnTarget(targetId) {\n    return this.internalMonitor.canDropOnTarget(targetId);\n  }\n\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n\n  constructor(manager) {\n    this.sourceId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n\n}\n\nlet isCallingCanDrop = false;\nclass DropTargetMonitorImpl {\n  receiveHandlerId(targetId) {\n    this.targetId = targetId;\n  }\n\n  getHandlerId() {\n    return this.targetId;\n  }\n\n  subscribeToStateChange(listener, options) {\n    return this.internalMonitor.subscribeToStateChange(listener, options);\n  }\n\n  canDrop() {\n    // Cut out early if the target id has not been set. This should prevent errors\n    // where the user has an older version of dnd-core like in\n    // https://github.com/react-dnd/react-dnd/issues/1310\n    if (!this.targetId) {\n      return false;\n    }\n\n    invariant(!isCallingCanDrop, 'You may not call monitor.canDrop() inside your canDrop() implementation. ' + 'Read more: http://react-dnd.github.io/react-dnd/docs/api/drop-target-monitor');\n\n    try {\n      isCallingCanDrop = true;\n      return this.internalMonitor.canDropOnTarget(this.targetId);\n    } finally {\n      isCallingCanDrop = false;\n    }\n  }\n\n  isOver(options) {\n    if (!this.targetId) {\n      return false;\n    }\n\n    return this.internalMonitor.isOverTarget(this.targetId, options);\n  }\n\n  getItemType() {\n    return this.internalMonitor.getItemType();\n  }\n\n  getItem() {\n    return this.internalMonitor.getItem();\n  }\n\n  getDropResult() {\n    return this.internalMonitor.getDropResult();\n  }\n\n  didDrop() {\n    return this.internalMonitor.didDrop();\n  }\n\n  getInitialClientOffset() {\n    return this.internalMonitor.getInitialClientOffset();\n  }\n\n  getInitialSourceClientOffset() {\n    return this.internalMonitor.getInitialSourceClientOffset();\n  }\n\n  getSourceClientOffset() {\n    return this.internalMonitor.getSourceClientOffset();\n  }\n\n  getClientOffset() {\n    return this.internalMonitor.getClientOffset();\n  }\n\n  getDifferenceFromInitialOffset() {\n    return this.internalMonitor.getDifferenceFromInitialOffset();\n  }\n\n  constructor(manager) {\n    this.targetId = null;\n    this.internalMonitor = manager.getMonitor();\n  }\n\n}\n\nfunction registerTarget(type, target, manager) {\n  const registry = manager.getRegistry();\n  const targetId = registry.addTarget(type, target);\n  return [targetId, () => registry.removeTarget(targetId)];\n}\nfunction registerSource(type, source, manager) {\n  const registry = manager.getRegistry();\n  const sourceId = registry.addSource(type, source);\n  return [sourceId, () => registry.removeSource(sourceId)];\n}\n\nfunction shallowEqual(objA, objB, compare, compareContext) {\n  let compareResult = compare ? compare.call(compareContext, objA, objB) : void 0;\n\n  if (compareResult !== void 0) {\n    return !!compareResult;\n  }\n\n  if (objA === objB) {\n    return true;\n  }\n\n  if (typeof objA !== 'object' || !objA || typeof objB !== 'object' || !objB) {\n    return false;\n  }\n\n  const keysA = Object.keys(objA);\n  const keysB = Object.keys(objB);\n\n  if (keysA.length !== keysB.length) {\n    return false;\n  }\n\n  const bHasOwnProperty = Object.prototype.hasOwnProperty.bind(objB); // Test for A's keys different from B.\n\n  for (let idx = 0; idx < keysA.length; idx++) {\n    const key = keysA[idx];\n\n    if (!bHasOwnProperty(key)) {\n      return false;\n    }\n\n    const valueA = objA[key];\n    const valueB = objB[key];\n    compareResult = compare ? compare.call(compareContext, valueA, valueB, key) : void 0;\n\n    if (compareResult === false || compareResult === void 0 && valueA !== valueB) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isRef(obj) {\n  return (// eslint-disable-next-line no-prototype-builtins\n    obj !== null && typeof obj === 'object' && Object.prototype.hasOwnProperty.call(obj, 'current')\n  );\n}\n\nfunction throwIfCompositeComponentElement(element) {\n  // Custom components can no longer be wrapped directly in React DnD 2.0\n  // so that we don't need to depend on findDOMNode() from react-dom.\n  if (typeof element.type === 'string') {\n    return;\n  }\n\n  const displayName = element.type.displayName || element.type.name || 'the component';\n  throw new Error('Only native element nodes can now be passed to React DnD connectors.' + `You can either wrap ${displayName} into a <div>, or turn it into a ` + 'drag source or a drop target itself.');\n}\n\nfunction wrapHookToRecognizeElement(hook) {\n  return (elementOrNode = null, options = null) => {\n    // When passed a node, call the hook straight away.\n    if (! /*#__PURE__*/isValidElement(elementOrNode)) {\n      const node = elementOrNode;\n      hook(node, options); // return the node so it can be chained (e.g. when within callback refs\n      // <div ref={node => connectDragSource(connectDropTarget(node))}/>\n\n      return node;\n    } // If passed a ReactElement, clone it and attach this function as a ref.\n    // This helps us achieve a neat API where user doesn't even know that refs\n    // are being used under the hood.\n\n\n    const element = elementOrNode;\n    throwIfCompositeComponentElement(element); // When no options are passed, use the hook directly\n\n    const ref = options ? node => hook(node, options) : hook;\n    return cloneWithRef(element, ref);\n  };\n}\n\nfunction wrapConnectorHooks(hooks) {\n  const wrappedHooks = {};\n  Object.keys(hooks).forEach(key => {\n    const hook = hooks[key]; // ref objects should be passed straight through without wrapping\n\n    if (key.endsWith('Ref')) {\n      wrappedHooks[key] = hooks[key];\n    } else {\n      const wrappedHook = wrapHookToRecognizeElement(hook);\n\n      wrappedHooks[key] = () => wrappedHook;\n    }\n  });\n  return wrappedHooks;\n}\n\nfunction setRef(ref, node) {\n  if (typeof ref === 'function') {\n    ref(node);\n  } else {\n    ref.current = node;\n  }\n}\n\nfunction cloneWithRef(element, newRef) {\n  const previousRef = element.ref;\n  invariant(typeof previousRef !== 'string', 'Cannot connect React DnD to an element with an existing string ref. ' + 'Please convert it to use a callback ref instead, or wrap it into a <span> or <div>. ' + 'Read more: https://reactjs.org/docs/refs-and-the-dom.html#callback-refs');\n\n  if (!previousRef) {\n    // When there is no ref on the element, use the new ref directly\n    return /*#__PURE__*/cloneElement(element, {\n      ref: newRef\n    });\n  } else {\n    return /*#__PURE__*/cloneElement(element, {\n      ref: node => {\n        setRef(previousRef, node);\n        setRef(newRef, node);\n      }\n    });\n  }\n}\n\nclass SourceConnector {\n  receiveHandlerId(newHandlerId) {\n    if (this.handlerId === newHandlerId) {\n      return;\n    }\n\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n\n  get connectTarget() {\n    return this.dragSource;\n  }\n\n  get dragSourceOptions() {\n    return this.dragSourceOptionsInternal;\n  }\n\n  set dragSourceOptions(options) {\n    this.dragSourceOptionsInternal = options;\n  }\n\n  get dragPreviewOptions() {\n    return this.dragPreviewOptionsInternal;\n  }\n\n  set dragPreviewOptions(options) {\n    this.dragPreviewOptionsInternal = options;\n  }\n\n  reconnect() {\n    const didChange = this.reconnectDragSource();\n    this.reconnectDragPreview(didChange);\n  }\n\n  reconnectDragSource() {\n    const dragSource = this.dragSource; // if nothing has changed then don't resubscribe\n\n    const didChange = this.didHandlerIdChange() || this.didConnectedDragSourceChange() || this.didDragSourceOptionsChange();\n\n    if (didChange) {\n      this.disconnectDragSource();\n    }\n\n    if (!this.handlerId) {\n      return didChange;\n    }\n\n    if (!dragSource) {\n      this.lastConnectedDragSource = dragSource;\n      return didChange;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragSource = dragSource;\n      this.lastConnectedDragSourceOptions = this.dragSourceOptions;\n      this.dragSourceUnsubscribe = this.backend.connectDragSource(this.handlerId, dragSource, this.dragSourceOptions);\n    }\n\n    return didChange;\n  }\n\n  reconnectDragPreview(forceDidChange = false) {\n    const dragPreview = this.dragPreview; // if nothing has changed then don't resubscribe\n\n    const didChange = forceDidChange || this.didHandlerIdChange() || this.didConnectedDragPreviewChange() || this.didDragPreviewOptionsChange();\n\n    if (didChange) {\n      this.disconnectDragPreview();\n    }\n\n    if (!this.handlerId) {\n      return;\n    }\n\n    if (!dragPreview) {\n      this.lastConnectedDragPreview = dragPreview;\n      return;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDragPreview = dragPreview;\n      this.lastConnectedDragPreviewOptions = this.dragPreviewOptions;\n      this.dragPreviewUnsubscribe = this.backend.connectDragPreview(this.handlerId, dragPreview, this.dragPreviewOptions);\n    }\n  }\n\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n\n  didConnectedDragSourceChange() {\n    return this.lastConnectedDragSource !== this.dragSource;\n  }\n\n  didConnectedDragPreviewChange() {\n    return this.lastConnectedDragPreview !== this.dragPreview;\n  }\n\n  didDragSourceOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragSourceOptions, this.dragSourceOptions);\n  }\n\n  didDragPreviewOptionsChange() {\n    return !shallowEqual(this.lastConnectedDragPreviewOptions, this.dragPreviewOptions);\n  }\n\n  disconnectDragSource() {\n    if (this.dragSourceUnsubscribe) {\n      this.dragSourceUnsubscribe();\n      this.dragSourceUnsubscribe = undefined;\n    }\n  }\n\n  disconnectDragPreview() {\n    if (this.dragPreviewUnsubscribe) {\n      this.dragPreviewUnsubscribe();\n      this.dragPreviewUnsubscribe = undefined;\n      this.dragPreviewNode = null;\n      this.dragPreviewRef = null;\n    }\n  }\n\n  get dragSource() {\n    return this.dragSourceNode || this.dragSourceRef && this.dragSourceRef.current;\n  }\n\n  get dragPreview() {\n    return this.dragPreviewNode || this.dragPreviewRef && this.dragPreviewRef.current;\n  }\n\n  clearDragSource() {\n    this.dragSourceNode = null;\n    this.dragSourceRef = null;\n  }\n\n  clearDragPreview() {\n    this.dragPreviewNode = null;\n    this.dragPreviewRef = null;\n  }\n\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dragSource: (node, options) => {\n        this.clearDragSource();\n        this.dragSourceOptions = options || null;\n\n        if (isRef(node)) {\n          this.dragSourceRef = node;\n        } else {\n          this.dragSourceNode = node;\n        }\n\n        this.reconnectDragSource();\n      },\n      dragPreview: (node, options) => {\n        this.clearDragPreview();\n        this.dragPreviewOptions = options || null;\n\n        if (isRef(node)) {\n          this.dragPreviewRef = node;\n        } else {\n          this.dragPreviewNode = node;\n        }\n\n        this.reconnectDragPreview();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dragSourceRef = null;\n    this.dragSourceOptionsInternal = null; // The drag preview may either be attached via ref or connect function\n\n    this.dragPreviewRef = null;\n    this.dragPreviewOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDragSource = null;\n    this.lastConnectedDragSourceOptions = null;\n    this.lastConnectedDragPreview = null;\n    this.lastConnectedDragPreviewOptions = null;\n    this.backend = backend;\n  }\n\n}\n\nclass TargetConnector {\n  get connectTarget() {\n    return this.dropTarget;\n  }\n\n  reconnect() {\n    // if nothing has changed then don't resubscribe\n    const didChange = this.didHandlerIdChange() || this.didDropTargetChange() || this.didOptionsChange();\n\n    if (didChange) {\n      this.disconnectDropTarget();\n    }\n\n    const dropTarget = this.dropTarget;\n\n    if (!this.handlerId) {\n      return;\n    }\n\n    if (!dropTarget) {\n      this.lastConnectedDropTarget = dropTarget;\n      return;\n    }\n\n    if (didChange) {\n      this.lastConnectedHandlerId = this.handlerId;\n      this.lastConnectedDropTarget = dropTarget;\n      this.lastConnectedDropTargetOptions = this.dropTargetOptions;\n      this.unsubscribeDropTarget = this.backend.connectDropTarget(this.handlerId, dropTarget, this.dropTargetOptions);\n    }\n  }\n\n  receiveHandlerId(newHandlerId) {\n    if (newHandlerId === this.handlerId) {\n      return;\n    }\n\n    this.handlerId = newHandlerId;\n    this.reconnect();\n  }\n\n  get dropTargetOptions() {\n    return this.dropTargetOptionsInternal;\n  }\n\n  set dropTargetOptions(options) {\n    this.dropTargetOptionsInternal = options;\n  }\n\n  didHandlerIdChange() {\n    return this.lastConnectedHandlerId !== this.handlerId;\n  }\n\n  didDropTargetChange() {\n    return this.lastConnectedDropTarget !== this.dropTarget;\n  }\n\n  didOptionsChange() {\n    return !shallowEqual(this.lastConnectedDropTargetOptions, this.dropTargetOptions);\n  }\n\n  disconnectDropTarget() {\n    if (this.unsubscribeDropTarget) {\n      this.unsubscribeDropTarget();\n      this.unsubscribeDropTarget = undefined;\n    }\n  }\n\n  get dropTarget() {\n    return this.dropTargetNode || this.dropTargetRef && this.dropTargetRef.current;\n  }\n\n  clearDropTarget() {\n    this.dropTargetRef = null;\n    this.dropTargetNode = null;\n  }\n\n  constructor(backend) {\n    this.hooks = wrapConnectorHooks({\n      dropTarget: (node, options) => {\n        this.clearDropTarget();\n        this.dropTargetOptions = options;\n\n        if (isRef(node)) {\n          this.dropTargetRef = node;\n        } else {\n          this.dropTargetNode = node;\n        }\n\n        this.reconnect();\n      }\n    });\n    this.handlerId = null; // The drop target may either be attached via ref or connect function\n\n    this.dropTargetRef = null;\n    this.dropTargetOptionsInternal = null;\n    this.lastConnectedHandlerId = null;\n    this.lastConnectedDropTarget = null;\n    this.lastConnectedDropTargetOptions = null;\n    this.backend = backend;\n  }\n\n}\n\n/**\n * A hook to retrieve the DragDropManager from Context\n */\n\nfunction useDragDropManager() {\n  const {\n    dragDropManager\n  } = useContext(DndContext);\n  invariant(dragDropManager != null, 'Expected drag drop context');\n  return dragDropManager;\n}\n\nfunction useDragSourceConnector(dragSourceOptions, dragPreviewOptions) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new SourceConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragSourceOptions = dragSourceOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragSource();\n  }, [connector, dragSourceOptions]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dragPreviewOptions = dragPreviewOptions || null;\n    connector.reconnect();\n    return () => connector.disconnectDragPreview();\n  }, [connector, dragPreviewOptions]);\n  return connector;\n}\n\nfunction useDragSourceMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DragSourceMonitorImpl(manager), [manager]);\n}\n\nclass DragSourceImpl {\n  beginDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    let result = null;\n\n    if (typeof spec.item === 'object') {\n      result = spec.item;\n    } else if (typeof spec.item === 'function') {\n      result = spec.item(monitor);\n    } else {\n      result = {};\n    }\n\n    return result !== null && result !== void 0 ? result : null;\n  }\n\n  canDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (typeof spec.canDrag === 'boolean') {\n      return spec.canDrag;\n    } else if (typeof spec.canDrag === 'function') {\n      return spec.canDrag(monitor);\n    } else {\n      return true;\n    }\n  }\n\n  isDragging(globalMonitor, target) {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const {\n      isDragging\n    } = spec;\n    return isDragging ? isDragging(monitor) : target === globalMonitor.getSourceId();\n  }\n\n  endDrag() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    const connector = this.connector;\n    const {\n      end\n    } = spec;\n\n    if (end) {\n      end(monitor.getItem(), monitor);\n    }\n\n    connector.reconnect();\n  }\n\n  constructor(spec, monitor, connector) {\n    this.spec = spec;\n    this.monitor = monitor;\n    this.connector = connector;\n  }\n\n}\n\nfunction useDragSource(spec, monitor, connector) {\n  const handler = useMemo(() => new DragSourceImpl(spec, monitor, connector), [monitor, connector]);\n  useEffect(() => {\n    handler.spec = spec;\n  }, [spec]);\n  return handler;\n}\n\nfunction useDragType(spec) {\n  return useMemo(() => {\n    const result = spec.type;\n    invariant(result != null, 'spec.type must be defined');\n    return result;\n  }, [spec]);\n}\n\nfunction useRegisteredDragSource(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const handler = useDragSource(spec, monitor, connector);\n  const itemType = useDragType(spec);\n  useIsomorphicLayoutEffect(function registerDragSource() {\n    if (itemType != null) {\n      const [handlerId, unregister] = registerSource(itemType, handler, manager);\n      monitor.receiveHandlerId(handlerId);\n      connector.receiveHandlerId(handlerId);\n      return unregister;\n    }\n\n    return;\n  }, [manager, monitor, connector, handler, itemType]);\n}\n\n/**\n * useDragSource hook\n * @param sourceSpec The drag source specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\nfunction useDrag(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  invariant(!spec.begin, `useDrag::spec.begin was deprecated in v14. Replace spec.begin() with spec.item(). (see more here - https://react-dnd.github.io/react-dnd/docs/api/use-drag)`);\n  const monitor = useDragSourceMonitor();\n  const connector = useDragSourceConnector(spec.options, spec.previewOptions);\n  useRegisteredDragSource(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDragSource(connector), useConnectDragPreview(connector)];\n}\n\n/**\n * useDragLayer Hook\n * @param collector The property collector\n */\n\nfunction useDragLayer(collect) {\n  const dragDropManager = useDragDropManager();\n  const monitor = dragDropManager.getMonitor();\n  const [collected, updateCollected] = useCollector(monitor, collect);\n  useEffect(() => monitor.subscribeToOffsetChange(updateCollected));\n  useEffect(() => monitor.subscribeToStateChange(updateCollected));\n  return collected;\n}\n\nfunction useConnectDropTarget(connector) {\n  return useMemo(() => connector.hooks.dropTarget(), [connector]);\n}\n\nfunction useDropTargetConnector(options) {\n  const manager = useDragDropManager();\n  const connector = useMemo(() => new TargetConnector(manager.getBackend()), [manager]);\n  useIsomorphicLayoutEffect(() => {\n    connector.dropTargetOptions = options || null;\n    connector.reconnect();\n    return () => connector.disconnectDropTarget();\n  }, [options]);\n  return connector;\n}\n\nfunction useDropTargetMonitor() {\n  const manager = useDragDropManager();\n  return useMemo(() => new DropTargetMonitorImpl(manager), [manager]);\n}\n\n/**\n * Internal utility hook to get an array-version of spec.accept.\n * The main utility here is that we aren't creating a new array on every render if a non-array spec.accept is passed in.\n * @param spec\n */\n\nfunction useAccept(spec) {\n  const {\n    accept\n  } = spec;\n  return useMemo(() => {\n    invariant(spec.accept != null, 'accept must be defined');\n    return Array.isArray(accept) ? accept : [accept];\n  }, [accept]);\n}\n\nclass DropTargetImpl {\n  canDrop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n    return spec.canDrop ? spec.canDrop(monitor.getItem(), monitor) : true;\n  }\n\n  hover() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (spec.hover) {\n      spec.hover(monitor.getItem(), monitor);\n    }\n  }\n\n  drop() {\n    const spec = this.spec;\n    const monitor = this.monitor;\n\n    if (spec.drop) {\n      return spec.drop(monitor.getItem(), monitor);\n    }\n\n    return;\n  }\n\n  constructor(spec, monitor) {\n    this.spec = spec;\n    this.monitor = monitor;\n  }\n\n}\n\nfunction useDropTarget(spec, monitor) {\n  const dropTarget = useMemo(() => new DropTargetImpl(spec, monitor), [monitor]);\n  useEffect(() => {\n    dropTarget.spec = spec;\n  }, [spec]);\n  return dropTarget;\n}\n\nfunction useRegisteredDropTarget(spec, monitor, connector) {\n  const manager = useDragDropManager();\n  const dropTarget = useDropTarget(spec, monitor);\n  const accept = useAccept(spec);\n  useIsomorphicLayoutEffect(function registerDropTarget() {\n    const [handlerId, unregister] = registerTarget(accept, dropTarget, manager);\n    monitor.receiveHandlerId(handlerId);\n    connector.receiveHandlerId(handlerId);\n    return unregister;\n  }, [manager, monitor, dropTarget, connector, accept.map(a => a.toString()).join('|')]);\n}\n\n/**\n * useDropTarget Hook\n * @param spec The drop target specification (object or function, function preferred)\n * @param deps The memoization deps array to use when evaluating spec changes\n */\n\nfunction useDrop(specArg, deps) {\n  const spec = useOptionalFactory(specArg, deps);\n  const monitor = useDropTargetMonitor();\n  const connector = useDropTargetConnector(spec.options);\n  useRegisteredDropTarget(spec, monitor, connector);\n  return [useCollectedProps(spec.collect, monitor, connector), useConnectDropTarget(connector)];\n}\n\n// cheap lodash replacements\nfunction memoize(fn) {\n  let result = null;\n\n  const memoized = () => {\n    if (result == null) {\n      result = fn();\n    }\n\n    return result;\n  };\n\n  return memoized;\n}\n/**\n * drop-in replacement for _.without\n */\n\nfunction without(items, item) {\n  return items.filter(i => i !== item);\n}\nfunction union(itemsA, itemsB) {\n  const set = new Set();\n\n  const insertItem = item => set.add(item);\n\n  itemsA.forEach(insertItem);\n  itemsB.forEach(insertItem);\n  const result = [];\n  set.forEach(key => result.push(key));\n  return result;\n}\n\nclass EnterLeaveCounter {\n  enter(enteringNode) {\n    const previousLength = this.entered.length;\n\n    const isNodeEntered = node => this.isNodeInDocument(node) && (!node.contains || node.contains(enteringNode));\n\n    this.entered = union(this.entered.filter(isNodeEntered), [enteringNode]);\n    return previousLength === 0 && this.entered.length > 0;\n  }\n\n  leave(leavingNode) {\n    const previousLength = this.entered.length;\n    this.entered = without(this.entered.filter(this.isNodeInDocument), leavingNode);\n    return previousLength > 0 && this.entered.length === 0;\n  }\n\n  reset() {\n    this.entered = [];\n  }\n\n  constructor(isNodeInDocument) {\n    this.entered = [];\n    this.isNodeInDocument = isNodeInDocument;\n  }\n\n}\n\nclass NativeDragSource {\n  initializeExposedProperties() {\n    Object.keys(this.config.exposeProperties).forEach(property => {\n      Object.defineProperty(this.item, property, {\n        configurable: true,\n        enumerable: true,\n\n        get() {\n          // eslint-disable-next-line no-console\n          console.warn(`Browser doesn't allow reading \"${property}\" until the drop event.`);\n          return null;\n        }\n\n      });\n    });\n  }\n\n  loadDataTransfer(dataTransfer) {\n    if (dataTransfer) {\n      const newProperties = {};\n      Object.keys(this.config.exposeProperties).forEach(property => {\n        const propertyFn = this.config.exposeProperties[property];\n\n        if (propertyFn != null) {\n          newProperties[property] = {\n            value: propertyFn(dataTransfer, this.config.matchesTypes),\n            configurable: true,\n            enumerable: true\n          };\n        }\n      });\n      Object.defineProperties(this.item, newProperties);\n    }\n  }\n\n  canDrag() {\n    return true;\n  }\n\n  beginDrag() {\n    return this.item;\n  }\n\n  isDragging(monitor, handle) {\n    return handle === monitor.getSourceId();\n  }\n\n  endDrag() {// empty\n  }\n\n  constructor(config) {\n    this.config = config;\n    this.item = {};\n    this.initializeExposedProperties();\n  }\n\n}\n\nconst FILE = '__NATIVE_FILE__';\nconst URL = '__NATIVE_URL__';\nconst TEXT = '__NATIVE_TEXT__';\nconst HTML = '__NATIVE_HTML__';\n\nvar NativeTypes = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    FILE: FILE,\n    URL: URL,\n    TEXT: TEXT,\n    HTML: HTML\n});\n\nfunction getDataFromDataTransfer(dataTransfer, typesToTry, defaultValue) {\n  const result = typesToTry.reduce((resultSoFar, typeToTry) => resultSoFar || dataTransfer.getData(typeToTry), '');\n  return result != null ? result : defaultValue;\n}\n\nconst nativeTypesConfig = {\n  [FILE]: {\n    exposeProperties: {\n      files: dataTransfer => Array.prototype.slice.call(dataTransfer.files),\n      items: dataTransfer => dataTransfer.items,\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Files']\n  },\n  [HTML]: {\n    exposeProperties: {\n      html: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Html', 'text/html']\n  },\n  [URL]: {\n    exposeProperties: {\n      urls: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, '').split('\\n'),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Url', 'text/uri-list']\n  },\n  [TEXT]: {\n    exposeProperties: {\n      text: (dataTransfer, matchesTypes) => getDataFromDataTransfer(dataTransfer, matchesTypes, ''),\n      dataTransfer: dataTransfer => dataTransfer\n    },\n    matchesTypes: ['Text', 'text/plain']\n  }\n};\n\nfunction createNativeDragSource(type, dataTransfer) {\n  const config = nativeTypesConfig[type];\n\n  if (!config) {\n    throw new Error(`native type ${type} has no configuration`);\n  }\n\n  const result = new NativeDragSource(config);\n  result.loadDataTransfer(dataTransfer);\n  return result;\n}\nfunction matchNativeItemType(dataTransfer) {\n  if (!dataTransfer) {\n    return null;\n  }\n\n  const dataTransferTypes = Array.prototype.slice.call(dataTransfer.types || []);\n  return Object.keys(nativeTypesConfig).filter(nativeItemType => {\n    const typeConfig = nativeTypesConfig[nativeItemType];\n\n    if (!(typeConfig === null || typeConfig === void 0 ? void 0 : typeConfig.matchesTypes)) {\n      return false;\n    }\n\n    return typeConfig.matchesTypes.some(t => dataTransferTypes.indexOf(t) > -1);\n  })[0] || null;\n}\n\nconst isFirefox = memoize(() => /firefox/i.test(navigator.userAgent));\nconst isSafari = memoize(() => Boolean(window.safari));\n\nclass MonotonicInterpolant {\n  interpolate(x) {\n    const {\n      xs,\n      ys,\n      c1s,\n      c2s,\n      c3s\n    } = this; // The rightmost point in the dataset should give an exact result\n\n    let i = xs.length - 1;\n\n    if (x === xs[i]) {\n      return ys[i];\n    } // Search for the interval x is in, returning the corresponding y if x is one of the original xs\n\n\n    let low = 0;\n    let high = c3s.length - 1;\n    let mid;\n\n    while (low <= high) {\n      mid = Math.floor(0.5 * (low + high));\n      const xHere = xs[mid];\n\n      if (xHere < x) {\n        low = mid + 1;\n      } else if (xHere > x) {\n        high = mid - 1;\n      } else {\n        return ys[mid];\n      }\n    }\n\n    i = Math.max(0, high); // Interpolate\n\n    const diff = x - xs[i];\n    const diffSq = diff * diff;\n    return ys[i] + c1s[i] * diff + c2s[i] * diffSq + c3s[i] * diff * diffSq;\n  }\n\n  constructor(xs, ys) {\n    const {\n      length\n    } = xs; // Rearrange xs and ys so that xs is sorted\n\n    const indexes = [];\n\n    for (let i = 0; i < length; i++) {\n      indexes.push(i);\n    }\n\n    indexes.sort((a, b) => xs[a] < xs[b] ? -1 : 1); // Get consecutive differences and slopes\n    const dxs = [];\n    const ms = [];\n    let dx;\n    let dy;\n\n    for (let i1 = 0; i1 < length - 1; i1++) {\n      dx = xs[i1 + 1] - xs[i1];\n      dy = ys[i1 + 1] - ys[i1];\n      dxs.push(dx);\n      ms.push(dy / dx);\n    } // Get degree-1 coefficients\n\n\n    const c1s = [ms[0]];\n\n    for (let i2 = 0; i2 < dxs.length - 1; i2++) {\n      const m2 = ms[i2];\n      const mNext = ms[i2 + 1];\n\n      if (m2 * mNext <= 0) {\n        c1s.push(0);\n      } else {\n        dx = dxs[i2];\n        const dxNext = dxs[i2 + 1];\n        const common = dx + dxNext;\n        c1s.push(3 * common / ((common + dxNext) / m2 + (common + dx) / mNext));\n      }\n    }\n\n    c1s.push(ms[ms.length - 1]); // Get degree-2 and degree-3 coefficients\n\n    const c2s = [];\n    const c3s = [];\n    let m;\n\n    for (let i3 = 0; i3 < c1s.length - 1; i3++) {\n      m = ms[i3];\n      const c1 = c1s[i3];\n      const invDx = 1 / dxs[i3];\n      const common = c1 + c1s[i3 + 1] - m - m;\n      c2s.push((m - c1 - common) * invDx);\n      c3s.push(common * invDx * invDx);\n    }\n\n    this.xs = xs;\n    this.ys = ys;\n    this.c1s = c1s;\n    this.c2s = c2s;\n    this.c3s = c3s;\n  }\n\n}\n\nconst ELEMENT_NODE$1 = 1;\nfunction getNodeClientOffset$1(node) {\n  const el = node.nodeType === ELEMENT_NODE$1 ? node : node.parentElement;\n\n  if (!el) {\n    return null;\n  }\n\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\nfunction getEventClientOffset$1(e) {\n  return {\n    x: e.clientX,\n    y: e.clientY\n  };\n}\n\nfunction isImageNode(node) {\n  var ref;\n  return node.nodeName === 'IMG' && (isFirefox() || !((ref = document.documentElement) === null || ref === void 0 ? void 0 : ref.contains(node)));\n}\n\nfunction getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight) {\n  let dragPreviewWidth = isImage ? dragPreview.width : sourceWidth;\n  let dragPreviewHeight = isImage ? dragPreview.height : sourceHeight; // Work around @2x coordinate discrepancies in browsers\n\n  if (isSafari() && isImage) {\n    dragPreviewHeight /= window.devicePixelRatio;\n    dragPreviewWidth /= window.devicePixelRatio;\n  }\n\n  return {\n    dragPreviewWidth,\n    dragPreviewHeight\n  };\n}\n\nfunction getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint) {\n  // The browsers will use the image intrinsic size under different conditions.\n  // Firefox only cares if it's an image, but WebKit also wants it to be detached.\n  const isImage = isImageNode(dragPreview);\n  const dragPreviewNode = isImage ? sourceNode : dragPreview;\n  const dragPreviewNodeOffsetFromClient = getNodeClientOffset$1(dragPreviewNode);\n  const offsetFromDragPreview = {\n    x: clientOffset.x - dragPreviewNodeOffsetFromClient.x,\n    y: clientOffset.y - dragPreviewNodeOffsetFromClient.y\n  };\n  const {\n    offsetWidth: sourceWidth,\n    offsetHeight: sourceHeight\n  } = sourceNode;\n  const {\n    anchorX,\n    anchorY\n  } = anchorPoint;\n  const {\n    dragPreviewWidth,\n    dragPreviewHeight\n  } = getDragPreviewSize(isImage, dragPreview, sourceWidth, sourceHeight);\n\n  const calculateYOffset = () => {\n    const interpolantY = new MonotonicInterpolant([0, 0.5, 1], [// Dock to the top\n    offsetFromDragPreview.y, // Align at the center\n    offsetFromDragPreview.y / sourceHeight * dragPreviewHeight, // Dock to the bottom\n    offsetFromDragPreview.y + dragPreviewHeight - sourceHeight]);\n    let y = interpolantY.interpolate(anchorY); // Work around Safari 8 positioning bug\n\n    if (isSafari() && isImage) {\n      // We'll have to wait for @3x to see if this is entirely correct\n      y += (window.devicePixelRatio - 1) * dragPreviewHeight;\n    }\n\n    return y;\n  };\n\n  const calculateXOffset = () => {\n    // Interpolate coordinates depending on anchor point\n    // If you know a simpler way to do this, let me know\n    const interpolantX = new MonotonicInterpolant([0, 0.5, 1], [// Dock to the left\n    offsetFromDragPreview.x, // Align at the center\n    offsetFromDragPreview.x / sourceWidth * dragPreviewWidth, // Dock to the right\n    offsetFromDragPreview.x + dragPreviewWidth - sourceWidth]);\n    return interpolantX.interpolate(anchorX);\n  }; // Force offsets if specified in the options.\n\n\n  const {\n    offsetX,\n    offsetY\n  } = offsetPoint;\n  const isManualOffsetX = offsetX === 0 || offsetX;\n  const isManualOffsetY = offsetY === 0 || offsetY;\n  return {\n    x: isManualOffsetX ? offsetX : calculateXOffset(),\n    y: isManualOffsetY ? offsetY : calculateYOffset()\n  };\n}\n\nclass OptionsReader$1 {\n  get window() {\n    if (this.globalContext) {\n      return this.globalContext;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n\n    return undefined;\n  }\n\n  get document() {\n    var ref;\n\n    if ((ref = this.globalContext) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.globalContext.document;\n    } else if (this.window) {\n      return this.window.document;\n    } else {\n      return undefined;\n    }\n  }\n\n  get rootElement() {\n    var ref;\n    return ((ref = this.optionsArgs) === null || ref === void 0 ? void 0 : ref.rootElement) || this.window;\n  }\n\n  constructor(globalContext, options) {\n    this.ownerDocument = null;\n    this.globalContext = globalContext;\n    this.optionsArgs = options;\n  }\n\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n    var ownKeys = Object.keys(source);\n\n    if (typeof Object.getOwnPropertySymbols === 'function') {\n      ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) {\n        return Object.getOwnPropertyDescriptor(source, sym).enumerable;\n      }));\n    }\n\n    ownKeys.forEach(function (key) {\n      _defineProperty(target, key, source[key]);\n    });\n  }\n\n  return target;\n}\nclass HTML5BackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref, ref1;\n    return {\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      sourceNodeOptions: this.sourceNodeOptions.size,\n      sourceNodes: this.sourceNodes.size,\n      dragStartSourceIds: ((ref = this.dragStartSourceIds) === null || ref === void 0 ? void 0 : ref.length) || 0,\n      dropTargetIds: this.dropTargetIds.length,\n      dragEnterTargetIds: this.dragEnterTargetIds.length,\n      dragOverTargetIds: ((ref1 = this.dragOverTargetIds) === null || ref1 === void 0 ? void 0 : ref1.length) || 0\n    };\n  } // public for test\n\n\n  get window() {\n    return this.options.window;\n  }\n\n  get document() {\n    return this.options.document;\n  }\n  /**\n  * Get the root element to use for event subscriptions\n  */\n\n\n  get rootElement() {\n    return this.options.rootElement;\n  }\n\n  setup() {\n    const root = this.rootElement;\n\n    if (root === undefined) {\n      return;\n    }\n\n    if (root.__isReactDndBackendSetUp) {\n      throw new Error('Cannot have two HTML5 backends at the same time.');\n    }\n\n    root.__isReactDndBackendSetUp = true;\n    this.addEventListeners(root);\n  }\n\n  teardown() {\n    const root = this.rootElement;\n\n    if (root === undefined) {\n      return;\n    }\n\n    root.__isReactDndBackendSetUp = false;\n    this.removeEventListeners(this.rootElement);\n    this.clearCurrentDragSourceNode();\n\n    if (this.asyncEndDragFrameId) {\n      var ref;\n      (ref = this.window) === null || ref === void 0 ? void 0 : ref.cancelAnimationFrame(this.asyncEndDragFrameId);\n    }\n  }\n\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n\n  connectDragSource(sourceId, node, options) {\n    this.sourceNodes.set(sourceId, node);\n    this.sourceNodeOptions.set(sourceId, options);\n\n    const handleDragStart = e => this.handleDragStart(e, sourceId);\n\n    const handleSelectStart = e => this.handleSelectStart(e);\n\n    node.setAttribute('draggable', 'true');\n    node.addEventListener('dragstart', handleDragStart);\n    node.addEventListener('selectstart', handleSelectStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.sourceNodeOptions.delete(sourceId);\n      node.removeEventListener('dragstart', handleDragStart);\n      node.removeEventListener('selectstart', handleSelectStart);\n      node.setAttribute('draggable', 'false');\n    };\n  }\n\n  connectDropTarget(targetId, node) {\n    const handleDragEnter = e => this.handleDragEnter(e, targetId);\n\n    const handleDragOver = e => this.handleDragOver(e, targetId);\n\n    const handleDrop = e => this.handleDrop(e, targetId);\n\n    node.addEventListener('dragenter', handleDragEnter);\n    node.addEventListener('dragover', handleDragOver);\n    node.addEventListener('drop', handleDrop);\n    return () => {\n      node.removeEventListener('dragenter', handleDragEnter);\n      node.removeEventListener('dragover', handleDragOver);\n      node.removeEventListener('drop', handleDrop);\n    };\n  }\n\n  addEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.addEventListener) {\n      return;\n    }\n\n    target.addEventListener('dragstart', this.handleTopDragStart);\n    target.addEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.addEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.addEventListener('dragenter', this.handleTopDragEnter);\n    target.addEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.addEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.addEventListener('dragover', this.handleTopDragOver);\n    target.addEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.addEventListener('drop', this.handleTopDrop);\n    target.addEventListener('drop', this.handleTopDropCapture, true);\n  }\n\n  removeEventListeners(target) {\n    // SSR Fix (https://github.com/react-dnd/react-dnd/pull/813\n    if (!target.removeEventListener) {\n      return;\n    }\n\n    target.removeEventListener('dragstart', this.handleTopDragStart);\n    target.removeEventListener('dragstart', this.handleTopDragStartCapture, true);\n    target.removeEventListener('dragend', this.handleTopDragEndCapture, true);\n    target.removeEventListener('dragenter', this.handleTopDragEnter);\n    target.removeEventListener('dragenter', this.handleTopDragEnterCapture, true);\n    target.removeEventListener('dragleave', this.handleTopDragLeaveCapture, true);\n    target.removeEventListener('dragover', this.handleTopDragOver);\n    target.removeEventListener('dragover', this.handleTopDragOverCapture, true);\n    target.removeEventListener('drop', this.handleTopDrop);\n    target.removeEventListener('drop', this.handleTopDropCapture, true);\n  }\n\n  getCurrentSourceNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourceNodeOptions = this.sourceNodeOptions.get(sourceId);\n    return _objectSpread({\n      dropEffect: this.altKeyPressed ? 'copy' : 'move'\n    }, sourceNodeOptions || {});\n  }\n\n  getCurrentDropEffect() {\n    if (this.isDraggingNativeItem()) {\n      // It makes more sense to default to 'copy' for native resources\n      return 'copy';\n    }\n\n    return this.getCurrentSourceNodeOptions().dropEffect;\n  }\n\n  getCurrentSourcePreviewNodeOptions() {\n    const sourceId = this.monitor.getSourceId();\n    const sourcePreviewNodeOptions = this.sourcePreviewNodeOptions.get(sourceId);\n    return _objectSpread({\n      anchorX: 0.5,\n      anchorY: 0.5,\n      captureDraggingState: false\n    }, sourcePreviewNodeOptions || {});\n  }\n\n  isDraggingNativeItem() {\n    const itemType = this.monitor.getItemType();\n    return Object.keys(NativeTypes).some(key => NativeTypes[key] === itemType);\n  }\n\n  beginDragNativeItem(type, dataTransfer) {\n    this.clearCurrentDragSourceNode();\n    this.currentNativeSource = createNativeDragSource(type, dataTransfer);\n    this.currentNativeHandle = this.registry.addSource(type, this.currentNativeSource);\n    this.actions.beginDrag([this.currentNativeHandle]);\n  }\n\n  setCurrentDragSourceNode(node) {\n    this.clearCurrentDragSourceNode();\n    this.currentDragSourceNode = node; // A timeout of > 0 is necessary to resolve Firefox issue referenced\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n\n    const MOUSE_MOVE_TIMEOUT = 1000; // Receiving a mouse event in the middle of a dragging operation\n    // means it has ended and the drag source node disappeared from DOM,\n    // so the browser didn't dispatch the dragend event.\n    //\n    // We need to wait before we start listening for mousemove events.\n    // This is needed because the drag preview needs to be drawn or else it fires an 'mousemove' event\n    // immediately in some browsers.\n    //\n    // See:\n    //   * https://github.com/react-dnd/react-dnd/pull/928\n    //   * https://github.com/react-dnd/react-dnd/issues/869\n    //\n\n    this.mouseMoveTimeoutTimer = setTimeout(() => {\n      var ref;\n      return (ref = this.rootElement) === null || ref === void 0 ? void 0 : ref.addEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n    }, MOUSE_MOVE_TIMEOUT);\n  }\n\n  clearCurrentDragSourceNode() {\n    if (this.currentDragSourceNode) {\n      this.currentDragSourceNode = null;\n\n      if (this.rootElement) {\n        var ref;\n        (ref = this.window) === null || ref === void 0 ? void 0 : ref.clearTimeout(this.mouseMoveTimeoutTimer || undefined);\n        this.rootElement.removeEventListener('mousemove', this.endDragIfSourceWasRemovedFromDOM, true);\n      }\n\n      this.mouseMoveTimeoutTimer = null;\n      return true;\n    }\n\n    return false;\n  }\n\n  handleDragStart(e, sourceId) {\n    if (e.defaultPrevented) {\n      return;\n    }\n\n    if (!this.dragStartSourceIds) {\n      this.dragStartSourceIds = [];\n    }\n\n    this.dragStartSourceIds.unshift(sourceId);\n  }\n\n  handleDragEnter(_e, targetId) {\n    this.dragEnterTargetIds.unshift(targetId);\n  }\n\n  handleDragOver(_e, targetId) {\n    if (this.dragOverTargetIds === null) {\n      this.dragOverTargetIds = [];\n    }\n\n    this.dragOverTargetIds.unshift(targetId);\n  }\n\n  handleDrop(_e, targetId) {\n    this.dropTargetIds.unshift(targetId);\n  }\n\n  constructor(manager, globalContext, options) {\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.sourceNodes = new Map();\n    this.sourceNodeOptions = new Map();\n    this.dragStartSourceIds = null;\n    this.dropTargetIds = [];\n    this.dragEnterTargetIds = [];\n    this.currentNativeSource = null;\n    this.currentNativeHandle = null;\n    this.currentDragSourceNode = null;\n    this.altKeyPressed = false;\n    this.mouseMoveTimeoutTimer = null;\n    this.asyncEndDragFrameId = null;\n    this.dragOverTargetIds = null;\n    this.lastClientOffset = null;\n    this.hoverRafId = null;\n\n    this.getSourceClientOffset = sourceId => {\n      const source = this.sourceNodes.get(sourceId);\n      return source && getNodeClientOffset$1(source) || null;\n    };\n\n    this.endDragNativeItem = () => {\n      if (!this.isDraggingNativeItem()) {\n        return;\n      }\n\n      this.actions.endDrag();\n\n      if (this.currentNativeHandle) {\n        this.registry.removeSource(this.currentNativeHandle);\n      }\n\n      this.currentNativeHandle = null;\n      this.currentNativeSource = null;\n    };\n\n    this.isNodeInDocument = node => {\n      // Check the node either in the main document or in the current context\n      return Boolean(node && this.document && this.document.body && this.document.body.contains(node));\n    };\n\n    this.endDragIfSourceWasRemovedFromDOM = () => {\n      const node = this.currentDragSourceNode;\n\n      if (node == null || this.isNodeInDocument(node)) {\n        return;\n      }\n\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.scheduleHover = dragOverTargetIds => {\n      if (this.hoverRafId === null && typeof requestAnimationFrame !== 'undefined') {\n        this.hoverRafId = requestAnimationFrame(() => {\n          if (this.monitor.isDragging()) {\n            this.actions.hover(dragOverTargetIds || [], {\n              clientOffset: this.lastClientOffset\n            });\n          }\n\n          this.hoverRafId = null;\n        });\n      }\n    };\n\n    this.cancelHover = () => {\n      if (this.hoverRafId !== null && typeof cancelAnimationFrame !== 'undefined') {\n        cancelAnimationFrame(this.hoverRafId);\n        this.hoverRafId = null;\n      }\n    };\n\n    this.handleTopDragStartCapture = () => {\n      this.clearCurrentDragSourceNode();\n      this.dragStartSourceIds = [];\n    };\n\n    this.handleTopDragStart = e => {\n      if (e.defaultPrevented) {\n        return;\n      }\n\n      const {\n        dragStartSourceIds\n      } = this;\n      this.dragStartSourceIds = null;\n      const clientOffset = getEventClientOffset$1(e); // Avoid crashing if we missed a drop event or our previous drag died\n\n      if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n        this.cancelHover();\n      } // Don't publish the source just yet (see why below)\n\n\n      this.actions.beginDrag(dragStartSourceIds || [], {\n        publishSource: false,\n        getSourceClientOffset: this.getSourceClientOffset,\n        clientOffset\n      });\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n\n      if (this.monitor.isDragging()) {\n        if (dataTransfer && typeof dataTransfer.setDragImage === 'function') {\n          // Use custom drag image if user specifies it.\n          // If child drag source refuses drag but parent agrees,\n          // use parent's node as drag image. Neither works in IE though.\n          const sourceId = this.monitor.getSourceId();\n          const sourceNode = this.sourceNodes.get(sourceId);\n          const dragPreview = this.sourcePreviewNodes.get(sourceId) || sourceNode;\n\n          if (dragPreview) {\n            const {\n              anchorX,\n              anchorY,\n              offsetX,\n              offsetY\n            } = this.getCurrentSourcePreviewNodeOptions();\n            const anchorPoint = {\n              anchorX,\n              anchorY\n            };\n            const offsetPoint = {\n              offsetX,\n              offsetY\n            };\n            const dragPreviewOffset = getDragPreviewOffset(sourceNode, dragPreview, clientOffset, anchorPoint, offsetPoint);\n            dataTransfer.setDragImage(dragPreview, dragPreviewOffset.x, dragPreviewOffset.y);\n          }\n        }\n\n        try {\n          // Firefox won't drag without setting data\n          dataTransfer === null || dataTransfer === void 0 ? void 0 : dataTransfer.setData('application/json', {});\n        } catch (err) {// IE doesn't support MIME types in setData\n        } // Store drag source node so we can check whether\n        // it is removed from DOM and trigger endDrag manually.\n\n\n        this.setCurrentDragSourceNode(e.target); // Now we are ready to publish the drag source.. or are we not?\n\n        const {\n          captureDraggingState\n        } = this.getCurrentSourcePreviewNodeOptions();\n\n        if (!captureDraggingState) {\n          // Usually we want to publish it in the next tick so that browser\n          // is able to screenshot the current (not yet dragging) state.\n          //\n          // It also neatly avoids a situation where render() returns null\n          // in the same tick for the source element, and browser freaks out.\n          setTimeout(() => this.actions.publishDragSource(), 0);\n        } else {\n          // In some cases the user may want to override this behavior, e.g.\n          // to work around IE not supporting custom drag previews.\n          //\n          // When using a custom drag layer, the only way to prevent\n          // the default drag preview from drawing in IE is to screenshot\n          // the dragging state in which the node itself has zero opacity\n          // and height. In this case, though, returning null from render()\n          // will abruptly end the dragging, which is not obvious.\n          //\n          // This is the reason such behavior is strictly opt-in.\n          this.actions.publishDragSource();\n        }\n      } else if (nativeType) {\n        // A native item (such as URL) dragged from inside the document\n        this.beginDragNativeItem(nativeType);\n      } else if (dataTransfer && !dataTransfer.types && (e.target && !e.target.hasAttribute || !e.target.hasAttribute('draggable'))) {\n        // Looks like a Safari bug: dataTransfer.types is null, but there was no draggable.\n        // Just let it drag. It's a native type (URL or text) and will be picked up in\n        // dragenter handler.\n        return;\n      } else {\n        // If by this time no drag source reacted, tell browser not to drag.\n        e.preventDefault();\n      }\n    };\n\n    this.handleTopDragEndCapture = () => {\n      if (this.clearCurrentDragSourceNode() && this.monitor.isDragging()) {\n        // Firefox can dispatch this event in an infinite loop\n        // if dragend handler does something like showing an alert.\n        // Only proceed if we have not handled it already.\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleTopDragEnterCapture = e => {\n      this.dragEnterTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n\n      const isFirstEnter = this.enterLeaveCounter.enter(e.target);\n\n      if (!isFirstEnter || this.monitor.isDragging()) {\n        return;\n      }\n\n      const {\n        dataTransfer\n      } = e;\n      const nativeType = matchNativeItemType(dataTransfer);\n\n      if (nativeType) {\n        // A native item (such as file or URL) dragged from outside the document\n        this.beginDragNativeItem(nativeType, dataTransfer);\n      }\n    };\n\n    this.handleTopDragEnter = e => {\n      const {\n        dragEnterTargetIds\n      } = this;\n      this.dragEnterTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        return;\n      }\n\n      this.altKeyPressed = e.altKey; // If the target changes position as the result of `dragenter`, `dragover` might still\n      // get dispatched despite target being no longer there. The easy solution is to check\n      // whether there actually is a target before firing `hover`.\n\n      if (dragEnterTargetIds.length > 0) {\n        this.actions.hover(dragEnterTargetIds, {\n          clientOffset: getEventClientOffset$1(e)\n        });\n      }\n\n      const canDrop = dragEnterTargetIds.some(targetId => this.monitor.canDropOnTarget(targetId));\n\n      if (canDrop) {\n        // IE requires this to fire dragover events\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      }\n    };\n\n    this.handleTopDragOverCapture = e => {\n      this.dragOverTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      }\n    };\n\n    this.handleTopDragOver = e => {\n      const {\n        dragOverTargetIds\n      } = this;\n      this.dragOverTargetIds = [];\n\n      if (!this.monitor.isDragging()) {\n        // This is probably a native item type we don't understand.\n        // Prevent default \"drop and blow away the whole document\" action.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n\n        return;\n      }\n\n      this.altKeyPressed = e.altKey;\n      this.lastClientOffset = getEventClientOffset$1(e);\n      this.scheduleHover(dragOverTargetIds);\n      const canDrop = (dragOverTargetIds || []).some(targetId => this.monitor.canDropOnTarget(targetId));\n\n      if (canDrop) {\n        // Show user-specified drop effect.\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = this.getCurrentDropEffect();\n        }\n      } else if (this.isDraggingNativeItem()) {\n        // Don't show a nice cursor but still prevent default\n        // \"drop and blow away the whole document\" action.\n        e.preventDefault();\n      } else {\n        e.preventDefault();\n\n        if (e.dataTransfer) {\n          e.dataTransfer.dropEffect = 'none';\n        }\n      }\n    };\n\n    this.handleTopDragLeaveCapture = e => {\n      if (this.isDraggingNativeItem()) {\n        e.preventDefault();\n      }\n\n      const isLastLeave = this.enterLeaveCounter.leave(e.target);\n\n      if (!isLastLeave) {\n        return;\n      }\n\n      if (this.isDraggingNativeItem()) {\n        setTimeout(() => this.endDragNativeItem(), 0);\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleTopDropCapture = e => {\n      this.dropTargetIds = [];\n\n      if (this.isDraggingNativeItem()) {\n        var ref;\n        e.preventDefault();\n        (ref = this.currentNativeSource) === null || ref === void 0 ? void 0 : ref.loadDataTransfer(e.dataTransfer);\n      } else if (matchNativeItemType(e.dataTransfer)) {\n        // Dragging some elements, like <a> and <img> may still behave like a native drag event,\n        // even if the current drag event matches a user-defined type.\n        // Stop the default behavior when we're not expecting a native item to be dropped.\n        e.preventDefault();\n      }\n\n      this.enterLeaveCounter.reset();\n    };\n\n    this.handleTopDrop = e => {\n      const {\n        dropTargetIds\n      } = this;\n      this.dropTargetIds = [];\n      this.actions.hover(dropTargetIds, {\n        clientOffset: getEventClientOffset$1(e)\n      });\n      this.actions.drop({\n        dropEffect: this.getCurrentDropEffect()\n      });\n\n      if (this.isDraggingNativeItem()) {\n        this.endDragNativeItem();\n      } else if (this.monitor.isDragging()) {\n        this.actions.endDrag();\n      }\n\n      this.cancelHover();\n    };\n\n    this.handleSelectStart = e => {\n      const target = e.target; // Only IE requires us to explicitly say\n      // we want drag drop operation to start\n\n      if (typeof target.dragDrop !== 'function') {\n        return;\n      } // Inputs and textareas should be selectable\n\n\n      if (target.tagName === 'INPUT' || target.tagName === 'SELECT' || target.tagName === 'TEXTAREA' || target.isContentEditable) {\n        return;\n      } // For other targets, ask IE\n      // to enable drag and drop\n\n\n      e.preventDefault();\n      target.dragDrop();\n    };\n\n    this.options = new OptionsReader$1(globalContext, options);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.registry = manager.getRegistry();\n    this.enterLeaveCounter = new EnterLeaveCounter(this.isNodeInDocument);\n  }\n\n}\n\nlet emptyImage;\nfunction getEmptyImage() {\n  if (!emptyImage) {\n    emptyImage = new Image();\n    emptyImage.src = 'data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==';\n  }\n\n  return emptyImage;\n}\n\nconst HTML5Backend = function createBackend(manager, context, options) {\n  return new HTML5BackendImpl(manager, context, options);\n};\n\nvar ListenerType;\n\n(function (ListenerType) {\n  ListenerType[\"mouse\"] = \"mouse\";\n  ListenerType[\"touch\"] = \"touch\";\n  ListenerType[\"keyboard\"] = \"keyboard\";\n})(ListenerType || (ListenerType = {}));\n\nclass OptionsReader {\n  get delay() {\n    var _delay;\n\n    return (_delay = this.args.delay) !== null && _delay !== void 0 ? _delay : 0;\n  }\n\n  get scrollAngleRanges() {\n    return this.args.scrollAngleRanges;\n  }\n\n  get getDropTargetElementsAtPoint() {\n    return this.args.getDropTargetElementsAtPoint;\n  }\n\n  get ignoreContextMenu() {\n    var _ignoreContextMenu;\n\n    return (_ignoreContextMenu = this.args.ignoreContextMenu) !== null && _ignoreContextMenu !== void 0 ? _ignoreContextMenu : false;\n  }\n\n  get enableHoverOutsideTarget() {\n    var _enableHoverOutsideTarget;\n\n    return (_enableHoverOutsideTarget = this.args.enableHoverOutsideTarget) !== null && _enableHoverOutsideTarget !== void 0 ? _enableHoverOutsideTarget : false;\n  }\n\n  get enableKeyboardEvents() {\n    var _enableKeyboardEvents;\n\n    return (_enableKeyboardEvents = this.args.enableKeyboardEvents) !== null && _enableKeyboardEvents !== void 0 ? _enableKeyboardEvents : false;\n  }\n\n  get enableMouseEvents() {\n    var _enableMouseEvents;\n\n    return (_enableMouseEvents = this.args.enableMouseEvents) !== null && _enableMouseEvents !== void 0 ? _enableMouseEvents : false;\n  }\n\n  get enableTouchEvents() {\n    var _enableTouchEvents;\n\n    return (_enableTouchEvents = this.args.enableTouchEvents) !== null && _enableTouchEvents !== void 0 ? _enableTouchEvents : true;\n  }\n\n  get touchSlop() {\n    return this.args.touchSlop || 0;\n  }\n\n  get delayTouchStart() {\n    var ref, ref1;\n    var ref2, ref3;\n    return (ref3 = (ref2 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayTouchStart) !== null && ref2 !== void 0 ? ref2 : (ref1 = this.args) === null || ref1 === void 0 ? void 0 : ref1.delay) !== null && ref3 !== void 0 ? ref3 : 0;\n  }\n\n  get delayMouseStart() {\n    var ref, ref4;\n    var ref5, ref6;\n    return (ref6 = (ref5 = (ref = this.args) === null || ref === void 0 ? void 0 : ref.delayMouseStart) !== null && ref5 !== void 0 ? ref5 : (ref4 = this.args) === null || ref4 === void 0 ? void 0 : ref4.delay) !== null && ref6 !== void 0 ? ref6 : 0;\n  }\n\n  get window() {\n    if (this.context && this.context.window) {\n      return this.context.window;\n    } else if (typeof window !== 'undefined') {\n      return window;\n    }\n\n    return undefined;\n  }\n\n  get document() {\n    var ref;\n\n    if ((ref = this.context) === null || ref === void 0 ? void 0 : ref.document) {\n      return this.context.document;\n    }\n\n    if (this.window) {\n      return this.window.document;\n    }\n\n    return undefined;\n  }\n\n  get rootElement() {\n    var ref;\n    return ((ref = this.args) === null || ref === void 0 ? void 0 : ref.rootElement) || this.document;\n  }\n\n  constructor(args, context) {\n    this.args = args;\n    this.context = context;\n  }\n\n}\n\nfunction distance(x1, y1, x2, y2) {\n  return Math.sqrt(Math.pow(Math.abs(x2 - x1), 2) + Math.pow(Math.abs(y2 - y1), 2));\n}\nfunction inAngleRanges(x1, y1, x2, y2, angleRanges) {\n  if (!angleRanges) {\n    return false;\n  }\n\n  const angle = Math.atan2(y2 - y1, x2 - x1) * 180 / Math.PI + 180;\n\n  for (let i = 0; i < angleRanges.length; ++i) {\n    const ar = angleRanges[i];\n\n    if (ar && (ar.start == null || angle >= ar.start) && (ar.end == null || angle <= ar.end)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Used for MouseEvent.buttons (note the s on the end).\nconst MouseButtons = {\n  Left: 1,\n  Right: 2,\n  Center: 4\n}; // Used for e.button (note the lack of an s on the end).\n\nconst MouseButton = {\n  Left: 0,\n  Center: 1,\n  Right: 2\n};\n/**\n * Only touch events and mouse events where the left button is pressed should initiate a drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldStartDrag(e) {\n  // For touch events, button will be undefined. If e.button is defined,\n  // then it should be MouseButton.Left.\n  return e.button === undefined || e.button === MouseButton.Left;\n}\n/**\n * Only touch events and mouse events where the left mouse button is no longer held should end a drag.\n * It's possible the user mouse downs with the left mouse button, then mouse down and ups with the right mouse button.\n * We don't want releasing the right mouse button to end the drag.\n * @param {MouseEvent | TouchEvent} e The event\n */\n\nfunction eventShouldEndDrag(e) {\n  // Touch events will have buttons be undefined, while mouse events will have e.buttons's left button\n  // bit field unset if the left mouse button has been released\n  return e.buttons === undefined || (e.buttons & MouseButtons.Left) === 0;\n}\nfunction isTouchEvent(e) {\n  return !!e.targetTouches;\n}\n\nconst ELEMENT_NODE = 1;\nfunction getNodeClientOffset(node) {\n  const el = node.nodeType === ELEMENT_NODE ? node : node.parentElement;\n\n  if (!el) {\n    return undefined;\n  }\n\n  const {\n    top,\n    left\n  } = el.getBoundingClientRect();\n  return {\n    x: left,\n    y: top\n  };\n}\nfunction getEventClientTouchOffset(e, lastTargetTouchFallback) {\n  if (e.targetTouches.length === 1) {\n    return getEventClientOffset(e.targetTouches[0]);\n  } else if (lastTargetTouchFallback && e.touches.length === 1) {\n    if (e.touches[0].target === lastTargetTouchFallback.target) {\n      return getEventClientOffset(e.touches[0]);\n    }\n  }\n\n  return;\n}\nfunction getEventClientOffset(e, lastTargetTouchFallback) {\n  if (isTouchEvent(e)) {\n    return getEventClientTouchOffset(e, lastTargetTouchFallback);\n  } else {\n    return {\n      x: e.clientX,\n      y: e.clientY\n    };\n  }\n}\n\nconst supportsPassive = (() => {\n  // simular to jQuery's test\n  let supported = false;\n\n  try {\n    addEventListener('test', () => {// do nothing\n    }, Object.defineProperty({}, 'passive', {\n      get() {\n        supported = true;\n        return true;\n      }\n\n    }));\n  } catch (e) {// do nothing\n  }\n\n  return supported;\n})();\n\nconst eventNames = {\n  [ListenerType.mouse]: {\n    start: 'mousedown',\n    move: 'mousemove',\n    end: 'mouseup',\n    contextmenu: 'contextmenu'\n  },\n  [ListenerType.touch]: {\n    start: 'touchstart',\n    move: 'touchmove',\n    end: 'touchend'\n  },\n  [ListenerType.keyboard]: {\n    keydown: 'keydown'\n  }\n};\nclass TouchBackendImpl {\n  /**\n  * Generate profiling statistics for the HTML5Backend.\n  */\n  profile() {\n    var ref;\n    return {\n      sourceNodes: this.sourceNodes.size,\n      sourcePreviewNodes: this.sourcePreviewNodes.size,\n      sourcePreviewNodeOptions: this.sourcePreviewNodeOptions.size,\n      targetNodes: this.targetNodes.size,\n      dragOverTargetIds: ((ref = this.dragOverTargetIds) === null || ref === void 0 ? void 0 : ref.length) || 0\n    };\n  } // public for test\n\n\n  get document() {\n    return this.options.document;\n  }\n\n  setup() {\n    const root = this.options.rootElement;\n\n    if (!root) {\n      return;\n    }\n\n    invariant(!TouchBackendImpl.isSetUp, 'Cannot have two Touch backends at the same time.');\n    TouchBackendImpl.isSetUp = true;\n    this.addEventListener(root, 'start', this.getTopMoveStartHandler());\n    this.addEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.addEventListener(root, 'move', this.handleTopMove);\n    this.addEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.addEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.addEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.addEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n  }\n\n  teardown() {\n    const root = this.options.rootElement;\n\n    if (!root) {\n      return;\n    }\n\n    TouchBackendImpl.isSetUp = false;\n    this._mouseClientOffset = {};\n    this.removeEventListener(root, 'start', this.handleTopMoveStartCapture, true);\n    this.removeEventListener(root, 'start', this.handleTopMoveStart);\n    this.removeEventListener(root, 'move', this.handleTopMoveCapture, true);\n    this.removeEventListener(root, 'move', this.handleTopMove);\n    this.removeEventListener(root, 'end', this.handleTopMoveEndCapture, true);\n\n    if (this.options.enableMouseEvents && !this.options.ignoreContextMenu) {\n      this.removeEventListener(root, 'contextmenu', this.handleTopMoveEndCapture);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.removeEventListener(root, 'keydown', this.handleCancelOnEscape, true);\n    }\n\n    this.uninstallSourceNodeRemovalObserver();\n  }\n\n  addEventListener(subject, event, handler, capture = false) {\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n\n      if (evt) {\n        subject.addEventListener(evt, handler, options);\n      }\n    });\n  }\n\n  removeEventListener(subject, event, handler, capture = false) {\n    const options = supportsPassive ? {\n      capture,\n      passive: false\n    } : capture;\n    this.listenerTypes.forEach(function (listenerType) {\n      const evt = eventNames[listenerType][event];\n\n      if (evt) {\n        subject.removeEventListener(evt, handler, options);\n      }\n    });\n  }\n\n  connectDragSource(sourceId, node) {\n    const handleMoveStart = this.handleMoveStart.bind(this, sourceId);\n    this.sourceNodes.set(sourceId, node);\n    this.addEventListener(node, 'start', handleMoveStart);\n    return () => {\n      this.sourceNodes.delete(sourceId);\n      this.removeEventListener(node, 'start', handleMoveStart);\n    };\n  }\n\n  connectDragPreview(sourceId, node, options) {\n    this.sourcePreviewNodeOptions.set(sourceId, options);\n    this.sourcePreviewNodes.set(sourceId, node);\n    return () => {\n      this.sourcePreviewNodes.delete(sourceId);\n      this.sourcePreviewNodeOptions.delete(sourceId);\n    };\n  }\n\n  connectDropTarget(targetId, node) {\n    const root = this.options.rootElement;\n\n    if (!this.document || !root) {\n      return () => {\n        /* noop */\n      };\n    }\n\n    const handleMove = e => {\n      if (!this.document || !root || !this.monitor.isDragging()) {\n        return;\n      }\n\n      let coords;\n      /**\n      * Grab the coordinates for the current mouse/touch position\n      */\n\n      switch (e.type) {\n        case eventNames.mouse.move:\n          coords = {\n            x: e.clientX,\n            y: e.clientY\n          };\n          break;\n\n        case eventNames.touch.move:\n          var ref, ref1;\n          coords = {\n            x: ((ref = e.touches[0]) === null || ref === void 0 ? void 0 : ref.clientX) || 0,\n            y: ((ref1 = e.touches[0]) === null || ref1 === void 0 ? void 0 : ref1.clientY) || 0\n          };\n          break;\n      }\n      /**\n      * Use the coordinates to grab the element the drag ended on.\n      * If the element is the same as the target node (or any of it's children) then we have hit a drop target and can handle the move.\n      */\n\n\n      const droppedOn = coords != null ? this.document.elementFromPoint(coords.x, coords.y) : undefined;\n      const childMatch = droppedOn && node.contains(droppedOn);\n\n      if (droppedOn === node || childMatch) {\n        return this.handleMove(e, targetId);\n      }\n    };\n    /**\n    * Attaching the event listener to the body so that touchmove will work while dragging over multiple target elements.\n    */\n\n\n    this.addEventListener(this.document.body, 'move', handleMove);\n    this.targetNodes.set(targetId, node);\n    return () => {\n      if (this.document) {\n        this.targetNodes.delete(targetId);\n        this.removeEventListener(this.document.body, 'move', handleMove);\n      }\n    };\n  }\n\n  getTopMoveStartHandler() {\n    if (!this.options.delayTouchStart && !this.options.delayMouseStart) {\n      return this.handleTopMoveStart;\n    }\n\n    return this.handleTopMoveStartDelay;\n  }\n\n  installSourceNodeRemovalObserver(node) {\n    this.uninstallSourceNodeRemovalObserver();\n    this.draggedSourceNode = node;\n    this.draggedSourceNodeRemovalObserver = new MutationObserver(() => {\n      if (node && !node.parentElement) {\n        this.resurrectSourceNode();\n        this.uninstallSourceNodeRemovalObserver();\n      }\n    });\n\n    if (!node || !node.parentElement) {\n      return;\n    }\n\n    this.draggedSourceNodeRemovalObserver.observe(node.parentElement, {\n      childList: true\n    });\n  }\n\n  resurrectSourceNode() {\n    if (this.document && this.draggedSourceNode) {\n      this.draggedSourceNode.style.display = 'none';\n      this.draggedSourceNode.removeAttribute('data-reactid');\n      this.document.body.appendChild(this.draggedSourceNode);\n    }\n  }\n\n  uninstallSourceNodeRemovalObserver() {\n    if (this.draggedSourceNodeRemovalObserver) {\n      this.draggedSourceNodeRemovalObserver.disconnect();\n    }\n\n    this.draggedSourceNodeRemovalObserver = undefined;\n    this.draggedSourceNode = undefined;\n  }\n\n  constructor(manager, context, options) {\n    this.getSourceClientOffset = sourceId => {\n      const element = this.sourceNodes.get(sourceId);\n      return element && getNodeClientOffset(element);\n    };\n\n    this.handleTopMoveStartCapture = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n\n      this.moveStartSourceIds = [];\n    };\n\n    this.handleMoveStart = sourceId => {\n      // Just because we received an event doesn't necessarily mean we need to collect drag sources.\n      // We only collect start collecting drag sources on touch and left mouse events.\n      if (Array.isArray(this.moveStartSourceIds)) {\n        this.moveStartSourceIds.unshift(sourceId);\n      }\n    };\n\n    this.handleTopMoveStart = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      } // Don't prematurely preventDefault() here since it might:\n      // 1. Mess up scrolling\n      // 2. Mess up long tap (which brings up context menu)\n      // 3. If there's an anchor link as a child, tap won't be triggered on link\n\n\n      const clientOffset = getEventClientOffset(e);\n\n      if (clientOffset) {\n        if (isTouchEvent(e)) {\n          this.lastTargetTouchFallback = e.targetTouches[0];\n        }\n\n        this._mouseClientOffset = clientOffset;\n      }\n\n      this.waitingForDelay = false;\n    };\n\n    this.handleTopMoveStartDelay = e => {\n      if (!eventShouldStartDrag(e)) {\n        return;\n      }\n\n      const delay = e.type === eventNames.touch.start ? this.options.delayTouchStart : this.options.delayMouseStart;\n      this.timeout = setTimeout(this.handleTopMoveStart.bind(this, e), delay);\n      this.waitingForDelay = true;\n    };\n\n    this.handleTopMoveCapture = () => {\n      this.dragOverTargetIds = [];\n    };\n\n    this.handleMove = (_evt, targetId) => {\n      if (this.dragOverTargetIds) {\n        this.dragOverTargetIds.unshift(targetId);\n      }\n    };\n\n    this.handleTopMove = e1 => {\n      if (this.timeout) {\n        clearTimeout(this.timeout);\n      }\n\n      if (!this.document || this.waitingForDelay) {\n        return;\n      }\n\n      const {\n        moveStartSourceIds,\n        dragOverTargetIds\n      } = this;\n      const enableHoverOutsideTarget = this.options.enableHoverOutsideTarget;\n      const clientOffset = getEventClientOffset(e1, this.lastTargetTouchFallback);\n\n      if (!clientOffset) {\n        return;\n      } // If the touch move started as a scroll, or is is between the scroll angles\n\n\n      if (this._isScrolling || !this.monitor.isDragging() && inAngleRanges(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y, this.options.scrollAngleRanges)) {\n        this._isScrolling = true;\n        return;\n      } // If we're not dragging and we've moved a little, that counts as a drag start\n\n\n      if (!this.monitor.isDragging() && // eslint-disable-next-line no-prototype-builtins\n      this._mouseClientOffset.hasOwnProperty('x') && moveStartSourceIds && distance(this._mouseClientOffset.x || 0, this._mouseClientOffset.y || 0, clientOffset.x, clientOffset.y) > (this.options.touchSlop ? this.options.touchSlop : 0)) {\n        this.moveStartSourceIds = undefined;\n        this.actions.beginDrag(moveStartSourceIds, {\n          clientOffset: this._mouseClientOffset,\n          getSourceClientOffset: this.getSourceClientOffset,\n          publishSource: false\n        });\n      }\n\n      if (!this.monitor.isDragging()) {\n        return;\n      }\n\n      const sourceNode = this.sourceNodes.get(this.monitor.getSourceId());\n      this.installSourceNodeRemovalObserver(sourceNode);\n      this.actions.publishDragSource();\n      if (e1.cancelable) e1.preventDefault(); // Get the node elements of the hovered DropTargets\n\n      const dragOverTargetNodes = (dragOverTargetIds || []).map(key => this.targetNodes.get(key)).filter(e => !!e); // Get the a ordered list of nodes that are touched by\n\n      const elementsAtPoint = this.options.getDropTargetElementsAtPoint ? this.options.getDropTargetElementsAtPoint(clientOffset.x, clientOffset.y, dragOverTargetNodes) : this.document.elementsFromPoint(clientOffset.x, clientOffset.y); // Extend list with parents that are not receiving elementsFromPoint events (size 0 elements and svg groups)\n\n      const elementsAtPointExtended = [];\n\n      for (const nodeId in elementsAtPoint) {\n        // eslint-disable-next-line no-prototype-builtins\n        if (!elementsAtPoint.hasOwnProperty(nodeId)) {\n          continue;\n        }\n\n        let currentNode = elementsAtPoint[nodeId];\n\n        if (currentNode != null) {\n          elementsAtPointExtended.push(currentNode);\n        }\n\n        while (currentNode) {\n          currentNode = currentNode.parentElement;\n\n          if (currentNode && elementsAtPointExtended.indexOf(currentNode) === -1) {\n            elementsAtPointExtended.push(currentNode);\n          }\n        }\n      }\n\n      const orderedDragOverTargetIds = elementsAtPointExtended // Filter off nodes that arent a hovered DropTargets nodes\n      .filter(node => dragOverTargetNodes.indexOf(node) > -1) // Map back the nodes elements to targetIds\n      .map(node => this._getDropTargetId(node)) // Filter off possible null rows\n      .filter(node => !!node).filter((id, index, ids) => ids.indexOf(id) === index); // Invoke hover for drop targets when source node is still over and pointer is outside\n\n      if (enableHoverOutsideTarget) {\n        for (const targetId in this.targetNodes) {\n          const targetNode = this.targetNodes.get(targetId);\n\n          if (sourceNode && targetNode && targetNode.contains(sourceNode) && orderedDragOverTargetIds.indexOf(targetId) === -1) {\n            orderedDragOverTargetIds.unshift(targetId);\n            break;\n          }\n        }\n      } // Reverse order because dnd-core reverse it before calling the DropTarget drop methods\n\n\n      orderedDragOverTargetIds.reverse();\n      this.actions.hover(orderedDragOverTargetIds, {\n        clientOffset: clientOffset\n      });\n    };\n    /**\n    *\n    * visible for testing\n    */\n\n\n    this._getDropTargetId = node => {\n      const keys = this.targetNodes.keys();\n      let next = keys.next();\n\n      while (next.done === false) {\n        const targetId = next.value;\n\n        if (node === this.targetNodes.get(targetId)) {\n          return targetId;\n        } else {\n          next = keys.next();\n        }\n      }\n\n      return undefined;\n    };\n\n    this.handleTopMoveEndCapture = e => {\n      this._isScrolling = false;\n      this.lastTargetTouchFallback = undefined;\n\n      if (!eventShouldEndDrag(e)) {\n        return;\n      }\n\n      if (!this.monitor.isDragging() || this.monitor.didDrop()) {\n        this.moveStartSourceIds = undefined;\n        return;\n      }\n\n      if (e.cancelable) e.preventDefault();\n      this._mouseClientOffset = {};\n      this.uninstallSourceNodeRemovalObserver();\n      this.actions.drop();\n      this.actions.endDrag();\n    };\n\n    this.handleCancelOnEscape = e => {\n      if (e.key === 'Escape' && this.monitor.isDragging()) {\n        this._mouseClientOffset = {};\n        this.uninstallSourceNodeRemovalObserver();\n        this.actions.endDrag();\n      }\n    };\n\n    this.options = new OptionsReader(options, context);\n    this.actions = manager.getActions();\n    this.monitor = manager.getMonitor();\n    this.sourceNodes = new Map();\n    this.sourcePreviewNodes = new Map();\n    this.sourcePreviewNodeOptions = new Map();\n    this.targetNodes = new Map();\n    this.listenerTypes = [];\n    this._mouseClientOffset = {};\n    this._isScrolling = false;\n\n    if (this.options.enableMouseEvents) {\n      this.listenerTypes.push(ListenerType.mouse);\n    }\n\n    if (this.options.enableTouchEvents) {\n      this.listenerTypes.push(ListenerType.touch);\n    }\n\n    if (this.options.enableKeyboardEvents) {\n      this.listenerTypes.push(ListenerType.keyboard);\n    }\n  }\n\n}\n\nconst TouchBackend = function createBackend(manager, context = {}, options = {}) {\n  return new TouchBackendImpl(manager, context, options);\n};\n\nconst COLUMNS = 'abcdefgh'.split('');\nconst chessboardDefaultProps = {\n  animationDuration: 300,\n  areArrowsAllowed: true,\n  arePiecesDraggable: true,\n  arePremovesAllowed: false,\n  boardOrientation: 'white',\n  boardWidth: 560,\n  clearPremovesOnRightClick: true,\n  customArrows: [],\n  customArrowColor: 'rgb(255,170,0)',\n  customBoardStyle: {},\n  customDarkSquareStyle: {\n    backgroundColor: '#B58863'\n  },\n  customDndBackend: undefined,\n  customDndBackendOptions: undefined,\n  customDropSquareStyle: {\n    boxShadow: 'inset 0 0 1px 6px rgba(255,255,255,0.75)'\n  },\n  customLightSquareStyle: {\n    backgroundColor: '#F0D9B5'\n  },\n  customPieces: {},\n  customPremoveDarkSquareStyle: {\n    backgroundColor: '#A42323'\n  },\n  customPremoveLightSquareStyle: {\n    backgroundColor: '#BD2828'\n  },\n  customSquareStyles: {},\n  dropOffBoardAction: 'snapback',\n  id: 0,\n  isDraggablePiece: () => true,\n  getPositionObject: () => {},\n  onArrowsChange: () => {},\n  onDragOverSquare: () => {},\n  onMouseOutSquare: () => {},\n  onMouseOverSquare: () => {},\n  onPieceClick: () => {},\n  onPieceDragBegin: () => {},\n  onPieceDragEnd: () => {},\n  onPieceDrop: () => true,\n  onSquareClick: () => {},\n  onSquareRightClick: () => {},\n  position: 'start',\n  showBoardNotation: true,\n  // showSparePieces: false,\n  snapToCursor: true\n};\n\nconst startPositionObject = {\n  a8: 'bR',\n  b8: 'bN',\n  c8: 'bB',\n  d8: 'bQ',\n  e8: 'bK',\n  f8: 'bB',\n  g8: 'bN',\n  h8: 'bR',\n  a7: 'bP',\n  b7: 'bP',\n  c7: 'bP',\n  d7: 'bP',\n  e7: 'bP',\n  f7: 'bP',\n  g7: 'bP',\n  h7: 'bP',\n  a2: 'wP',\n  b2: 'wP',\n  c2: 'wP',\n  d2: 'wP',\n  e2: 'wP',\n  f2: 'wP',\n  g2: 'wP',\n  h2: 'wP',\n  a1: 'wR',\n  b1: 'wN',\n  c1: 'wB',\n  d1: 'wQ',\n  e1: 'wK',\n  f1: 'wB',\n  g1: 'wN',\n  h1: 'wR'\n};\nconst whiteColumnValues = {\n  a: 0,\n  b: 1,\n  c: 2,\n  d: 3,\n  e: 4,\n  f: 5,\n  g: 6,\n  h: 7\n};\nconst blackColumnValues = {\n  a: 7,\n  b: 6,\n  c: 5,\n  d: 4,\n  e: 3,\n  f: 2,\n  g: 1,\n  h: 0\n};\nconst whiteRows = [7, 6, 5, 4, 3, 2, 1, 0];\nconst blackRows = [0, 1, 2, 3, 4, 5, 6, 7];\nconst getRelativeCoords = (boardOrientation, boardWidth, square) => {\n  const squareWidth = boardWidth / 8;\n  const columns = boardOrientation === 'white' ? whiteColumnValues : blackColumnValues;\n  const rows = boardOrientation === 'white' ? whiteRows : blackRows;\n  const x = columns[square[0]] * squareWidth + squareWidth / 2;\n  const y = rows[square[1] - 1] * squareWidth + squareWidth / 2;\n  return {\n    x,\n    y\n  };\n};\nconst isDifferentFromStart = newPosition => {\n  let isDifferent = false;\n  Object.keys(startPositionObject).forEach(square => {\n    if (newPosition[square] !== startPositionObject[square]) isDifferent = true;\n  });\n  Object.keys(newPosition).forEach(square => {\n    if (startPositionObject[square] !== newPosition[square]) isDifferent = true;\n  });\n  return isDifferent;\n};\nconst getPositionDifferences = (currentPosition, newPosition) => {\n  const difference = {\n    removed: {},\n    added: {}\n  }; // removed from current\n\n  Object.keys(currentPosition).forEach(square => {\n    if (newPosition[square] !== currentPosition[square]) difference.removed[square] = currentPosition[square];\n  }); // added from new\n\n  Object.keys(newPosition).forEach(square => {\n    if (currentPosition[square] !== newPosition[square]) difference.added[square] = newPosition[square];\n  });\n  return difference;\n};\n\nfunction isString(s) {\n  return typeof s === 'string';\n}\n\nfunction convertPositionToObject(position) {\n  if (position === 'start') return fenToObj('rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR');\n  if (validFen(position)) return fenToObj(position);\n  if (validPositionObject(position)) return position;\n  return {};\n}\nfunction fenToObj(fen) {\n  if (!validFen(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, '');\n  const rows = fen.split('/');\n  const position = {};\n  let currentRow = 8;\n\n  for (let i = 0; i < 8; i++) {\n    const row = rows[i].split('');\n    let colIdx = 0; // loop through each character in the FEN section\n\n    for (let j = 0; j < row.length; j++) {\n      // number / empty squares\n      if (row[j].search(/[1-8]/) !== -1) {\n        const numEmptySquares = parseInt(row[j], 10);\n        colIdx = colIdx + numEmptySquares;\n      } else {\n        // piece\n        const square = COLUMNS[colIdx] + currentRow;\n        position[square] = fenToPieceCode(row[j]);\n        colIdx = colIdx + 1;\n      }\n    }\n\n    currentRow = currentRow - 1;\n  }\n\n  return position;\n}\n\nfunction expandFenEmptySquares(fen) {\n  return fen.replace(/8/g, '11111111').replace(/7/g, '1111111').replace(/6/g, '111111').replace(/5/g, '11111').replace(/4/g, '1111').replace(/3/g, '111').replace(/2/g, '11');\n}\n\nfunction validFen(fen) {\n  if (!isString(fen)) return false; // cut off any move, castling, etc info from the end. we're only interested in position information\n\n  fen = fen.replace(/ .+$/, ''); // expand the empty square numbers to just 1s\n\n  fen = expandFenEmptySquares(fen); // FEN should be 8 sections separated by slashes\n\n  const chunks = fen.split('/');\n  if (chunks.length !== 8) return false; // check each section\n\n  for (let i = 0; i < 8; i++) {\n    if (chunks[i].length !== 8 || chunks[i].search(/[^kqrnbpKQRNBP1]/) !== -1) {\n      return false;\n    }\n  }\n\n  return true;\n} // convert FEN piece code to bP, wK, etc\n\nfunction fenToPieceCode(piece) {\n  // black piece\n  if (piece.toLowerCase() === piece) {\n    return 'b' + piece.toUpperCase();\n  } // white piece\n\n\n  return 'w' + piece.toUpperCase();\n}\n\nfunction validSquare(square) {\n  return isString(square) && square.search(/^[a-h][1-8]$/) !== -1;\n}\n\nfunction validPieceCode(code) {\n  return isString(code) && code.search(/^[bw][KQRNBP]$/) !== -1;\n}\n\nfunction validPositionObject(pos) {\n  if (pos === null || typeof pos !== 'object') return false;\n\n  for (const i in pos) {\n    if (!pos[i]) continue;\n\n    if (!validSquare(i) || !validPieceCode(pos[i])) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nconst defaultPieces = {\n  wP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  wR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#ffffff',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14\",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 34,14 L 31,17 L 14,17 L 11,14\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,17 L 31,29.5 L 14,29.5 L 14,17\",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 31,29.5 L 32.5,32 L 12.5,32 L 14,29.5\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  wB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  wQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#ffffff',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 9,28 10.5,28 11.5,30 C 12.5,31.5 12.5,31 12,33.5 C 10.5,34.5 11,36 11,36 C 9.5,37.5 11,38.5 11,38.5 C 17.5,39.5 27.5,39.5 34,38.5 C 34,38.5 35.5,37.5 34,36 C 34,36 34.5,34.5 33,33.5 C 32.5,31 32.5,31.5 33.5,30 C 34.5,28 36,28 36,26 C 27.5,24.5 17.5,24.5 9,26 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,33.5 C 18,32.5 27,32.5 33,33.5\",\n        style: {\n          fill: 'none'\n        }\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      })]\n    })\n  }),\n  wK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#000000'\n        }\n      })]\n    })\n  }),\n  bP: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsx(\"path\", {\n      d: \"m 22.5,9 c -2.21,0 -4,1.79 -4,4 0,0.89 0.29,1.71 0.78,2.38 C 17.33,16.5 16,18.59 16,21 c 0,2.03 0.94,3.84 2.41,5.03 C 15.41,27.09 11,31.58 11,39.5 H 34 C 34,31.58 29.59,27.09 26.59,26.03 28.06,24.84 29,23.03 29,21 29,18.59 27.67,16.5 25.72,15.38 26.21,14.71 26.5,13.89 26.5,13 c 0,-2.21 -1.79,-4 -4,-4 z\",\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'nonzero',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'miter',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      }\n    })\n  }),\n  bR: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: '#000000',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,39 L 36,39 L 36,36 L 9,36 L 9,39 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,32 L 14,29.5 L 31,29.5 L 32.5,32 L 12.5,32 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,36 L 12,32 L 33,32 L 33,36 L 12,36 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 14,16.5 L 31,16.5 L 31,29.5 L 14,29.5 z \",\n        style: {\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 11,14 L 34,14 L 31,16.5 L 14,16.5 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 11,9 L 15,9 L 15,11 L 20,11 L 20,9 L 25,9 L 25,11 L 30,11 L 30,9 L 34,9 L 34,14 L 11,14 z \",\n        style: {\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12,35.5 L 33,35.5 L 33,35.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 13,31.5 L 32,31.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,29.5 L 31,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 14,16.5 L 31,16.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,14 L 34,14\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeWidth: '1',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bN: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22,10 C 32.5,11 38.5,18 38,39 L 15,39 C 15,30 25,32.5 23,18\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24,18 C 24.38,20.91 18.45,25.37 16,27 C 13,29 13.18,31.34 11,31 C 9.958,30.06 12.41,27.96 11,28 C 10,28 11.19,29.23 10,30 C 9,30 5.997,31 6,26 C 6,24 12,14 12,14 C 12,14 13.89,12.1 14,10.5 C 13.27,9.506 13.5,8.5 13.5,7.5 C 14.5,6.5 16.5,10 16.5,10 L 18.5,10 C 18.5,10 19.28,8.008 21,7 C 22,7 22,10 22,10\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 9.5 25.5 A 0.5 0.5 0 1 1 8.5,25.5 A 0.5 0.5 0 1 1 9.5 25.5 z\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 15 15.5 A 0.5 1.5 0 1 1  14,15.5 A 0.5 1.5 0 1 1  15 15.5 z\",\n        transform: \"matrix(0.866,0.5,-0.5,0.866,9.693,-5.173)\",\n        style: {\n          fill: '#ffffff',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 24.55,10.4 L 24.1,11.85 L 24.6,12 C 27.75,13 30.25,14.49 32.5,18.75 C 34.75,23.01 35.75,29.06 35.25,39 L 35.2,39.5 L 37.45,39.5 L 37.5,39 C 38,28.94 36.62,22.15 34.25,17.66 C 31.88,13.17 28.46,11.02 25.06,10.5 L 24.55,10.4 z \",\n        style: {\n          fill: '#ffffff',\n          stroke: 'none'\n        }\n      })]\n    })\n  }),\n  bB: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        opacity: '1',\n        fill: 'none',\n        fillRule: 'evenodd',\n        fillOpacity: '1',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: '#000000',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 9,36 C 12.39,35.03 19.11,36.43 22.5,34 C 25.89,36.43 32.61,35.03 36,36 C 36,36 37.65,36.54 39,38 C 38.32,38.97 37.35,38.99 36,38.5 C 32.61,37.53 25.89,38.96 22.5,37.5 C 19.11,38.96 12.39,37.53 9,38.5 C 7.65,38.99 6.68,38.97 6,38 C 7.35,36.54 9,36 9,36 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 15,32 C 17.5,34.5 27.5,34.5 30,32 C 30.5,30.5 30,30 30,30 C 30,27.5 27.5,26 27.5,26 C 33,24.5 33.5,14.5 22.5,10.5 C 11.5,14.5 12,24.5 17.5,26 C 17.5,26 15,27.5 15,30 C 15,30 14.5,30.5 15,32 z\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 25 8 A 2.5 2.5 0 1 1  20,8 A 2.5 2.5 0 1 1  25 8 z\"\n        })]\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 17.5,26 L 27.5,26 M 15,30 L 30,30 M 22.5,15.5 L 22.5,20.5 M 20,18 L 25,18\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff',\n          strokeLinejoin: 'miter'\n        }\n      })]\n    })\n  }),\n  bQ: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: '#000000',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 9,26 C 17.5,24.5 30,24.5 36,26 L 38.5,13.5 L 31,25 L 30.7,10.9 L 25.5,24.5 L 22.5,10 L 19.5,24.5 L 14.3,10.9 L 14,25 L 6.5,13.5 L 9,26 z\",\n        style: {\n          strokeLinecap: 'butt',\n          fill: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 9,26 c 0,2 1.5,2 2.5,4 1,1.5 1,1 0.5,3.5 -1.5,1 -1,2.5 -1,2.5 -1.5,1.5 0,2.5 0,2.5 6.5,1 16.5,1 23,0 0,0 1.5,-1 0,-2.5 0,0 0.5,-1.5 -1,-2.5 -0.5,-2.5 -0.5,-2 0.5,-3.5 1,-2 2.5,-2 2.5,-4 -8.5,-1.5 -18.5,-1.5 -27,0 z\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11.5,30 C 15,29 30,29 33.5,30\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"m 12,33.5 c 6,-1 15,-1 21,0\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"6\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"14\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"22.5\",\n        cy: \"8\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"31\",\n        cy: \"9\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"circle\", {\n        cx: \"39\",\n        cy: \"12\",\n        r: \"2\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 11,38.5 A 35,35 1 0 0 34,38.5\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinecap: 'butt'\n        }\n      }), /*#__PURE__*/jsxs(\"g\", {\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        },\n        children: [/*#__PURE__*/jsx(\"path\", {\n          d: \"M 11,29 A 35,35 1 0 1 34,29\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 12.5,31.5 L 32.5,31.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 11.5,34.5 A 35,35 1 0 0 33.5,34.5\"\n        }), /*#__PURE__*/jsx(\"path\", {\n          d: \"M 10.5,37.5 A 35,35 1 0 0 34.5,37.5\"\n        })]\n      })]\n    })\n  }),\n  bK: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    width: \"45\",\n    height: \"45\",\n    children: /*#__PURE__*/jsxs(\"g\", {\n      style: {\n        fill: 'none',\n        fillOpacity: '1',\n        fillRule: 'evenodd',\n        stroke: '#000000',\n        strokeWidth: '1.5',\n        strokeLinecap: 'round',\n        strokeLinejoin: 'round',\n        strokeMiterlimit: '4',\n        strokeDasharray: 'none',\n        strokeOpacity: '1'\n      },\n      children: [/*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,11.63 L 22.5,6\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        },\n        id: \"path6570\"\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 22.5,25 C 22.5,25 27,17.5 25.5,14.5 C 25.5,14.5 24.5,12 22.5,12 C 20.5,12 19.5,14.5 19.5,14.5 C 18,17.5 22.5,25 22.5,25\",\n        style: {\n          fill: '#000000',\n          fillOpacity: '1',\n          strokeLinecap: 'butt',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,37 C 18,40.5 27,40.5 32.5,37 L 32.5,30 C 32.5,30 41.5,25.5 38.5,19.5 C 34.5,13 25,16 22.5,23.5 L 22.5,27 L 22.5,23.5 C 20,16 10.5,13 6.5,19.5 C 3.5,25.5 12.5,30 12.5,30 L 12.5,37\",\n        style: {\n          fill: '#000000',\n          stroke: '#000000'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 20,8 L 25,8\",\n        style: {\n          fill: 'none',\n          stroke: '#000000',\n          strokeLinejoin: 'miter'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 32,29.5 C 32,29.5 40.5,25.5 38.03,19.85 C 34.15,14 25,18 22.5,24.5 L 22.5,26.6 L 22.5,24.5 C 20,18 10.85,14 6.97,19.85 C 4.5,25.5 13,29.5 13,29.5\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      }), /*#__PURE__*/jsx(\"path\", {\n        d: \"M 12.5,30 C 18,27 27,27 32.5,30 M 12.5,33.5 C 18,30.5 27,30.5 32.5,33.5 M 12.5,37 C 18,34 27,34 32.5,37\",\n        style: {\n          fill: 'none',\n          stroke: '#ffffff'\n        }\n      })]\n    })\n  })\n};\n\nconst ChessboardContext = /*#__PURE__*/React.createContext();\nconst useChessboard = () => useContext(ChessboardContext);\nconst ChessboardProvider = /*#__PURE__*/forwardRef(({\n  animationDuration,\n  areArrowsAllowed,\n  arePiecesDraggable,\n  arePremovesAllowed,\n  boardOrientation,\n  boardWidth,\n  clearPremovesOnRightClick,\n  customArrows,\n  customArrowColor,\n  customBoardStyle,\n  customDarkSquareStyle,\n  customDropSquareStyle,\n  customLightSquareStyle,\n  customPieces,\n  customPremoveDarkSquareStyle,\n  customPremoveLightSquareStyle,\n  customSquareStyles,\n  dropOffBoardAction,\n  id,\n  isDraggablePiece,\n  getPositionObject,\n  onArrowsChange,\n  onDragOverSquare,\n  onMouseOutSquare,\n  onMouseOverSquare,\n  onPieceClick,\n  onPieceDragBegin,\n  onPieceDragEnd,\n  onPieceDrop,\n  onSquareClick,\n  onSquareRightClick,\n  position,\n  showBoardNotation,\n  showSparePieces,\n  snapToCursor,\n  children\n}, ref) => {\n  // position stored and displayed on board\n  const [currentPosition, setCurrentPosition] = useState(convertPositionToObject(position)); // calculated differences between current and incoming positions\n\n  const [positionDifferences, setPositionDifferences] = useState({}); // colour of last piece moved to determine if premoving\n\n  const [lastPieceColour, setLastPieceColour] = useState(undefined); // current premoves\n\n  const [premoves, setPremoves] = useState([]); // ref used to access current value during timeouts (closures)\n\n  const premovesRef = useRef(premoves); // current right mouse down square\n\n  const [currentRightClickDown, setCurrentRightClickDown] = useState(); // current arrows\n\n  const [arrows, setArrows] = useState([]); // chess pieces/styling\n\n  const [chessPieces, setChessPieces] = useState({ ...defaultPieces,\n    ...customPieces\n  }); // whether the last move was a manual drop or not\n\n  const [manualDrop, setManualDrop] = useState(false); // the most recent timeout whilst waiting for animation to complete\n\n  const [previousTimeout, setPreviousTimeout] = useState(undefined); // if currently waiting for an animation to finish\n\n  const [waitingForAnimation, setWaitingForAnimation] = useState(false); // open clearPremoves() to allow user to call on undo/reset/whenever\n\n  useImperativeHandle(ref, () => ({\n    clearPremoves(clearLastPieceColour = true) {\n      clearPremoves(clearLastPieceColour);\n    }\n\n  })); // handle custom pieces change\n\n  useEffect(() => {\n    setChessPieces({ ...defaultPieces,\n      ...customPieces\n    });\n  }, [customPieces]); // handle external position change\n\n  useEffect(() => {\n    var _Object$keys, _Object$entries, _Object$entries$;\n\n    const newPosition = convertPositionToObject(position);\n    const differences = getPositionDifferences(currentPosition, newPosition);\n    const newPieceColour = ((_Object$keys = Object.keys(differences.added)) === null || _Object$keys === void 0 ? void 0 : _Object$keys.length) <= 2 ? (_Object$entries = Object.entries(differences.added)) === null || _Object$entries === void 0 ? void 0 : (_Object$entries$ = _Object$entries[0]) === null || _Object$entries$ === void 0 ? void 0 : _Object$entries$[1][0] : undefined; // external move has come in before animation is over\n    // cancel animation and immediately update position\n\n    if (waitingForAnimation) {\n      setCurrentPosition(newPosition);\n      setWaitingForAnimation(false);\n      arePremovesAllowed && attemptPremove(newPieceColour);\n\n      if (previousTimeout) {\n        clearTimeout(previousTimeout);\n      }\n    } else {\n      // move was made using drag and drop\n      if (manualDrop) {\n        setCurrentPosition(newPosition);\n        setWaitingForAnimation(false);\n        arePremovesAllowed && attemptPremove(newPieceColour);\n      } else {\n        // move was made by external position change\n        // if position === start then don't override newPieceColour\n        // needs isDifferentFromStart in scenario where premoves have been cleared upon board reset but first move is made by computer, the last move colour would need to be updated\n        if (isDifferentFromStart(newPosition) && lastPieceColour !== undefined) {\n          setLastPieceColour(newPieceColour);\n        } else {\n          // position === start, likely a board reset\n          setLastPieceColour(undefined);\n        }\n\n        setPositionDifferences(differences); // animate external move\n\n        setWaitingForAnimation(true);\n        const newTimeout = setTimeout(() => {\n          setCurrentPosition(newPosition);\n          setWaitingForAnimation(false);\n          arePremovesAllowed && attemptPremove(newPieceColour);\n        }, animationDuration);\n        setPreviousTimeout(newTimeout);\n      }\n    } // reset manual drop, ready for next move to be made by user or external\n\n\n    setManualDrop(false); // inform latest position information\n\n    getPositionObject(newPosition); // clear arrows\n\n    clearArrows(); // clear timeout on unmount\n\n    return () => {\n      clearTimeout(previousTimeout);\n    };\n  }, [position]); // handle external arrows change\n\n  useEffect(() => {\n    setArrows(customArrows);\n  }, [customArrows]); // callback when new arrows are set\n\n  useEffect(() => {\n    onArrowsChange(arrows);\n  }, [arrows]); // handle drop position change\n\n  function handleSetPosition(sourceSq, targetSq, piece) {\n    // if dropped back down, don't do anything\n    if (sourceSq === targetSq) {\n      return;\n    }\n\n    clearArrows(); // if second move is made for same colour, or there are still premoves queued, then this move needs to be added to premove queue instead of played\n    // premoves length check for colour is added in because white could make 3 premoves, and then black responds to the first move (changing the last piece colour) and then white pre-moves again\n\n    if (arePremovesAllowed && waitingForAnimation || arePremovesAllowed && (lastPieceColour === piece[0] || premovesRef.current.filter(p => p.piece[0] === piece[0]).length > 0)) {\n      const oldPremoves = [...premovesRef.current];\n      oldPremoves.push({\n        sourceSq,\n        targetSq,\n        piece\n      });\n      premovesRef.current = oldPremoves;\n      setPremoves([...oldPremoves]);\n      return;\n    } // if transitioning, don't allow new drop\n\n\n    if (!arePremovesAllowed && waitingForAnimation) return;\n    const newOnDropPosition = { ...currentPosition\n    };\n    setManualDrop(true);\n    setLastPieceColour(piece[0]); // if onPieceDrop function provided, execute it, position must be updated externally and captured by useEffect above for this move to show on board\n\n    if (onPieceDrop.length) {\n      const isValidMove = onPieceDrop(sourceSq, targetSq, piece);\n      if (!isValidMove) clearPremoves();\n    } else {\n      // delete if dropping off board\n      if (dropOffBoardAction === 'trash' && !targetSq) {\n        delete newOnDropPosition[sourceSq];\n      } // delete source piece if not dropping from spare piece\n\n\n      if (sourceSq !== 'spare') {\n        delete newOnDropPosition[sourceSq];\n      } // add piece in new position\n\n\n      newOnDropPosition[targetSq] = piece;\n      setCurrentPosition(newOnDropPosition);\n    } // inform latest position information\n\n\n    getPositionObject(newOnDropPosition);\n  }\n\n  function attemptPremove(newPieceColour) {\n    if (premovesRef.current.length === 0) return; // get current value of premove as this is called in a timeout so value may have changed since timeout was set\n\n    const premove = premovesRef.current[0]; // if premove is a differing colour to last move made, then this move can be made\n\n    if (premove.piece[0] !== undefined && premove.piece[0] !== newPieceColour && onPieceDrop.length) {\n      setLastPieceColour(premove.piece[0]);\n      setManualDrop(true); // pre-move doesn't need animation\n\n      const isValidMove = onPieceDrop(premove.sourceSq, premove.targetSq, premove.piece); // premove was successful and can be removed from queue\n\n      if (isValidMove) {\n        const oldPremoves = [...premovesRef.current];\n        oldPremoves.shift();\n        premovesRef.current = oldPremoves;\n        setPremoves([...oldPremoves]);\n      } else {\n        // premove wasn't successful, clear premove queue\n        clearPremoves();\n      }\n    }\n  }\n\n  function clearPremoves(clearLastPieceColour = true) {\n    // don't clear when right clicking to clear, otherwise you won't be able to premove again before next go\n    if (clearLastPieceColour) setLastPieceColour(undefined);\n    premovesRef.current = [];\n    setPremoves([]);\n  }\n\n  function onRightClickDown(square) {\n    setCurrentRightClickDown(square);\n  }\n\n  function onRightClickUp(square) {\n    if (!areArrowsAllowed) return;\n\n    if (currentRightClickDown) {\n      // same square, don't draw an arrow, but do clear premoves and run onSquareRightClick\n      if (currentRightClickDown === square) {\n        setCurrentRightClickDown(null);\n        clearPremovesOnRightClick && clearPremoves(false);\n        onSquareRightClick(square);\n        return;\n      } // if arrow already exists then it needs to be removed\n\n\n      for (const i in arrows) {\n        if (arrows[i][0] === currentRightClickDown && arrows[i][1] === square) {\n          setArrows(oldArrows => {\n            const newArrows = [...oldArrows];\n            newArrows.splice(i, 1);\n            return newArrows;\n          });\n          return;\n        }\n      } // different square, draw an arrow\n\n\n      setArrows(oldArrows => [...oldArrows, [currentRightClickDown, square]]);\n    } else setCurrentRightClickDown(null);\n  }\n\n  function clearCurrentRightClickDown() {\n    setCurrentRightClickDown(null);\n  }\n\n  function clearArrows() {\n    setArrows([]);\n  }\n\n  return /*#__PURE__*/jsx(ChessboardContext.Provider, {\n    value: {\n      animationDuration,\n      arePiecesDraggable,\n      arePremovesAllowed,\n      boardOrientation,\n      boardWidth,\n      customArrowColor,\n      customBoardStyle,\n      customDarkSquareStyle,\n      customDropSquareStyle,\n      customLightSquareStyle,\n      customPremoveDarkSquareStyle,\n      customPremoveLightSquareStyle,\n      customSquareStyles,\n      dropOffBoardAction,\n      id,\n      isDraggablePiece,\n      getPositionObject,\n      onDragOverSquare,\n      onMouseOutSquare,\n      onMouseOverSquare,\n      onPieceClick,\n      onPieceDragBegin,\n      onPieceDragEnd,\n      onPieceDrop,\n      onSquareClick,\n      onSquareRightClick,\n      showBoardNotation,\n      showSparePieces,\n      snapToCursor,\n      arrows,\n      chessPieces,\n      clearArrows,\n      clearCurrentRightClickDown,\n      clearPremoves,\n      currentPosition,\n      handleSetPosition,\n      lastPieceColour,\n      manualDrop,\n      onRightClickDown,\n      onRightClickUp,\n      positionDifferences,\n      premoves,\n      setChessPieces,\n      setCurrentPosition,\n      setManualDrop,\n      waitingForAnimation\n    },\n    children: children\n  });\n});\n\nfunction Notation({\n  row,\n  col\n}) {\n  const {\n    boardOrientation,\n    boardWidth,\n    customDarkSquareStyle,\n    customLightSquareStyle\n  } = useChessboard();\n  const whiteColor = customLightSquareStyle.backgroundColor;\n  const blackColor = customDarkSquareStyle.backgroundColor;\n  const isRow = col === 0;\n  const isColumn = row === 7;\n  const isBottomLeftSquare = isRow && isColumn;\n\n  function getRow() {\n    return boardOrientation === 'white' ? 8 - row : row + 1;\n  }\n\n  function getColumn() {\n    return boardOrientation === 'black' ? COLUMNS[7 - col] : COLUMNS[col];\n  }\n\n  function renderBottomLeft() {\n    return /*#__PURE__*/jsxs(Fragment, {\n      children: [/*#__PURE__*/jsx(\"div\", {\n        style: { ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...numericStyle(boardWidth)\n        },\n        children: getRow()\n      }), /*#__PURE__*/jsx(\"div\", {\n        style: { ...notationStyle,\n          ...{\n            color: whiteColor\n          },\n          ...alphaStyle(boardWidth)\n        },\n        children: getColumn()\n      })]\n    });\n  }\n\n  function renderLetters() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: { ...notationStyle,\n        ...{\n          color: col % 2 !== 0 ? blackColor : whiteColor\n        },\n        ...alphaStyle(boardWidth)\n      },\n      children: getColumn()\n    });\n  }\n\n  function renderNumbers() {\n    return /*#__PURE__*/jsx(\"div\", {\n      style: { ...notationStyle,\n        ...(boardOrientation === 'black' ? {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        } : {\n          color: row % 2 === 0 ? blackColor : whiteColor\n        }),\n        ...numericStyle(boardWidth)\n      },\n      children: getRow()\n    });\n  }\n\n  if (isBottomLeftSquare) {\n    return renderBottomLeft();\n  }\n\n  if (isColumn) {\n    return renderLetters();\n  }\n\n  if (isRow) {\n    return renderNumbers();\n  }\n\n  return null;\n}\n\nconst alphaStyle = width => ({\n  alignSelf: 'flex-end',\n  paddingLeft: width / 8 - width / 48,\n  fontSize: width / 48\n});\n\nconst numericStyle = width => ({\n  alignSelf: 'flex-start',\n  paddingRight: width / 8 - width / 48,\n  fontSize: width / 48\n});\n\nconst notationStyle = {\n  zIndex: 3,\n  position: 'absolute'\n};\n\nfunction Piece({\n  piece,\n  square,\n  squares,\n  isPremovedPiece = false\n}) {\n  const {\n    animationDuration,\n    arePiecesDraggable,\n    arePremovesAllowed,\n    boardWidth,\n    id,\n    isDraggablePiece,\n    onPieceClick,\n    onPieceDragBegin,\n    onPieceDragEnd,\n    premoves,\n    chessPieces,\n    dropTarget,\n    positionDifferences,\n    waitingForAnimation,\n    currentPosition\n  } = useChessboard();\n  const [pieceStyle, setPieceStyle] = useState({\n    opacity: 1,\n    zIndex: 5,\n    touchAction: 'none',\n    cursor: arePiecesDraggable && isDraggablePiece({\n      piece,\n      sourceSquare: square\n    }) ? '-webkit-grab' : 'default'\n  });\n  const [{\n    canDrag,\n    isDragging\n  }, drag, dragPreview] = useDrag(() => ({\n    type: 'piece',\n    item: () => {\n      onPieceDragBegin(piece, square);\n      return {\n        piece,\n        square,\n        id\n      };\n    },\n    end: () => onPieceDragEnd(piece, square),\n    collect: monitor => ({\n      canDrag: isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }),\n      isDragging: !!monitor.isDragging()\n    })\n  }), [piece, square, currentPosition, id]); // hide the default preview\n\n  dragPreview(getEmptyImage(), {\n    captureDraggingState: true\n  }); // hide piece on drag\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      opacity: isDragging ? 0 : 1\n    }));\n  }, [isDragging]); // hide piece on matching premoves\n\n  useEffect(() => {\n    // if premoves aren't allowed, don't waste time on calculations\n    if (!arePremovesAllowed) return;\n    let hidePiece = false; // side effect: if piece moves into pre-moved square, its hidden\n    // if there are any premove targets on this square, hide the piece underneath\n\n    if (!isPremovedPiece && premoves.find(p => p.targetSq === square)) hidePiece = true; // if sourceSq === sq and piece matches then this piece has been pre-moved elsewhere?\n\n    if (premoves.find(p => p.sourceSq === square && p.piece === piece)) hidePiece = true; // TODO: If a premoved piece returns to a premoved square, it will hide (e1, e2, e1)\n\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      display: hidePiece ? 'none' : 'unset'\n    }));\n  }, [currentPosition, premoves]); // new move has come in\n  // if waiting for animation, then animation has started and we can perform animation\n  // we need to head towards where we need to go, we are the source, we are heading towards the target\n\n  useEffect(() => {\n    var _positionDifferences$;\n\n    const removedPiece = (_positionDifferences$ = positionDifferences.removed) === null || _positionDifferences$ === void 0 ? void 0 : _positionDifferences$[square]; // return as null and not loaded yet\n\n    if (!positionDifferences.added) return; // check if piece matches or if removed piece was a pawn and new square is on 1st or 8th rank (promotion)\n\n    const newSquare = Object.entries(positionDifferences.added).find(([s, p]) => p === removedPiece || (removedPiece === null || removedPiece === void 0 ? void 0 : removedPiece[1]) === 'P' && (s[1] === '1' || s[1] === '8')); // we can perform animation if our square was in removed, AND the matching piece is in added AND this isn't a premoved piece\n\n    if (waitingForAnimation && removedPiece && newSquare && !isPremovedPiece) {\n      const {\n        sourceSq,\n        targetSq\n      } = getSquareCoordinates(square, newSquare[0]);\n\n      if (sourceSq && targetSq) {\n        setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n          transform: `translate(${targetSq.x - sourceSq.x}px, ${targetSq.y - sourceSq.y}px)`,\n          transition: `transform ${animationDuration}ms`,\n          zIndex: 6\n        }));\n      }\n    }\n  }, [positionDifferences]); // translate to their own positions (repaint on undo)\n\n  useEffect(() => {\n    const {\n      sourceSq\n    } = getSingleSquareCoordinates(square);\n\n    if (sourceSq) {\n      setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n        transform: `translate(${0}px, ${0}px)`,\n        transition: `transform ${0}ms`\n      }));\n    }\n  }, [currentPosition]); // update is piece draggable\n\n  useEffect(() => {\n    setPieceStyle(oldPieceStyle => ({ ...oldPieceStyle,\n      cursor: arePiecesDraggable && isDraggablePiece({\n        piece,\n        sourceSquare: square\n      }) ? '-webkit-grab' : 'default'\n    }));\n  }, [square, currentPosition, arePiecesDraggable]);\n\n  function getSingleSquareCoordinates(square) {\n    return {\n      sourceSq: squares[square]\n    };\n  }\n\n  function getSquareCoordinates(sourceSquare, targetSquare) {\n    return {\n      sourceSq: squares[sourceSquare],\n      targetSq: squares[targetSquare]\n    };\n  }\n\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: arePiecesDraggable ? canDrag ? drag : null : null,\n    onClick: () => onPieceClick(piece),\n    style: pieceStyle,\n    children: typeof chessPieces[piece] === 'function' ? chessPieces[piece]({\n      squareWidth: boardWidth / 8,\n      isDragging,\n      droppedPiece: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.piece,\n      targetSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.target,\n      sourceSquare: dropTarget === null || dropTarget === void 0 ? void 0 : dropTarget.source\n    }) : /*#__PURE__*/jsx(\"svg\", {\n      viewBox: '1 1 43 43',\n      width: boardWidth / 8,\n      height: boardWidth / 8,\n      children: /*#__PURE__*/jsx(\"g\", {\n        children: chessPieces[piece]\n      })\n    })\n  });\n}\n\nfunction Square({\n  square,\n  squareColor,\n  setSquares,\n  squareHasPremove,\n  children\n}) {\n  const squareRef = useRef();\n  const {\n    boardWidth,\n    boardOrientation,\n    clearArrows,\n    currentPosition,\n    customBoardStyle,\n    customDarkSquareStyle,\n    customDropSquareStyle,\n    customLightSquareStyle,\n    customPremoveDarkSquareStyle,\n    customPremoveLightSquareStyle,\n    customSquareStyles,\n    handleSetPosition,\n    lastPieceColour,\n    onDragOverSquare,\n    onMouseOutSquare,\n    onMouseOverSquare,\n    onPieceDrop,\n    onRightClickDown,\n    onRightClickUp,\n    onSquareClick,\n    waitingForAnimation\n  } = useChessboard();\n  const [{\n    isOver\n  }, drop] = useDrop(() => ({\n    accept: 'piece',\n    drop: item => handleSetPosition(item.square, square, item.piece),\n    collect: monitor => ({\n      isOver: !!monitor.isOver()\n    })\n  }), [square, currentPosition, onPieceDrop, waitingForAnimation, lastPieceColour]);\n  useEffect(() => {\n    const {\n      x,\n      y\n    } = squareRef.current.getBoundingClientRect();\n    setSquares(oldSquares => ({ ...oldSquares,\n      [square]: {\n        x,\n        y\n      }\n    }));\n  }, [boardWidth, boardOrientation]);\n  const defaultSquareStyle = { ...borderRadius(customBoardStyle, square, boardOrientation),\n    ...(squareColor === 'black' ? customDarkSquareStyle : customLightSquareStyle),\n    ...(squareHasPremove && (squareColor === 'black' ? customPremoveDarkSquareStyle : customPremoveLightSquareStyle)),\n    ...(isOver && customDropSquareStyle)\n  };\n  return /*#__PURE__*/jsx(\"div\", {\n    ref: drop,\n    style: defaultSquareStyle,\n    \"data-square-color\": squareColor,\n    \"data-square\": square,\n    onMouseOver: e => {\n      // noop if moving from child of square into square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOverSquare(square);\n    },\n    onMouseOut: e => {\n      // noop if moving from square into a child of square.\n      if (e.relatedTarget && e.currentTarget.contains(e.relatedTarget)) return;\n      onMouseOutSquare(square);\n    },\n    onMouseDown: e => {\n      if (e.button === 2) onRightClickDown(square);\n    },\n    onMouseUp: e => {\n      if (e.button === 2) onRightClickUp(square);\n    },\n    onDragEnter: () => onDragOverSquare(square),\n    onClick: () => {\n      onSquareClick(square);\n      clearArrows();\n    },\n    onContextMenu: e => {\n      e.preventDefault();\n    },\n    children: /*#__PURE__*/jsx(\"div\", {\n      ref: squareRef,\n      style: { ...size(boardWidth),\n        ...center,\n        ...(!squareHasPremove && (customSquareStyles === null || customSquareStyles === void 0 ? void 0 : customSquareStyles[square]))\n      },\n      children: children\n    })\n  });\n}\nconst center = {\n  display: 'flex',\n  justifyContent: 'center'\n};\n\nconst size = width => ({\n  width: width / 8,\n  height: width / 8\n});\n\nconst borderRadius = (customBoardStyle, square, boardOrientation) => {\n  if (!customBoardStyle.borderRadius) return {};\n\n  if (square === 'a1') {\n    return boardOrientation === 'white' ? {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'a8') {\n    return boardOrientation === 'white' ? {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'h1') {\n    return boardOrientation === 'white' ? {\n      borderBottomRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderTopLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  if (square === 'h8') {\n    return boardOrientation === 'white' ? {\n      borderTopRightRadius: customBoardStyle.borderRadius\n    } : {\n      borderBottomLeftRadius: customBoardStyle.borderRadius\n    };\n  }\n\n  return {};\n};\n\nfunction Squares({\n  children\n}) {\n  const {\n    boardOrientation,\n    boardWidth,\n    customBoardStyle,\n    id\n  } = useChessboard();\n  return /*#__PURE__*/jsx(\"div\", {\n    \"data-boardid\": id,\n    style: { ...boardStyles(boardWidth),\n      ...customBoardStyle\n    },\n    children: [...Array(8)].map((_, r) => {\n      return /*#__PURE__*/jsx(\"div\", {\n        style: rowStyles(boardWidth),\n        children: [...Array(8)].map((_, c) => {\n          // a1, a2 ...\n          const square = boardOrientation === 'black' ? COLUMNS[7 - c] + (r + 1) : COLUMNS[c] + (8 - r);\n          const squareColor = c % 2 === r % 2 ? 'white' : 'black';\n          return children({\n            square,\n            squareColor,\n            col: c,\n            row: r\n          });\n        })\n      }, r.toString());\n    })\n  });\n}\n\nconst boardStyles = width => ({\n  cursor: 'default',\n  height: width,\n  width\n});\n\nconst rowStyles = width => ({\n  display: 'flex',\n  flexWrap: 'nowrap',\n  width\n});\n\nconst errorImage = {\n  whiteKing: /*#__PURE__*/jsx(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    version: \"1.1\",\n    style: {\n      shapeRendering: 'geometricPrecision',\n      textRendering: 'geometricPrecision',\n      imageRendering: 'optimizeQuality'\n    },\n    viewBox: \"0 0 4210 12970\",\n    x: \"0px\",\n    y: \"0px\",\n    fillRule: \"evenodd\",\n    clipRule: \"evenodd\",\n    width: \"250\",\n    height: \"250\",\n    children: /*#__PURE__*/jsx(\"g\", {\n      children: /*#__PURE__*/jsx(\"path\", {\n        style: {\n          fill: 'black',\n          fillRule: 'nonzero'\n        },\n        d: \"M2105 0c169,0 286,160 249,315l200 0c-172,266 -231,479 -256,792 315,-24 530,-86 792,-255l0 897c-265,-171 -479,-231 -792,-256 18,234 75,495 185,682l339 0c233,0 369,269 225,456l545 0 -595 1916c130,94 158,275 59,402 465,0 416,568 51,568l-334 0 465 2867 332 0c250,0 381,306 199,485 162,63 273,220 273,399l0 633 168 0 0 475c-1403,0 -2807,0 -4210,0l0 -475 167 0 0 -633c0,-179 112,-336 274,-399 -181,-178 -52,-485 199,-485l332 0 465 -2867 -335 0c-353,0 -418,-568 51,-568 -98,-127 -70,-308 59,-402l-594 -1916c181,0 363,0 545,0 -144,-187 -9,-456 225,-456l339 0c110,-187 167,-448 185,-682 -315,25 -530,87 -793,256l0 -897c266,171 480,231 793,255 -25,-315 -87,-529 -256,-792l199 0c-36,-155 81,-315 250,-315zm-1994 10012l0 253 3988 0 0 -253c-1330,0 -2659,0 -3988,0zm484 -1060c-174,0 -316,142 -316,316l0 633 3652 0 0 -633c0,-174 -142,-316 -316,-316 -1007,0 -2013,0 -3020,0zm45 -457c-230,0 -225,345 0,345l2930 0c230,0 225,-345 0,-345 -977,0 -1953,0 -2930,0zm2020 -2978l-1111 0 -465 2867 2041 0 -465 -2867zm-1558 -456c-229,0 -224,345 0,345 669,0 1337,0 2005,0 230,0 225,-345 0,-345 -668,0 -1336,0 -2005,0zm1730 -457l-1454 0c-229,0 -224,345 0,345l1454 0c229,0 224,-345 0,-345zm-2064 -1862l544 1751c529,0 1057,0 1586,0l544 -1751c-892,0 -1783,0 -2674,0zm1085 -567l504 0c-126,-247 -163,-526 -177,-800 273,15 553,52 800,177l0 -504c-247,126 -527,163 -800,177 14,-273 51,-552 177,-799 -168,0 -336,0 -504,0 125,247 162,526 177,799 -274,-14 -553,-51 -800,-177l0 504c247,-125 527,-162 800,-177 -15,274 -52,553 -177,800zm969 111l-1434 0c-230,0 -225,345 0,345l1434 0c230,0 225,-345 0,-345zm-717 -2175c-105,0 -175,109 -133,204l266 0c42,-96 -30,-205 -133,-204z\"\n      })\n    })\n  })\n};\n\nfunction ErrorBoundary({\n  children\n}) {\n  try {\n    return children;\n  } catch (error) {\n    return /*#__PURE__*/jsx(WhiteKing, {\n      showError: true\n    });\n  }\n}\nfunction WhiteKing({\n  showError = false\n}) {\n  return /*#__PURE__*/jsxs(\"div\", {\n    style: container,\n    children: [/*#__PURE__*/jsx(\"div\", {\n      style: whiteKingStyle,\n      children: errorImage.whiteKing\n    }), showError && /*#__PURE__*/jsx(\"h1\", {\n      children: \"Something went wrong\"\n    })]\n  });\n}\nconst container = {\n  display: 'flex',\n  justifyContent: 'center',\n  alignItems: 'center',\n  flexDirection: 'column'\n};\nconst whiteKingStyle = {\n  width: 250,\n  height: 250,\n  transform: 'rotate(90deg)'\n};\n\nfunction Board() {\n  const boardRef = useRef();\n  const [squares, setSquares] = useState({});\n  const {\n    arrows,\n    boardOrientation,\n    boardWidth,\n    clearCurrentRightClickDown,\n    customArrowColor,\n    showBoardNotation,\n    currentPosition,\n    premoves\n  } = useChessboard();\n  useEffect(() => {\n    function handleClickOutside(event) {\n      if (boardRef.current && !boardRef.current.contains(event.target)) {\n        clearCurrentRightClickDown();\n      }\n    }\n\n    document.addEventListener('mouseup', handleClickOutside);\n    return () => {\n      document.removeEventListener('mouseup', handleClickOutside);\n    };\n  }, []);\n  return boardWidth ? /*#__PURE__*/jsxs(\"div\", {\n    ref: boardRef,\n    style: {\n      position: 'relative'\n    },\n    children: [/*#__PURE__*/jsx(Squares, {\n      children: ({\n        square,\n        squareColor,\n        col,\n        row\n      }) => {\n        const squareHasPremove = premoves.find(p => p.sourceSq === square || p.targetSq === square);\n        const squareHasPremoveTarget = premoves.find(p => p.targetSq === square);\n        return /*#__PURE__*/jsxs(Square, {\n          square: square,\n          squareColor: squareColor,\n          setSquares: setSquares,\n          squareHasPremove: squareHasPremove,\n          children: [currentPosition[square] && /*#__PURE__*/jsx(Piece, {\n            piece: currentPosition[square],\n            square: square,\n            squares: squares\n          }), squareHasPremoveTarget && /*#__PURE__*/jsx(Piece, {\n            isPremovedPiece: true,\n            piece: squareHasPremoveTarget.piece,\n            square: square,\n            squares: squares\n          }), showBoardNotation && /*#__PURE__*/jsx(Notation, {\n            row: row,\n            col: col\n          })]\n        }, `${col}${row}`);\n      }\n    }), /*#__PURE__*/jsx(\"svg\", {\n      width: boardWidth,\n      height: boardWidth,\n      style: {\n        position: 'absolute',\n        top: '0',\n        left: '0',\n        pointerEvents: 'none',\n        zIndex: '10'\n      },\n      children: arrows.map(arrow => {\n        const from = getRelativeCoords(boardOrientation, boardWidth, arrow[0]);\n        const to = getRelativeCoords(boardOrientation, boardWidth, arrow[1]);\n        return /*#__PURE__*/jsxs(Fragment$1, {\n          children: [/*#__PURE__*/jsx(\"defs\", {\n            children: /*#__PURE__*/jsx(\"marker\", {\n              id: \"arrowhead\",\n              markerWidth: \"2\",\n              markerHeight: \"2.5\",\n              refX: \"1.25\",\n              refY: \"1.25\",\n              orient: \"auto\",\n              children: /*#__PURE__*/jsx(\"polygon\", {\n                points: \"0 0, 2 1.25, 0 2.5\",\n                style: {\n                  fill: customArrowColor\n                }\n              })\n            })\n          }), /*#__PURE__*/jsx(\"line\", {\n            x1: from.x,\n            y1: from.y,\n            x2: to.x,\n            y2: to.y,\n            style: {\n              stroke: customArrowColor,\n              strokeWidth: boardWidth / 36\n            },\n            markerEnd: \"url(#arrowhead)\"\n          })]\n        }, `${arrow[0]}-${arrow[1]}`);\n      })\n    })]\n  }) : /*#__PURE__*/jsx(WhiteKing, {});\n}\n\nfunction CustomDragLayer() {\n  const {\n    boardWidth,\n    chessPieces,\n    id,\n    snapToCursor\n  } = useChessboard();\n  const collectedProps = useDragLayer(monitor => ({\n    item: monitor.getItem(),\n    clientOffset: monitor.getClientOffset(),\n    sourceClientOffset: monitor.getSourceClientOffset(),\n    isDragging: monitor.isDragging()\n  }));\n  const {\n    isDragging,\n    item,\n    clientOffset,\n    sourceClientOffset\n  } = collectedProps;\n  const layerStyles = {\n    position: 'fixed',\n    pointerEvents: 'none',\n    zIndex: 10,\n    left: 0,\n    top: 0\n  };\n  const getItemStyle = useCallback((clientOffset, sourceClientOffset) => {\n    if (!clientOffset || !sourceClientOffset) return {\n      display: 'none'\n    };\n    let {\n      x,\n      y\n    } = snapToCursor ? clientOffset : sourceClientOffset;\n\n    if (snapToCursor) {\n      const halfSquareWidth = boardWidth / 8 / 2;\n      x -= halfSquareWidth;\n      y -= halfSquareWidth;\n    }\n\n    const transform = `translate(${x}px, ${y}px)`;\n    return {\n      transform,\n      WebkitTransform: transform,\n      touchAction: 'none'\n    };\n  }, [boardWidth, snapToCursor]);\n  return isDragging && item.id === id ? /*#__PURE__*/jsx(\"div\", {\n    style: layerStyles,\n    children: /*#__PURE__*/jsx(\"div\", {\n      style: getItemStyle(clientOffset, sourceClientOffset),\n      children: typeof chessPieces[item.piece] === 'function' ? chessPieces[item.piece]({\n        squareWidth: boardWidth / 8,\n        isDragging: true\n      }) : /*#__PURE__*/jsx(\"svg\", {\n        viewBox: '1 1 43 43',\n        width: boardWidth / 8,\n        height: boardWidth / 8,\n        children: /*#__PURE__*/jsx(\"g\", {\n          children: chessPieces[item.piece]\n        })\n      })\n    })\n  }) : null;\n}\n\nconst Chessboard = /*#__PURE__*/forwardRef((props, ref) => {\n  const [backendSet, setBackendSet] = useState(false);\n  const [isMobile, setIsMobile] = useState(false);\n  const {\n    customDndBackend,\n    customDndBackendOptions,\n    ...otherProps\n  } = props;\n  useEffect(() => {\n    setIsMobile('ontouchstart' in window);\n    setBackendSet(true);\n  }, []);\n  const backend = customDndBackend || (isMobile ? TouchBackend : HTML5Backend);\n  return backendSet && /*#__PURE__*/jsx(ErrorBoundary, {\n    children: /*#__PURE__*/jsx(DndProvider, {\n      backend: backend,\n      children: /*#__PURE__*/jsxs(ChessboardProvider, {\n        ref: ref,\n        ...otherProps,\n        children: [/*#__PURE__*/jsx(CustomDragLayer, {}), /*#__PURE__*/jsx(Board, {})]\n      })\n    })\n  });\n});\nChessboard.defaultProps = chessboardDefaultProps;\n\nexport { Chessboard };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}